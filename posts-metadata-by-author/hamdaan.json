{"https://www.freecodecamp.org/news/author/hamdaan/":{"https://www.freecodecamp.org//news/hmac-diffie-hellman-in-node/":{"metadata":[{"tagName":"meta","attributes":{"charset":"utf-8"},"content":""},{"tagName":"meta","attributes":{"http-equiv":"X-UA-Compatible","content":"IE=edge"},"content":""},{"tagName":"title","attributes":{},"content":"How to Protect Data in Transit using HMAC and Diffie-Hellman in Node.js [Full Handbook]"},{"tagName":"meta","attributes":{"name":"HandheldFriendly","content":"True"},"content":""},{"tagName":"meta","attributes":{"name":"viewport","content":"width=device-width, initial-scale=1.0"},"content":""},{"tagName":"link","attributes":{"rel":"preconnect","href":"https://fonts.googleapis.com"},"content":""},{"tagName":"link","attributes":{"rel":"preconnect","href":"https://fonts.gstatic.com","crossorigin":""},"content":""},{"tagName":"link","attributes":{"rel":"preload","as":"style","onload":"this.onload=null;this.rel='stylesheet'","href":"https://fonts.googleapis.com/css2?family=Lato:ital,wght@0,300;0,400;0,700;1,400&family=Roboto+Mono:wght@400;700&display=swap"},"content":""},{"tagName":"link","attributes":{"rel":"preload","as":"style","onload":"this.onload=null;this.rel='stylesheet'","href":"https://cdn.freecodecamp.org/news-assets/prism/1.29.0/themes/prism.min.css"},"content":""},{"tagName":"noscript","attributes":{},"content":"\n  <link rel=\"stylesheet\" href=\"https://cdn.freecodecamp.org/news-assets/prism/1.29.0/themes/prism.min.css\">\n"},{"tagName":"link","attributes":{"rel":"preload","as":"style","onload":"this.onload=null;this.rel='stylesheet'","href":"https://cdn.freecodecamp.org/news-assets/prism/1.29.0/plugins/unescaped-markup/prism-unescaped-markup.min.css"},"content":""},{"tagName":"noscript","attributes":{},"content":"\n  <link rel=\"stylesheet\" href=\"https://cdn.freecodecamp.org/news-assets/prism/1.29.0/plugins/unescaped-markup/prism-unescaped-markup.min.css\">\n"},{"tagName":"script","attributes":{"defer":"","src":"https://cdn.freecodecamp.org/news-assets/prism/1.29.0/components/prism-core.min.js"},"content":""},{"tagName":"script","attributes":{"defer":"","src":"https://cdn.freecodecamp.org/news-assets/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"},"content":""},{"tagName":"link","attributes":{"rel":"preload","as":"style","onload":"this.onload=null;this.rel='stylesheet'","href":"/news/assets/css/global-26e2f3cde9.css"},"content":""},{"tagName":"link","attributes":{"rel":"stylesheet","type":"text/css","href":"/news/assets/css/screen-926fddfac2.css"},"content":""},{"tagName":"link","attributes":{"rel":"stylesheet","type":"text/css","href":"/news/assets/css/search-bar-124f5f949c.css"},"content":""},{"tagName":"script","attributes":{"defer":"","src":"https://cdn.freecodecamp.org/news-assets/algolia/algoliasearch-3-33-0/algoliasearch.min.js"},"content":""},{"tagName":"script","attributes":{"defer":"","src":"https://cdn.freecodecamp.org/news-assets/algolia/autocomplete-0-36-0/autocomplete.min.js"},"content":""},{"tagName":"script","attributes":{"defer":"","src":"https://cdn.freecodecamp.org/news-assets/dayjs/1.10.4/dayjs.min.js"},"content":""},{"tagName":"script","attributes":{"defer":"","src":"https://cdn.freecodecamp.org/news-assets/dayjs/1.10.4/localizedFormat.min.js"},"content":""},{"tagName":"script","attributes":{"defer":"","src":"https://cdn.freecodecamp.org/news-assets/dayjs/1.10.4/relativeTime.min.js"},"content":""},{"tagName":"script","attributes":{"defer":"","src":"https://cdn.freecodecamp.org/news-assets/dayjs/1.10.4/locale/en.min.js"},"content":""},{"tagName":"script","attributes":{},"content":"let client,index;document.addEventListener(\"DOMContentLoaded\",(()=>{client=algoliasearch(\"QMJYL5WYTI\",\"89770b24481654192d7a5c402c6ad9a0\"),index=client.initIndex(\"news\")})),document.addEventListener(\"DOMContentLoaded\",(()=>{const e=window.screen.width,t=window.screen.height,n=e>=767&&t>=768?8:5,o=document.getElementById(\"search-form\"),s=document.getElementById(\"search-input\"),a=document.getElementById(\"dropdown-container\");let i,d,c;s.addEventListener(\"input\",(e=>{i=e.target.value})),o.addEventListener(\"submit\",(e=>{e.preventDefault(),function(){if(d=document.getElementsByClassName(\"aa-cursor\")[0],d&&i){const e=d.querySelector(\"a\").href;window.location.assign(e)}else!d&&i&&c&&window.location.assign(`https://www.freecodecamp.org/news/search?query=${i}`)}()}));const l=autocomplete(\"#search-input\",{hint:!1,keyboardShortcuts:[\"s\",191],openOnFocus:!0,appendTo:a,debug:!0},[{source:autocomplete.sources.hits(index,{hitsPerPage:n}),debounce:250,templates:{suggestion:e=>(c=!0,`\\n            <a href=\"${e.url}\">\\n              <div class=\"algolia-result\">\\n                <span>${e._highlightResult.title.value}</span>\\n              </div>\\n            </a>\\n          `),empty:()=>(c=!1,'\\n            <div class=\"aa-suggestion footer-suggestion no-hits-footer\">\\n              <div class=\"algolia-result\">\\n                <span>\\n                  No tutorials found\\n                </span>\\n              </div>\\n            </div>\\n          '),footer:e=>{if(!e.isEmpty)return`\\n              <div class=\"aa-suggestion footer-suggestion\">\\n                <a id=\"algolia-footer-selector\" href=\"https://www.freecodecamp.org/news/search?query=${i}\">\\n                  <div class=\"algolia-result algolia-footer\">\\n                    See all results for ${i}\\n                  </div>\\n                </a>\\n              </div>\\n            `}}}]).on(\"autocomplete:selected\",((e,t,n,o)=>{d=t?t.url:`https://www.freecodecamp.org/news/search?query=${i}`,\"click\"!==o.selectionMethod&&\"tabKey\"!==o.selectionMethod&&c&&window.location.assign(d)}));document.addEventListener(\"click\",(e=>{e.target!==s&&l.autocomplete.close()}))})),document.addEventListener(\"DOMContentLoaded\",(()=>{dayjs.extend(dayjs_plugin_localizedFormat),dayjs.extend(dayjs_plugin_relativeTime),dayjs.locale(\"en\")}));const isAuthenticated=document.cookie.split(\";\").some((e=>e.trim().startsWith(\"jwt_access_token=\"))),isDonor=document.cookie.split(\";\").some((e=>e.trim().startsWith(\"isDonor=true\")));"},{"tagName":"script","attributes":{"data-ad-client":"ca-pub-9482786369113753","src":"https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js","crossorigin":"anonymous","async":""},"content":""},{"tagName":"script","attributes":{"type":"text/javascript","id":"MathJax-script","data-test-label":"mathjax-script","src":"https://cdn.freecodecamp.org/news-assets/mathjax/3.2.2/es5/tex-mml-chtml.js","defer":""},"content":""},{"tagName":"link","attributes":{"rel":"icon","href":"https://cdn.freecodecamp.org/universal/favicons/favicon.ico","type":"image/png"},"content":""},{"tagName":"link","attributes":{"rel":"canonical","href":"https://www.freecodecamp.org/news/hmac-diffie-hellman-in-node/"},"content":""},{"tagName":"meta","attributes":{"name":"referrer","content":"no-referrer-when-downgrade"},"content":""},{"tagName":"meta","attributes":{"name":"description","content":"Data integrity refers to the assurance that data will remain accurate, unaltered, and consistent throughout its lifecycle. In communication, data integrity is important in safeguarding against unintended alterations and malicious interventions during data transmission. The integrity of Digital Data is accomplished using Hashing Algorithms. The  crypto module in Node"},"content":""},{"tagName":"meta","attributes":{"property":"og:site_name","content":"freeCodeCamp.org"},"content":""},{"tagName":"meta","attributes":{"property":"og:type","content":"article"},"content":""},{"tagName":"meta","attributes":{"property":"og:title","content":"How to Protect Data in Transit using HMAC and Diffie-Hellman in Node.js [Full Handbook]"},"content":""},{"tagName":"meta","attributes":{"property":"og:description","content":"Data integrity refers to the assurance that data will remain accurate, unaltered, and consistent throughout its lifecycle. In communication, data integrity is important in safeguarding against unintended alterations and malicious interventions during data transmission. The integrity of Digital Data is accomplished using Hashing Algorithms. The  crypto module in Node"},"content":""},{"tagName":"meta","attributes":{"property":"og:url","content":"https://www.freecodecamp.org/news/hmac-diffie-hellman-in-node/"},"content":""},{"tagName":"meta","attributes":{"property":"og:image","content":"https://www.freecodecamp.org/news/content/images/2024/03/Protect-Data-in-Transit-Handbook-v2--1-.png"},"content":""},{"tagName":"meta","attributes":{"property":"article:published_time","content":"2024-03-18T23:00:22.000Z"},"content":""},{"tagName":"meta","attributes":{"property":"article:modified_time","content":"2024-06-28T11:36:39.000Z"},"content":""},{"tagName":"meta","attributes":{"property":"article:tag","content":"Data"},"content":""},{"tagName":"meta","attributes":{"property":"article:tag","content":"Security"},"content":""},{"tagName":"meta","attributes":{"property":"article:tag","content":"handbook"},"content":""},{"tagName":"meta","attributes":{"property":"article:tag","content":"MathJax"},"content":""},{"tagName":"meta","attributes":{"property":"article:publisher","content":"https://www.facebook.com/freecodecamp"},"content":""},{"tagName":"meta","attributes":{"name":"twitter:card","content":"summary_large_image"},"content":""},{"tagName":"meta","attributes":{"name":"twitter:title","content":"How to Protect Data in Transit using HMAC and Diffie-Hellman in Node.js [Full Handbook]"},"content":""},{"tagName":"meta","attributes":{"name":"twitter:description","content":"Data integrity refers to the assurance that data will remain accurate, unaltered, and consistent throughout its lifecycle. In communication, data integrity is important in safeguarding against unintended alterations and malicious interventions during data transmission. The integrity of Digital Data is accomplished using Hashing Algorithms. The  crypto module in Node"},"content":""},{"tagName":"meta","attributes":{"name":"twitter:url","content":"https://www.freecodecamp.org/news/hmac-diffie-hellman-in-node/"},"content":""},{"tagName":"meta","attributes":{"name":"twitter:image","content":"https://www.freecodecamp.org/news/content/images/2024/03/Protect-Data-in-Transit-Handbook-v2--1-.png"},"content":""},{"tagName":"meta","attributes":{"name":"twitter:label1","content":"Written by"},"content":""},{"tagName":"meta","attributes":{"name":"twitter:data1","content":"Hamdaan Ali"},"content":""},{"tagName":"meta","attributes":{"name":"twitter:label2","content":"Filed under"},"content":""},{"tagName":"meta","attributes":{"name":"twitter:data2","content":"Data, Security, handbook, MathJax"},"content":""},{"tagName":"meta","attributes":{"name":"twitter:site","content":"@freecodecamp"},"content":""},{"tagName":"meta","attributes":{"name":"twitter:creator","content":"@violinblackeye"},"content":""},{"tagName":"meta","attributes":{"property":"og:image:width","content":"2000"},"content":""},{"tagName":"meta","attributes":{"property":"og:image:height","content":"1334"},"content":""},{"tagName":"script","attributes":{"type":"application/ld+json"},"content":"{\n\t\"@context\": \"https://schema.org\",\n\t\"@type\": \"Article\",\n\t\"publisher\": {\n\t\t\"@type\": \"Organization\",\n\t\t\"name\": \"freeCodeCamp.org\",\n\t\t\"url\": \"https://www.freecodecamp.org/news/\",\n\t\t\"logo\": {\n\t\t\t\"@type\": \"ImageObject\",\n\t\t\t\"url\": \"https://cdn.freecodecamp.org/platform/universal/fcc_primary.svg\",\n\t\t\t\"width\": 2100,\n\t\t\t\"height\": 240\n\t\t}\n\t},\n\t\"image\": {\n\t\t\"@type\": \"ImageObject\",\n\t\t\"url\": \"https://www.freecodecamp.org/news/content/images/2024/03/Protect-Data-in-Transit-Handbook-v2--1-.png\",\n\t\t\"width\": 2000,\n\t\t\"height\": 1334\n\t},\n\t\"url\": \"https://www.freecodecamp.org/news/hmac-diffie-hellman-in-node/\",\n\t\"mainEntityOfPage\": {\n\t\t\"@type\": \"WebPage\",\n\t\t\"@id\": \"https://www.freecodecamp.org/news/\"\n\t},\n\t\"datePublished\": \"2024-03-18T23:00:22.000Z\",\n\t\"dateModified\": \"2024-06-28T11:36:39.000Z\",\n\t\"keywords\": \"Data, Security, handbook, MathJax\",\n\t\"description\": \"Data integrity refers to the assurance that data will remain accurate,\\nunaltered, and consistent throughout its lifecycle. In communication, data\\nintegrity is important in safeguarding against unintended alterations and\\nmalicious interventions during data transmission.\\n\\nThe integrity of Digital Data is accomplished using Hashing Algorithms. The \\ncrypto module in Node provides various built-in vetted library functions to\\nprovide means to not only verify the integrity of data but also the authenti\",\n\t\"headline\": \"How to Protect Data in Transit using HMAC and Diffie-Hellman in Node.js [Full Handbook]\",\n\t\"author\": {\n\t\t\"@type\": \"Person\",\n\t\t\"name\": \"Hamdaan Ali\",\n\t\t\"url\": \"https://www.freecodecamp.org/news/author/hamdaan/\",\n\t\t\"sameAs\": [\n\t\t\t\"https://www.linkedin.com/in/hamdaanali/\",\n\t\t\t\"https://twitter.com/violinblackeye\"\n\t\t],\n\t\t\"image\": {\n\t\t\t\"@type\": \"ImageObject\",\n\t\t\t\"url\": \"https://www.freecodecamp.org/news/content/images/2023/11/698-crop.jpg\",\n\t\t\t\"width\": 1050,\n\t\t\t\"height\": 1103\n\t\t}\n\t}\n}"},{"tagName":"meta","attributes":{"name":"generator","content":"Eleventy"},"content":""},{"tagName":"link","attributes":{"rel":"alternate","type":"application/rss+xml","title":"freeCodeCamp.org","href":"https://www.freecodecamp.org/news/rss/"},"content":""},{"tagName":"link","attributes":{"rel":"preconnect","href":"https://fonts.gstatic.com"},"content":""},{"tagName":"script","attributes":{},"content":"\nwindow.dataLayer = window.dataLayer || [];\n"},{"tagName":"script","attributes":{},"content":"(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':\nnew Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],\nj=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=\n'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);\n})(window,document,'script','dataLayer','GTM-5D6RKKP');"},{"tagName":"meta","attributes":{"name":"google-site-verification","content":"b4tITLzEeeZGEpvD4mGNf3khKM4fvqejQaz9SYBQP8E"},"content":""},{"tagName":"meta","attributes":{"name":"x-fcc-source","data-test-label":"x-fcc-source","content":"Ghost"},"content":""}],"html":"<!DOCTYPE html>\n<html lang=\"en\">\n    <head>\n        <meta charset=\"utf-8\">\n        <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\n        \n        \n            <title>How to Protect Data in Transit using HMAC and Diffie-Hellman in Node.js [Full Handbook]</title>\n        \n        <meta name=\"HandheldFriendly\" content=\"True\">\n        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n\n        <link rel=\"preconnect\" href=\"https://fonts.googleapis.com\">\n        <link rel=\"preconnect\" href=\"https://fonts.gstatic.com\" crossorigin=\"\">\n        \n            <link rel=\"preload\" as=\"style\" onload=\"this.onload=null;this.rel='stylesheet'\" href=\"https://fonts.googleapis.com/css2?family=Lato:ital,wght@0,300;0,400;0,700;1,400&family=Roboto+Mono:wght@400;700&display=swap\">\n        \n\n        \n        \n    <link rel=\"preload\" as=\"style\" onload=\"this.onload=null;this.rel='stylesheet'\" href=\"https://cdn.freecodecamp.org/news-assets/prism/1.29.0/themes/prism.min.css\">\n<noscript>\n  <link rel=\"stylesheet\" href=\"https://cdn.freecodecamp.org/news-assets/prism/1.29.0/themes/prism.min.css\">\n</noscript>\n<link rel=\"preload\" as=\"style\" onload=\"this.onload=null;this.rel='stylesheet'\" href=\"https://cdn.freecodecamp.org/news-assets/prism/1.29.0/plugins/unescaped-markup/prism-unescaped-markup.min.css\">\n<noscript>\n  <link rel=\"stylesheet\" href=\"https://cdn.freecodecamp.org/news-assets/prism/1.29.0/plugins/unescaped-markup/prism-unescaped-markup.min.css\">\n</noscript>\n\n<script defer=\"\" src=\"https://cdn.freecodecamp.org/news-assets/prism/1.29.0/components/prism-core.min.js\"></script>\n<script defer=\"\" src=\"https://cdn.freecodecamp.org/news-assets/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js\"></script>\n\n\n\n        \n        <link rel=\"preload\" as=\"style\" onload=\"this.onload=null;this.rel='stylesheet'\" href=\"/news/assets/css/global-26e2f3cde9.css\">\n        <link rel=\"stylesheet\" type=\"text/css\" href=\"/news/assets/css/screen-926fddfac2.css\">\n        <link rel=\"stylesheet\" type=\"text/css\" href=\"/news/assets/css/search-bar-124f5f949c.css\">\n\n        \n        <script defer=\"\" src=\"https://cdn.freecodecamp.org/news-assets/algolia/algoliasearch-3-33-0/algoliasearch.min.js\"></script>\n        <script defer=\"\" src=\"https://cdn.freecodecamp.org/news-assets/algolia/autocomplete-0-36-0/autocomplete.min.js\"></script>\n\n        \n        <script defer=\"\" src=\"https://cdn.freecodecamp.org/news-assets/dayjs/1.10.4/dayjs.min.js\"></script>\n        <script defer=\"\" src=\"https://cdn.freecodecamp.org/news-assets/dayjs/1.10.4/localizedFormat.min.js\"></script>\n        <script defer=\"\" src=\"https://cdn.freecodecamp.org/news-assets/dayjs/1.10.4/relativeTime.min.js\"></script>\n\n        \n        \n            <script defer=\"\" src=\"https://cdn.freecodecamp.org/news-assets/dayjs/1.10.4/locale/en.min.js\"></script>\n        \n\n        \n        <script>let client,index;document.addEventListener(\"DOMContentLoaded\",(()=>{client=algoliasearch(\"QMJYL5WYTI\",\"89770b24481654192d7a5c402c6ad9a0\"),index=client.initIndex(\"news\")})),document.addEventListener(\"DOMContentLoaded\",(()=>{const e=window.screen.width,t=window.screen.height,n=e>=767&&t>=768?8:5,o=document.getElementById(\"search-form\"),s=document.getElementById(\"search-input\"),a=document.getElementById(\"dropdown-container\");let i,d,c;s.addEventListener(\"input\",(e=>{i=e.target.value})),o.addEventListener(\"submit\",(e=>{e.preventDefault(),function(){if(d=document.getElementsByClassName(\"aa-cursor\")[0],d&&i){const e=d.querySelector(\"a\").href;window.location.assign(e)}else!d&&i&&c&&window.location.assign(`https://www.freecodecamp.org/news/search?query=${i}`)}()}));const l=autocomplete(\"#search-input\",{hint:!1,keyboardShortcuts:[\"s\",191],openOnFocus:!0,appendTo:a,debug:!0},[{source:autocomplete.sources.hits(index,{hitsPerPage:n}),debounce:250,templates:{suggestion:e=>(c=!0,`\\n            <a href=\"${e.url}\">\\n              <div class=\"algolia-result\">\\n                <span>${e._highlightResult.title.value}</span>\\n              </div>\\n            </a>\\n          `),empty:()=>(c=!1,'\\n            <div class=\"aa-suggestion footer-suggestion no-hits-footer\">\\n              <div class=\"algolia-result\">\\n                <span>\\n                  No tutorials found\\n                </span>\\n              </div>\\n            </div>\\n          '),footer:e=>{if(!e.isEmpty)return`\\n              <div class=\"aa-suggestion footer-suggestion\">\\n                <a id=\"algolia-footer-selector\" href=\"https://www.freecodecamp.org/news/search?query=${i}\">\\n                  <div class=\"algolia-result algolia-footer\">\\n                    See all results for ${i}\\n                  </div>\\n                </a>\\n              </div>\\n            `}}}]).on(\"autocomplete:selected\",((e,t,n,o)=>{d=t?t.url:`https://www.freecodecamp.org/news/search?query=${i}`,\"click\"!==o.selectionMethod&&\"tabKey\"!==o.selectionMethod&&c&&window.location.assign(d)}));document.addEventListener(\"click\",(e=>{e.target!==s&&l.autocomplete.close()}))})),document.addEventListener(\"DOMContentLoaded\",(()=>{dayjs.extend(dayjs_plugin_localizedFormat),dayjs.extend(dayjs_plugin_relativeTime),dayjs.locale(\"en\")}));const isAuthenticated=document.cookie.split(\";\").some((e=>e.trim().startsWith(\"jwt_access_token=\"))),isDonor=document.cookie.split(\";\").some((e=>e.trim().startsWith(\"isDonor=true\")));</script>\n\n        \n        \n    \n        \n            <script data-ad-client=\"ca-pub-9482786369113753\" src=\"https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js\" crossorigin=\"anonymous\" async=\"\"></script>\n        \n    \n\n\n        \n        \n    \n        \n    \n        \n    \n        \n    \n        \n            <script type=\"text/javascript\" id=\"MathJax-script\" data-test-label=\"mathjax-script\" src=\"https://cdn.freecodecamp.org/news-assets/mathjax/3.2.2/es5/tex-mml-chtml.js\" defer=\"\"></script>\n        \n    \n\n\n        \n        \n        \n\n        \n        \n\n        <link rel=\"icon\" href=\"https://cdn.freecodecamp.org/universal/favicons/favicon.ico\" type=\"image/png\">\n        \n        \n            <link rel=\"canonical\" href=\"https://www.freecodecamp.org/news/hmac-diffie-hellman-in-node/\">\n        \n        <meta name=\"referrer\" content=\"no-referrer-when-downgrade\">\n\n        \n\n        \n    <meta name=\"description\" content=\"Data integrity refers to the assurance that data will remain accurate, unaltered, and consistent throughout its lifecycle. In communication, data integrity is important in safeguarding against unintended alterations and malicious interventions during data transmission. The integrity of Digital Data is accomplished using Hashing Algorithms. The  crypto module in Node\">\n\n    \n    <meta property=\"og:site_name\" content=\"freeCodeCamp.org\">\n    <meta property=\"og:type\" content=\"article\">\n    <meta property=\"og:title\" content=\"How to Protect Data in Transit using HMAC and Diffie-Hellman in Node.js [Full Handbook]\">\n    \n        <meta property=\"og:description\" content=\"Data integrity refers to the assurance that data will remain accurate, unaltered, and consistent throughout its lifecycle. In communication, data integrity is important in safeguarding against unintended alterations and malicious interventions during data transmission. The integrity of Digital Data is accomplished using Hashing Algorithms. The  crypto module in Node\">\n    \n    <meta property=\"og:url\" content=\"https://www.freecodecamp.org/news/hmac-diffie-hellman-in-node/\">\n    <meta property=\"og:image\" content=\"https://www.freecodecamp.org/news/content/images/2024/03/Protect-Data-in-Transit-Handbook-v2--1-.png\">\n    <meta property=\"article:published_time\" content=\"2024-03-18T23:00:22.000Z\">\n    <meta property=\"article:modified_time\" content=\"2024-06-28T11:36:39.000Z\">\n    \n        <meta property=\"article:tag\" content=\"Data\">\n    \n        <meta property=\"article:tag\" content=\"Security\">\n    \n        <meta property=\"article:tag\" content=\"handbook\">\n    \n        <meta property=\"article:tag\" content=\"MathJax\">\n    \n    <meta property=\"article:publisher\" content=\"https://www.facebook.com/freecodecamp\">\n    \n\n    \n    <meta name=\"twitter:card\" content=\"summary_large_image\">\n    <meta name=\"twitter:title\" content=\"How to Protect Data in Transit using HMAC and Diffie-Hellman in Node.js [Full Handbook]\">\n    \n        <meta name=\"twitter:description\" content=\"Data integrity refers to the assurance that data will remain accurate, unaltered, and consistent throughout its lifecycle. In communication, data integrity is important in safeguarding against unintended alterations and malicious interventions during data transmission. The integrity of Digital Data is accomplished using Hashing Algorithms. The  crypto module in Node\">\n    \n    <meta name=\"twitter:url\" content=\"https://www.freecodecamp.org/news/hmac-diffie-hellman-in-node/\">\n    <meta name=\"twitter:image\" content=\"https://www.freecodecamp.org/news/content/images/2024/03/Protect-Data-in-Transit-Handbook-v2--1-.png\">\n    <meta name=\"twitter:label1\" content=\"Written by\">\n    <meta name=\"twitter:data1\" content=\"Hamdaan Ali\">\n    <meta name=\"twitter:label2\" content=\"Filed under\">\n    <meta name=\"twitter:data2\" content=\"Data, Security, handbook, MathJax\">\n    <meta name=\"twitter:site\" content=\"@freecodecamp\">\n    \n        <meta name=\"twitter:creator\" content=\"@violinblackeye\">\n    \n\n    <meta property=\"og:image:width\" content=\"2000\">\n    <meta property=\"og:image:height\" content=\"1334\">\n\n\n        \n    <script type=\"application/ld+json\">{\n\t\"@context\": \"https://schema.org\",\n\t\"@type\": \"Article\",\n\t\"publisher\": {\n\t\t\"@type\": \"Organization\",\n\t\t\"name\": \"freeCodeCamp.org\",\n\t\t\"url\": \"https://www.freecodecamp.org/news/\",\n\t\t\"logo\": {\n\t\t\t\"@type\": \"ImageObject\",\n\t\t\t\"url\": \"https://cdn.freecodecamp.org/platform/universal/fcc_primary.svg\",\n\t\t\t\"width\": 2100,\n\t\t\t\"height\": 240\n\t\t}\n\t},\n\t\"image\": {\n\t\t\"@type\": \"ImageObject\",\n\t\t\"url\": \"https://www.freecodecamp.org/news/content/images/2024/03/Protect-Data-in-Transit-Handbook-v2--1-.png\",\n\t\t\"width\": 2000,\n\t\t\"height\": 1334\n\t},\n\t\"url\": \"https://www.freecodecamp.org/news/hmac-diffie-hellman-in-node/\",\n\t\"mainEntityOfPage\": {\n\t\t\"@type\": \"WebPage\",\n\t\t\"@id\": \"https://www.freecodecamp.org/news/\"\n\t},\n\t\"datePublished\": \"2024-03-18T23:00:22.000Z\",\n\t\"dateModified\": \"2024-06-28T11:36:39.000Z\",\n\t\"keywords\": \"Data, Security, handbook, MathJax\",\n\t\"description\": \"Data integrity refers to the assurance that data will remain accurate,\\nunaltered, and consistent throughout its lifecycle. In communication, data\\nintegrity is important in safeguarding against unintended alterations and\\nmalicious interventions during data transmission.\\n\\nThe integrity of Digital Data is accomplished using Hashing Algorithms. The \\ncrypto module in Node provides various built-in vetted library functions to\\nprovide means to not only verify the integrity of data but also the authenti\",\n\t\"headline\": \"How to Protect Data in Transit using HMAC and Diffie-Hellman in Node.js [Full Handbook]\",\n\t\"author\": {\n\t\t\"@type\": \"Person\",\n\t\t\"name\": \"Hamdaan Ali\",\n\t\t\"url\": \"https://www.freecodecamp.org/news/author/hamdaan/\",\n\t\t\"sameAs\": [\n\t\t\t\"https://www.linkedin.com/in/hamdaanali/\",\n\t\t\t\"https://twitter.com/violinblackeye\"\n\t\t],\n\t\t\"image\": {\n\t\t\t\"@type\": \"ImageObject\",\n\t\t\t\"url\": \"https://www.freecodecamp.org/news/content/images/2023/11/698-crop.jpg\",\n\t\t\t\"width\": 1050,\n\t\t\t\"height\": 1103\n\t\t}\n\t}\n}</script>\n\n\n        <meta name=\"generator\" content=\"Eleventy\">\n        <link rel=\"alternate\" type=\"application/rss+xml\" title=\"freeCodeCamp.org\" href=\"https://www.freecodecamp.org/news/rss/\">\n\n        <link rel=\"preconnect\" href=\"https://fonts.gstatic.com\">\n\n<!-- dataLayer setup -->\n<script>\nwindow.dataLayer = window.dataLayer || [];\n</script>\n<!-- End dataLayer setup -->\n\n<!-- Google Tag Manager -->\n<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':\nnew Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],\nj=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=\n'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);\n})(window,document,'script','dataLayer','GTM-5D6RKKP');</script>\n<!-- End Google Tag Manager -->\n\n\n<meta name=\"google-site-verification\" content=\"b4tITLzEeeZGEpvD4mGNf3khKM4fvqejQaz9SYBQP8E\">\n\n        \n        \n\n        \n  <meta name=\"x-fcc-source\" data-test-label=\"x-fcc-source\" content=\"Ghost\">\n\n    </head>\n\n    \n        <body class=\"home-template\">\n    \n        <div class=\"site-wrapper\">\n            <nav class=\"site-nav nav-padding\">\n    <div class=\"site-nav-left\">\n        \n<form id=\"search-form\" data-test-label=\"search-bar\">\n    <div role=\"search\" class=\"searchbox__wrapper\">\n        <label class=\"fcc_sr_only\" for=\"search-input\">\n            Search\n        </label>\n        <input type=\"search\" placeholder=\"\n    Search 11,200+ tutorials\n\" id=\"search-input\">\n        <button type=\"submit\" class=\"ais-SearchBox-submit\">\n            <svg class=\"ais-SearchBox-submitIcon\" xmlns=\"https://www.w3.org/2000/svg\" width=\"10\" height=\"10\" viewBox=\"0 0 40 40\">\n    <path d=\"M26.804 29.01c-2.832 2.34-6.465 3.746-10.426 3.746C7.333 32.756 0 25.424 0 16.378 0 7.333 7.333 0 16.378 0c9.046 0 16.378 7.333 16.378 16.378 0 3.96-1.406 7.594-3.746 10.426l10.534 10.534c.607.607.61 1.59-.004 2.202-.61.61-1.597.61-2.202.004L26.804 29.01zm-10.426.627c7.323 0 13.26-5.936 13.26-13.26 0-7.32-5.937-13.257-13.26-13.257C9.056 3.12 3.12 9.056 3.12 16.378c0 7.323 5.936 13.26 13.258 13.26z\"></path>\n</svg>\n\n            <span class=\"fcc_sr_only\">Submit your search query</span>\n        </button>\n        <div id=\"dropdown-container\"></div>\n    </div>\n</form>\n\n    </div>\n    <div class=\"site-nav-middle\">\n        <a class=\"site-nav-logo\" href=\"https://www.freecodecamp.org/news/\" data-test-label=\"site-nav-logo\"><img src=\"https://cdn.freecodecamp.org/platform/universal/fcc_primary.svg\" alt=\"freeCodeCamp.org\"></a>\n    </div>\n    <div class=\"site-nav-right\">\n        <div class=\"nav-group\">\n            <a class=\"nav-forum\" id=\"nav-forum\" rel=\"noopener noreferrer\" href=\"https://forum.freecodecamp.org/\" target=\"_blank\" data-test-label=\"forum-button\">Forum</a>\n            <a class=\"toggle-button-nav\" id=\"nav-donate\" rel=\"noopener noreferrer\" href=\"https://www.freecodecamp.org/donate/\" target=\"_blank\" data-test-label=\"donate-button\">Donate</a>\n        </div>\n    </div>\n</nav>\n\n\n            \n            <a class=\"banner\" id=\"banner\" data-test-label=\"banner\" rel=\"noopener noreferrer\" target=\"_blank\">\n    <p id=\"banner-text\"></p>\n</a>\n\n\n    \n    <script>document.addEventListener(\"DOMContentLoaded\",(()=>{const e=document.getElementById(\"banner\"),t=document.getElementById(\"banner-text\");isAuthenticated?(t.innerHTML=\"Support our charity and our mission. <span>Donate to freeCodeCamp.org</span>.\",e.href=\"https://www.freecodecamp.org/donate\",e.setAttribute(\"text-variation\",\"authenticated\")):isDonor?(t.innerHTML=\"Thank you for supporting freeCodeCamp through <span>your donations</span>.\",e.href=\"https://www.freecodecamp.org/news/how-to-donate-to-free-code-camp/\",e.setAttribute(\"text-variation\",\"donor\")):(t.innerHTML=\"Learn to code — <span>free 3,000-hour curriculum</span>\",e.href=\"https://www.freecodecamp.org/\",e.setAttribute(\"text-variation\",\"default\"))}));</script>\n\n\n            <div id=\"error-message\"></div>\n\n            \n    <main id=\"site-main\" class=\"post-template site-main outer\">\n        <div class=\"inner ad-layout\">\n            <article class=\"post-full post\">\n                <header class=\"post-full-header\">\n                    <section class=\"post-full-meta\">\n                        <time class=\"post-full-meta-date\" data-test-label=\"post-full-meta-date\" datetime=\"Mon Mar 18 2024 23:00:22 GMT+0000 (Coordinated Universal Time)\">\n                            March 18, 2024\n                        </time>\n                        \n                            <span class=\"date-divider\">/</span>\n                            <a dir=\"ltr\" href=\"/news/tag/data/\">\n                                #Data\n                            </a>\n                        \n                    </section>\n                    <h1 class=\"post-full-title\" data-test-label=\"post-full-title\">How to Protect Data in Transit using HMAC and Diffie-Hellman in Node.js [Full Handbook]</h1>\n                </header>\n                <div class=\"post-full-author-header\" data-test-label=\"author-header-no-bio\">\n                    \n                        \n                            \n    \n    \n    \n\n    <section class=\"author-card\" data-test-label=\"author-card\">\n        \n            \n    <img srcset=\"https://www.freecodecamp.org/news/content/images/size/w60/2023/11/698-crop.jpg 60w\" sizes=\"60px\" src=\"https://www.freecodecamp.org/news/content/images/size/w60/2023/11/698-crop.jpg\" class=\"author-profile-image\" alt=\"Hamdaan Ali\" width=\"1050\" height=\"1103\" onerror=\"this.style.display='none'\" data-test-label=\"profile-image\">\n  \n        \n\n        <section class=\"author-card-content author-card-content-no-bio\">\n            <span class=\"author-card-name\">\n                <a href=\"/news/author/hamdaan/\" data-test-label=\"profile-link\">\n                    \n                        Hamdaan Ali\n                    \n                </a>\n            </span>\n            \n        </section>\n    </section>\n\n                        \n                    \n                </div>\n                <figure class=\"post-full-image\">\n                    \n    <picture>\n      <source media=\"(max-width: 700px)\" sizes=\"1px\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 1w\">\n      <source media=\"(min-width: 701px)\" sizes=\"(max-width: 800px) 400px, (max-width: 1170px) 700px, 1400px\" srcset=\"https://www.freecodecamp.org/news/content/images/size/w300/2024/03/Protect-Data-in-Transit-Handbook-v2--1-.png 300w, https://www.freecodecamp.org/news/content/images/size/w600/2024/03/Protect-Data-in-Transit-Handbook-v2--1-.png 600w, https://www.freecodecamp.org/news/content/images/size/w1000/2024/03/Protect-Data-in-Transit-Handbook-v2--1-.png 1000w, https://www.freecodecamp.org/news/content/images/size/w2000/2024/03/Protect-Data-in-Transit-Handbook-v2--1-.png 2000w\">\n      <img onerror=\"this.style.display='none'\" src=\"https://www.freecodecamp.org/news/content/images/size/w2000/2024/03/Protect-Data-in-Transit-Handbook-v2--1-.png\" alt=\"How to Protect Data in Transit using HMAC and Diffie-Hellman in Node.js [Full Handbook]\" ,=\"\" width=\"2000\" height=\"1334\" data-test-label=\"feature-image\">\n    </picture>\n  \n                </figure>\n                <section class=\"post-full-content\">\n                    <div class=\"post-and-sidebar\">\n                        <section class=\"post-content \" data-test-label=\"post-content\">\n                            \n<p>Data integrity refers to the assurance that data will remain accurate, unaltered, and consistent throughout its lifecycle. In communication, data integrity is important in safeguarding against unintended alterations and malicious interventions during data transmission.</p><p>The integrity of Digital Data is accomplished using Hashing Algorithms. The <code>crypto</code> module in Node provides various built-in vetted library functions to provide means to not only verify the integrity of data but also the authenticity of its origin.</p><p>This handbook aims to highlight the internal workings of the functions in the <code>crypto</code> library and give you some insights into the internal workings of HMAC and Diffie-Hellman Key Exchange. This will help you make informed decisions about hash algorithms and key lengths depending on your business requirements.</p><p>The primary focus of this handbook is to emphasize the crucial aspect of data integrity rather than discussing the various encryption algorithms available. </p><p>Encryption is used to protect information by converting it into a secure format, which ensures its confidentiality. But data integrity is concerned with ensuring that the data remains accurate and unaltered.</p><p>You can also watch the associated video here:</p><figure class=\"kg-card kg-embed-card\" data-test-label=\"fitted\">\n        <div class=\"fluid-width-video-container\">\n          <div style=\"padding-top: 56.17977528089888%;\" class=\"fluid-width-video-wrapper\">\n            <iframe width=\"356\" height=\"200\" src=\"https://www.youtube.com/embed/FAfzQo_eJHI?feature=oembed\" frameborder=\"0\" allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share\" allowfullscreen=\"\" title=\"Protecting Data in Transit using HMAC and Diffie-Hellman in Node.js\" name=\"fitvid0\"></iframe>\n          </div>\n        </div>\n      </figure><h2 id=\"table-of-contents\">Table of Contents</h2><ul><li><a href=\"#prerequisites\">Prerequisites</a></li><li><a href=\"#the-alice-bob-paradigm\">The Alice-Bob Paradigm</a></li><li><a href=\"#message-detection-code-mdc-\">Message Detection Code (MDC)</a></li><li><a href=\"#message-authentication-code-mac-\">Message Authentication Code (MAC)</a></li><li><a href=\"#hash-based-macs-hmac-\">Hash-based MACs (HMAC)</a></li><li><a href=\"#the-diffie-hellman-merkle-protocol\">The Diffie-Hellman-Merkle Protocol</a></li><li><a href=\"#connecting-the-dots\">Connecting the Dots</a></li><li><a href=\"#invoking-the-apis\">Invoking the APIs</a></li><li><a href=\"#wrapping-up\">Wrapping Up</a></li><li><a href=\"#references\">References</a></li></ul><h2 id=\"prerequisites\"><strong>Prerequisites</strong></h2><ol><li><strong><strong>Node and Express:</strong></strong> We'll create a TypeScript sample application using the Express framework. A basic understanding of the framework would be helpful. You will need the <a href=\"https://nodejs.org/en/download/\">Node Runtime Environment</a> to execute the scripts.</li><li><strong><strong>Postman Client: </strong></strong>To make an API request and to test out the sample application, you will need a tool to make HTTP Requests. You may use your web browser's \"Edit and Send\" feature under the Networks tab, but since not all browsers allow this, it's best to use a tool like <a href=\"https://www.postman.com/downloads/\">Postman</a> which provides a better UI to observe responses.</li></ol><h2 id=\"the-alice-bob-paradigm\">The Alice-Bob Paradigm</h2><p>Throughout this handbook you will come across numerous sequence diagrams and mathematical proofs that use the Alice-Bob Paradigm. </p><p>The Alice-Bob paradigm is a common convention in cryptography where two generic entities, often named Alice and Bob, are used to illustrate various scenarios, protocols, or cryptographic principles. </p><figure class=\"kg-card kg-image-card kg-width-wide kg-card-hascaption\"><img src=\"https://www.freecodecamp.org/news/content/images/2024/03/alice-bob-1.svg\" class=\"kg-image\" alt=\"The Alice-Bob Paradigm\" width=\"818\" height=\"483\" loading=\"lazy\"><figcaption>The Alice-Bob Paradigm</figcaption></figure><p>These characters represent two parties engaged in communication, with Alice typically representing the sender or initiator, and Bob representing the receiver or responder. </p><p>We often introduce Eve as a third party, symbolizing an eavesdropper or potential attacker, adding an element of security risk and illustrating scenarios where external entities might attempt to intercept or manipulate the communication.<br><br>The sample application shown in the later sections models after this Alice-Bob Paradigm to use Boost Inc. and Account Aggregator (AA) as the parties engaged in communication.</p><h2 id=\"message-detection-code-mdc-\">Message Detection Code (MDC)</h2><p>When Alice needs to send critical data to Bob over the internet, the data changes hands, jumping between routers and servers, each step carrying the potential risk of unintended alterations. </p><p>If Eve manages to get their hands on Alice's data, they might modify it. So the integrity of the data becomes questionable, emphasizing that its original state may have been compromised during transmission.</p><p>Note that we are talking about the integrity and not the confidentiality of the data. Say even after Alice encrypts the data, it doesn't inherently guarantee that the data hasn't been tampered with during transit.</p><p>Consider this scenario: even though Eve may be unable to decrypt the encrypted message, they might attempt to modify the ciphertext in transit. This could involve altering bits, rearranging packets, or injecting malicious code, potentially leading to unintended consequences upon decryption.</p><p>This is where a Message Detection Code (MDC) or a hash comes in picture. A modification detection code (MDC) is a message digest or a checksum that can prove the integrity of a message: that the message has not been changed [1]. <br>The figure below explains how MDC is used to verify the integrity of a message:</p><figure class=\"kg-card kg-image-card kg-width-wide kg-card-hascaption\"><img src=\"https://www.freecodecamp.org/news/content/images/2024/03/MDC.png\" class=\"kg-image\" alt=\"MDC\" srcset=\"https://www.freecodecamp.org/news/content/images/size/w600/2024/03/MDC.png 600w, https://www.freecodecamp.org/news/content/images/size/w1000/2024/03/MDC.png 1000w, https://www.freecodecamp.org/news/content/images/size/w1600/2024/03/MDC.png 1600w, https://www.freecodecamp.org/news/content/images/2024/03/MDC.png 1657w\" sizes=\"(min-width: 1200px) 1200px\" width=\"1657\" height=\"725\" loading=\"lazy\"><figcaption>Modification Detection Code [1]</figcaption></figure><p>A Hash Function is used to generate the digest for any given message. This hash function processes the entire content of the message, producing a fixed-size string of characters that uniquely represents the message's contents. This is called the message digest or MDC.</p><p>Note that any hash function, such as SHA-256, SHA-3, or MD5, can be used depending on your specific security requirements and preferences. </p><p>Once the digest is generated, it serves as a unique fingerprint for the original message. When Alice sends both the message and its corresponding digest to Bob, they can independently apply the same hash function to the received message. If the calculated digest matches the one received from Alice, it serves as irrefutable evidence that the message has not undergone any modifications during transmission.</p><h2 id=\"message-authentication-code-mac-\">Message Authentication Code (MAC)</h2><p>While MDC or the checksum is typically transferred over a safe channel, it may so happen that the safety of the channel or the trusted party itself is compromised. In such a case Eve can easily modify both the message and the digest and Bob will never know if the message actually came from Alice as intended.</p><p>What MDC lacks is a definitive guarantee of the message origin, leaving a potential vulnerability in confirming the true sender. </p><p>This is where Message Authentication Code (MAC) comes in. MACs not only ensure the integrity of the message, detecting any unauthorized alterations, but they also provide a mechanism for authenticating the origin of the data. In other words, MACs offer assurance that the message is indeed originating from Alice and not by someone else.</p><p>The figure below explains how MAC can help authenticate the origin of a message besides providing integrity check:</p><figure class=\"kg-card kg-image-card kg-width-wide kg-card-hascaption\"><img src=\"https://www.freecodecamp.org/news/content/images/2024/03/MAC.png\" class=\"kg-image\" alt=\"MAC\" srcset=\"https://www.freecodecamp.org/news/content/images/size/w600/2024/03/MAC.png 600w, https://www.freecodecamp.org/news/content/images/size/w1000/2024/03/MAC.png 1000w, https://www.freecodecamp.org/news/content/images/size/w1600/2024/03/MAC.png 1600w, https://www.freecodecamp.org/news/content/images/2024/03/MAC.png 1737w\" sizes=\"(min-width: 1200px) 1200px\" width=\"1737\" height=\"725\" loading=\"lazy\"><figcaption>Message Authentication Code [1]</figcaption></figure><p>Notice that the difference between a MDC and a MAC is that MAC also includes a secret key \\(K\\) between Alice and Bob. The hash function also takes in a key \\(K\\) along with the message \\(M\\) to generate a MAC.</p><p> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;$$ h (K | M) = MAC $$</p><p>Now both the message and MAC can be sent over the same insecure channel. When Bob receives this \\( M + MAC \\), he can separate out the message M and compute the MAC for it using the same hash function and the secret key \\(K\\). </p><p>Bob will then compare the newly computed MAC with the one he received. If the two MACs match, the message is authentic and has not been modified by an adversary.</p><p>$$ Alice: S(K,M) = MAC \\\\ Bob: V(M, K, MAC) = Accept/ Reject $$</p><p>Since Eve does not have this secret key \\(K\\), they cannot modify the message and generate a valid MAC. Consequently, the resulting MAC becomes a unique fingerprint, signifying not only the integrity of the message but also authenticating its origin.</p><h2 id=\"hash-based-macs-hmac-\">Hash-based MACs (HMAC)</h2><p>While MAC do provide a guarantee of authentication of the origin of a message, it is still falls short in ensuring unforgeability. It is easy for Eve to perform a Man in The Middle (MiTM) attack, intercept the MAC + Message pair and then perform the Length Extension Attack.</p><p>Given \\( S = h( K || M) \\) and the message \\(M\\), Eve can extend \\(M\\) to \\(M' = M || Pad || w\\) and create \\(MAC(M')\\); where \\(MAC(M')\\) is evaluated as <br>\\( S = h( K || M || Pad || w) \\).</p><p>Eve does not require knowledge of the secret key \\(K\\) to extend the message \\(M\\) to \\(M'\\). When Alice receives this modified \\(M'\\) and \\(MAC(M')\\), they are unable to determine the modification. </p><p>HMAC or a Hash-based MAC is a specific method for constructing a MAC algorithm out of a collision resistant hash function. HMAC uses two passes of hash computation and provides a better immunity against length extension attacks. The figure below explains the construction of HMACs. </p><figure class=\"kg-card kg-image-card kg-width-wide kg-card-hascaption\"><img src=\"https://www.freecodecamp.org/news/content/images/2024/03/HMAC-1.png\" class=\"kg-image\" alt=\"HMAC-1\" srcset=\"https://www.freecodecamp.org/news/content/images/size/w600/2024/03/HMAC-1.png 600w, https://www.freecodecamp.org/news/content/images/2024/03/HMAC-1.png 980w\" width=\"980\" height=\"1160\" loading=\"lazy\"><figcaption>Hash-based Message Authentication Code [1]</figcaption></figure><p>There are several steps involved in the implementation of HMACs [1]:</p><ol><li>Divide the message into N blocks, each of b bits</li><li>Select a secret key and left-padded with 0’s to create a b-bit key and exclusive-ored with a constant called \\(ipad\\) (input pad). </li><li>Use the same secret key and XOR it with an another constant called \\(opad\\).<br>The value of \\(ipad\\) and \\(opad\\) are fixed constants as defined in the HMAC Standards [3]. The value of \\(ipad\\) is taken as b/8 repetition of the sequence<br>00110110 (hex: 36) and the value of \\(opad\\) is taken as b/8 repetition of the sequence 01011100 (hex: 5C).<br>These values are defined in such a way to have the most \"non-regular\" <a href=\"https://en.wikipedia.org/wiki/Hamming_distance\">Hamming distance</a> from each other.<br>The Hamming distance between \\(ipad\\) and \\(opad\\) 4, meaning exactly half of the bits are flipped.</li><li>Prepend the result produced in Step 2 to the message block. Use the hash function on this \\(N+1\\) block to create a n bit message digest called the intermediate HMAC.</li><li>The intermediate HMAC is prepended with \\(0\\)s to make a b bit block and then the result of Step 3 is prepended to this block.</li><li>Use the hash function again on the result of step 5 to get a final n bit HMAC.</li></ol><p>Mathematically, this can be represented as: </p><p>$$ S(k, m) = H(k \\oplus \\text{opad} &nbsp;|| &nbsp;H(k \\oplus \\text{ipad} &nbsp;|| m)) $$</p><p>Now if Eve tries to extend \\(M\\) to \\(M' = M || Pad || w\\), the resulting HMAC construction this would be:</p><p>$$ HMAC(K, M')=H(K||opad, H(K||ipad, M || Pad || w)) $$</p><p>Due to the unique application of \\(opad\\) in the outer hash, the attacker cannot construct \\(H(K||opad, &lt;...&gt; )\\) without knowing the key \\(K\\). The outer padding disrupts the internal state for any additional input, thwarting the attacker's attempt. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</p><h2 id=\"the-diffie-hellman-merkle-protocol\">The Diffie-Hellman-Merkle Protocol</h2><p>One of the main challenges in Symmetric-key Ciphers is the distribution of keys. A fundamental question naturally arises: How will Bob know what keys Alice has used?</p><p>A very intuitive answer to this problem could be to use a Key Exchange or a Key Distribution Center (KDC). However, the utilization of a KDC or a Key Exchange introduces a notable caveat: the requirement of a secure channel for transmitting keys. </p><p>The security of a system employing a Key Distribution Center (KDC), such as in the case of the Kerberos authentication protocol, is heavily dependent on the security of the KDC itself. If the KDC is compromised, the cryptographic keys it manages and distributes can be exposed, leading to potential security vulnerabilities throughout the system as seen in a Golden Ticket Attack.</p><p>In the year 1979, <a href=\"https://en.wikipedia.org/wiki/Ralph_Merkle\">Ralph Merkle</a>, <a href=\"https://en.wikipedia.org/wiki/Whitfield_Diffie\">Whitfield Diffie</a> and <a href=\"https://en.wikipedia.org/wiki/Martin_Hellman\">Martin Hellman</a> came up with a way to Securely exchange Cryptographic Keys over Public Insecure Channels. </p><p>The Diffie-Hellman-Merkle Protocol provides a way for two parties to agree upon a shared secret key over an insecure channel without directly exchanging that key. The <code>crypto</code> module in Node.js contains the <code>DiffieHellman</code> class, which is a utility for creating Diffie-Hellman key exchanges. </p><p>Before we go through all of the functions defined in this class, it is important to understand the mathematics that goes around in The Diffie-Hellman-Merkle Protocol. The UML Sequence Diagram below explains the steps involved in The Diffie-Hellman-Merkle Protocol:</p><figure class=\"kg-card kg-image-card kg-width-wide kg-card-hascaption\"><img src=\"https://www.freecodecamp.org/news/content/images/2024/03/dh-1.svg\" class=\"kg-image\" alt=\"dh-1\" width=\"679\" height=\"767\" loading=\"lazy\"><figcaption>The Diffie-Hellman-Merkle Protocol</figcaption></figure><p>The process begins with either of the party who wants to establish a secure communication with the other. In this case, Alice wants to start the communication. </p><p>Alice will first pick a randomly chosen Generator <code>g</code> and a large prime number <code>p</code>. Increasing the length of the prime number results in heightened security, as it amplifies the difficulty for adversaries to execute certain cryptographic attacks.</p><p>However, enlarging the prime number also comes with computational costs. Longer prime numbers require more computational resources to perform the key generation.</p><p>Now, Alice needs to select a Private <code>a</code> and compute a modular exponentiation:</p><p>$$ A = g^a &nbsp;(\\text{mod} , p) $$</p><p>Alice will send over the Generator <code>g</code>, the large prime <code>p</code> and Alice's Public Key <code>A</code> to Bob. At this point, Bob has all the values he needs to evaluate his own modular exponentiation of:</p><p>$$ A = g^b &nbsp;(\\text{mod} , p) $$</p><p>He will send back this Public Key <code>B</code> to Alice.</p><p>Note that up until this point, all communication are occurring over insecure channel. The values <code>g</code>, <code>p</code>, <code>A</code> and <code>B</code> \"might\" as well be sent as plaintext. The Actual Secret Key is evaluated when Alice and Bob use these data to compute what is known as a \"Shared Secret\". </p><p>Shared Secret computed by A:</p><p>$$ S = A^b &nbsp;(\\text{mod} , p) \\\\ &nbsp;S = g^{\\left(ab\\right)} &nbsp;(\\text{mod} , p) $$</p><p>Shared Secret computed by B:</p><p>$$ S = B^a &nbsp;(\\text{mod} , p) \\\\ &nbsp;S = g^{\\left(ab\\right)} &nbsp;(\\text{mod} , p) $$</p><p>Notice how the Shared Secret computed by both parties at their end are the same. </p><p>This symmetrical outcome is the essence of the Diffie-Hellman key exchange, where each party independently computes the shared secret using their private key and the public key received from the other party. This ensures that both Alice and Bob arrive at an identical Shared Secret, establishing a secure foundation for further encrypted communication.</p><h3 id=\"why-is-the-shared-secret-secure\">Why is the Shared Secret Secure?</h3><p>Diffie-Hellman key exchange relies on the mathematical principles of discrete logarithm, primitive roots and Modular exponentiation.</p><p>Modular exponentiation is the problem of computing \\(a^b &nbsp;mod n\\), where \\(a\\), \\(b\\), and \\(n\\) are known integers. Discrete logarithm is the problem of finding \\(x\\) such that \\(a^x &nbsp;mod n = b\\), where \\(a\\), \\(b\\), and \\(n\\) are known integers and \\(a\\) is a primitive root modulo \\(n\\).</p><p>The security of Diffie-Hellman is rooted in the computational complexity of calculating discrete logarithms. </p><p>For example, given <code>g</code>, <code>p</code> and <code>a</code>, it's easy to compute <code>A</code> as Modular exponentiation is in P, meaning that there is a polynomial-time algorithm to solve it. </p><p>But, the other way can't be said true. Given <code>g</code>, <code>p</code>, and <code>A</code>, computing <code>a</code> requires solving the discrete logarithm problem, which is widely believed to be a computationally infeasible task [2].</p><p>Remember that both parties will compute the Shared Secret at their end and there is no need to send over this secret to the other party. This eliminates the risk of the Shared Secret getting intercepted by Eve and the only option they are left with is to solve the discrete logarithm problem.</p><h2 id=\"connecting-the-dots\">Connecting the Dots</h2><p>The key \\(K\\) that we provide in an HMAC has to be the same for both Alice and Bob. Now that we know how a Diffie-Hellman-Merkle key exchange works, it becomes intuitive that we can plug in the shared secret as the key for an HMAC.</p><p>Alice can use the shared key \\(S\\) in the HMAC function as a parameter and Bob can use the same shared secret \\(S\\), computed at their end, in the verification algorithm. </p><p>The <code>crypto</code> module in Node.js provides various built-in functions to implement cryptographic constructs such as HMACs and Diffie-Hellman Key Exchange. It is always recommended to use vetted cryptographic libraries and avoid implementing cryptographic algorithms yourselves over the concerns of <a href=\"https://en.wikipedia.org/wiki/Side-channel_attack\">Side Channel Attacks</a> or a <a href=\"https://en.wikipedia.org/wiki/Heartbleed\">Heartbleed</a>.</p><p>Let's create a TypeScript/ Node.js application to understand the implementation and prototypes of these functions. The two entities involved in communication in this application would be Boost Inc. and Account Aggregator. Boost needs to send a critical data over to the Account Aggregator. </p><p>We will first utilize the <code>DiffieHellman</code> class to create Secret Keys for both entities. Boost will then use the Secret Key to create a HMAC using the <code>Hmac</code> Class in Node. Account Aggregator will recieve this HMAC along with the message. They will verify this HMAC against the newly generated HMAC from the message they received.</p><p>Note that the code at Account Aggregator's end will be simulated and we will create API endpoints for each operation to show separation of concerns in this sample application.</p><p>The following sequence diagram explains what the application does:</p><figure class=\"kg-card kg-image-card kg-width-wide kg-card-hascaption\"><img src=\"https://www.freecodecamp.org/news/content/images/2024/03/Sample-Application-1.svg\" class=\"kg-image\" alt=\"Sample-Application-1\" width=\"982\" height=\"1065\" loading=\"lazy\"><figcaption>UML Sequence Diagram for the sample application&nbsp;</figcaption></figure><h3 id=\"project-setup\">Project Setup</h3><p>In the root of your workspace, install Express, Axios, type definitions of Node, and type definitions of Express using the following command:</p><pre><code class=\"language-bash\">npm init -y | npm install axios express\nnpm install -D nodemon ts-node @types/express @types/node typescript</code></pre><p>Configure <code>tsconfig</code> as per your liking and create a file called <code>cryto.utils.ts</code> under <code>src/utils</code>. &nbsp;Let's create an interface and import all necessary modules from the <code>crypto</code> library:</p><pre><code class=\"language-ts\">import { createHmac, createDiffieHellman, DiffieHellman, KeyObject, BinaryLike } from 'crypto';\n\nexport interface KeyPair {\n  publicKey: Buffer;\n  privateKey: Buffer;\n  generator: Buffer;\n  prime: Buffer;\n  diffieHellman: DiffieHellman;\n}</code></pre><p>This interface will function as a blueprint for managing cryptographic key pairs throughout this application. It encapsulates the public and private keys, generator, prime, and a Diffie-Hellman object. </p><p>By using this interface we will ensure a structured and standardized approach to handle cryptographic key pair information, thus promoting clarity and consistency in cryptographic operations within a Node.js environment.</p><h3 id=\"the-creatediffiehellman-function\">The createDiffieHellman Function</h3><p>Next, we will define the function <code>generateKeyPair</code> which will allow us to generate the private and public keys, \\(A\\) and \\(B\\) along with the large prime \\(p\\) and the generator \\(g\\) using the <code>createDiffieHellman</code> and <code>generateKeys</code> functions.</p><pre><code class=\"language-ts\">export function generateKeyPair(prime?: any, generator?: any): KeyPair {\n  const diffieHellman = prime &amp;&amp; generator ? createDiffieHellman(prime, 'hex', generator, 'hex') : createDiffieHellman(2048);\n  diffieHellman.generateKeys();\n\n  return {\n    publicKey: diffieHellman.getPublicKey(),\n    privateKey: diffieHellman.getPrivateKey(),\n    generator: diffieHellman.getGenerator(),\n    prime: diffieHellman.getPrime(),\n    diffieHellman,\n  };\n}</code></pre><p>Notice that the parameters to this function – <code>prime</code> and <code>generator</code> – are optional. This is because the underlying <code>createDiffieHellman</code> has five defined overloads:</p><pre><code class=\"language-ts\">function createDiffieHellman(primeLength: number, generator?: number): DiffieHellman;\n    \nfunction createDiffieHellman(\n\tprime: ArrayBuffer | NodeJS.ArrayBufferView,\n\tgenerator?: number | ArrayBuffer | NodeJS.ArrayBufferView,\n): DiffieHellman;\n\nfunction createDiffieHellman(\n    prime: ArrayBuffer | NodeJS.ArrayBufferView,\n    generator: string,\n    generatorEncoding: BinaryToTextEncoding,\n): DiffieHellman;\n\nfunction createDiffieHellman(\n    prime: string,\n    primeEncoding: BinaryToTextEncoding,\n    generator?: number | ArrayBuffer | NodeJS.ArrayBufferView,\n): DiffieHellman;\n\nfunction createDiffieHellman(\n    prime: string,\n    primeEncoding: BinaryToTextEncoding,\n    generator: string,\n    generatorEncoding: BinaryToTextEncoding,\n): DiffieHellman;</code></pre><p>The first function creates a Diffie-Hellman object with a randomly generated prime of the specified length. The <code>createDiffieHellman(2048);</code> creates a Diffie-Hellman object where the length of the randomly generated prime is 2048 bits. </p><p>When no generator value is provided to this function, it takes the default value of 2. The length of the prime necessarily has to be large and if you select a small value Node will throw an error signifying that this length will not make a secure key.</p><p>Instead of passing in the length of the prime, we can pass the prime as a buffer. This is what Account Aggregator will to at their end when Boost sends over the necessary details. </p><p>Similarly you can use the other function declarations as per your use case to pass the prime and generator as <code>ArrayBuffer</code> or <code>ArrayBufferView</code> types or as <code>string</code> with a specified encoding.</p><h3 id=\"the-computesecret-function\">The computeSecret Function</h3><p>Now, let's define a method <code>generateSharedSecret</code> that takes in a Key pair and a public key as parameter and computes the shared secret \\(S\\): </p><pre><code class=\"language-ts\">export function generateSharedSecret(keyPair: KeyPair, publicKey: Buffer): Buffer {\n  return keyPair.diffieHellman.computeSecret(publicKey);\n}</code></pre><p>The <code>computeSecret</code> function also has four overrides, which allows you to either provide the Public key parameter as <code>string</code> or <code>ArrayBufferView</code> as well as options to specify the <code>inputEncoding</code> and <code>outputEncoding</code>.</p><h3 id=\"the-createhmac-function\">The createHmac Function</h3><p>Now that we've computed our shared secret, let's create a function <code>generateHMAC</code> that consumes this shared secret and generates a digest against it. </p><pre><code class=\"language-ts\">export function generateHMAC(data: any, secretKey: KeyObject | BinaryLike): any {\n  data = JSON.stringify(data);\n  const hmac = createHmac('sha256', secretKey);\n  hmac.update(data);\n  return hmac.digest('hex');\n}\n</code></pre><p>The first parameter of the <code>createHmac</code> function takes an algorithm. This is where you need to specify what underlying hash function do you want to use. </p><p>Remember that the security of HMAC relies on various factors, including the cryptographic strength of the underlying hash function, the size of its hash output, and the quality and size of the key.</p><p>The options given to you under this algorithms parameter depends on the available algorithms supported by the OpenSSL version on the platform. To check what algorithms are available to you, execute the following command in the terminal:</p><pre><code class=\"language-bash\">openssl list -digest-algorithms</code></pre><p>This will give you a list from which you can select your desired algorithm for the underlying hash function:</p><pre><code class=\"language-bash\">RSA-MD4 =&gt; MD4\nRSA-MD5 =&gt; MD5\nRSA-MDC2 =&gt; MDC2\nRSA-RIPEMD160 =&gt; RIPEMD160\nRSA-SHA1 =&gt; SHA1\nRSA-SHA1-2 =&gt; RSA-SHA1\nRSA-SHA224 =&gt; SHA224\nRSA-SHA256 =&gt; SHA256\n...</code></pre><p>The secret key that the <code>createHmac</code> function takes could either be of type <code>KeyObject</code> or of type <code>BinaryLike</code>. Note that the type <code>BinaryLike</code> is a union type in TypeScript. It is a type that can be either a <code>string</code> or a <code>NodeJS.ArrayBufferView</code>.</p><p>The <code>createHmac</code> function's <code>data</code> parameter is designed to accepts <code>strings</code>, <code>Buffer</code>, <code>TypedArray</code> and <code>DataView</code>. To simplify the developer experience and minimize complexity, we intentionally set the <code>data</code> parameter type in the generateHMAC function as <code>any</code>. Internally, we handle the conversion to a string using <code>JSON.stringify</code>.</p><h3 id=\"initializing-communication\">Initializing communication</h3><p>Now on Boost's end create a file <code>verification.controller.ts</code> under <code>src/controllers</code>: </p><pre><code class=\"language-ts\">import { generateKeyPair, generateSharedSecret, generateHMAC, KeyPair } from '@boost/v1/utils/crypto.utils';\nimport { KeyObject, BinaryLike } from 'crypto';\n\nconst boostKeyPair: KeyPair = generateKeyPair();\n\nexport function shareKeys() {\n    const boostPublicKey: Buffer = boostKeyPair.publicKey;\n    const boostPrivateKey: Buffer = boostKeyPair.privateKey;\n    const boostGenerator: Buffer = boostKeyPair.generator;\n    const boostPrime: Buffer = boostKeyPair.prime;\n    const boostDiffieHellman = boostKeyPair.diffieHellman;\n\n    return {\n        boostPublicKey,\n        boostPrivateKey,\n        boostGenerator,\n        boostPrime,\n        boostDiffieHellman,\n    };\n}\n\nexport function hmacDigest(data: any, secretKey: KeyObject | BinaryLike): any {\n    return generateHMAC(JSON.stringify(data), secretKey);\n}\n</code></pre><p>This file imports the interface and all necessary modules from <code>cryto.utils.ts</code> and defines two wrapper functions – <code>shareKeys</code> and <code>hmacDigest</code>. <code>shareKeys</code> will only serve as a wrapper around <code>generateKeyPair</code> which will allow developers at Boost to send only the required keys over to the Account Aggregator. </p><h3 id=\"setting-up-the-account-aggregator\">Setting up the Account Aggregator</h3><p>At the Account Aggregator's end, we need to set up a function that computes AA's public key and sends it over to Boost Inc. We will also need a function to verify the received HMAC of a data by comparing it against one that AA generates:</p><pre><code class=\"language-ts\">import { generateKeyPair, generateSharedSecret, generateHMAC, KeyPair } from '../utils/crypto.utils';  \nimport axios from 'axios';\n\nlet sharedSecret: Buffer;\n\nexport async function sendAAPublicKey(): Promise&lt;Buffer&gt; {\n  try {\n    const response = await axios.get('http://localhost:3000/init');\n\n    const boostPublicKey: Buffer = Buffer.from(response.data.boostPublicKey, 'hex');\n    const boostGenerator: Buffer = Buffer.from(response.data.boostGenerator, 'hex');\n    const boostPrime: Buffer = Buffer.from(response.data.boostPrime, 'hex');\n\n    const AA: KeyPair = generateKeyPair(boostPrime, boostGenerator);\n    sharedSecret = generateSharedSecret(AA, boostPublicKey);\n\n    return AA.publicKey;\n  } catch (error) {\n    console.error('Error sending AA public key:', (error as Error).message);\n    throw error;\n  }\n}\n\nexport async function verifyData(data: any, hmac: string): Promise&lt;string&gt; {\n  try {\n    const calculatedHMAC = generateHMAC(JSON.stringify(data), sharedSecret);\n    return calculatedHMAC === hmac ? \"Integrity and authenticity verified\" : \"Integrity or authenticity compromised\";\n  } catch (error) {\n    console.error('Error verifying data:', (error as Error).message);\n    throw error;\n  }\n}\n</code></pre><p>We make an Axios request to the <code>/init</code> endpoint defined at Boost and fetch \\(p\\), \\(g\\) and \\(A\\). Once we've computed the public key, we'll send that back to Boost. We will also compute our shared secret here which we'll use while verifying the HMAC in the <code>verifyData</code> method.</p><h3 id=\"setting-up-the-express-apis\">Setting up the Express APIs</h3><p>Now that all the controllers and utility functions are in place, we'll create a few endpoints to facilitate communication between Boost Inc. and the Account Aggregator.</p><h4 id=\"boost-\">Boost:</h4><pre><code class=\"language-ts\">import express, { Request, Response } from 'express';\nimport { hmacDigest, shareKeys } from '@boost/v1/controllers/verification.controller';\nimport { KeyPair, generateSharedSecret } from '@boost/v1/utils/crypto.utils';\nimport { DiffieHellman } from 'crypto';\nimport axios from 'axios';\n\nconst appBoost = express();\nconst PORT_BOOST = 3000;\n\nlet boostPublicKey: Buffer, boostPrivateKey: Buffer;\nlet boostGenerator: Buffer, boostPrime: Buffer;\nlet sharedSecret: Buffer;\nlet boostKeyPair: KeyPair, boostDiffieHellman: DiffieHellman;\n\nappBoost.get('/init', async (req: Request, res: Response) =&gt; {\n    ({ boostPublicKey, boostPrivateKey, boostGenerator, boostPrime, boostDiffieHellman } = shareKeys());\n    res.send({ boostPublicKey, boostGenerator, boostPrime });\n});\n\n// Simulated Data\nconst data = {\n    name: 'Boost User 1',\n    phone: '1234567890',\n};\n\nappBoost.get('/fetchData', async (req: Request, res: Response) =&gt; {\n    const hmac = hmacDigest(data, sharedSecret);\n    res.send({ data, hmac });\n});\n\nappBoost.listen(PORT_BOOST, () =&gt; {\n  console.log(`Boost server is running on http://localhost:${PORT_BOOST}`);\n});\n</code></pre><p>The <code>/init</code> endpoint, hosted by Boost, is invoked by AA within its <code>sendAAPublicKey</code> function. When the shared secret is calculated, AA will invoke the endpoint <code>/fetchData</code> to retrieve the critical information.</p><h4 id=\"account-aggregator-aa-\">Account Aggregator (AA):</h4><pre><code class=\"language-ts\">import express, { Request, Response } from 'express';\nimport { sendAAPublicKey, verifyData } from '@AA/v1/controllers/aa.controller';\nimport { KeyPair, generateSharedSecret } from '@boost/v1/utils/crypto.utils';\nimport { DiffieHellman } from 'crypto';\nimport axios from 'axios';\n\nconst appAA = express();\nconst PORT_AA = 3001;\n\nlet boostPublicKey: Buffer, boostPrivateKey: Buffer;\nlet boostGenerator: Buffer, boostPrime: Buffer;\nlet AAPublicKey: Buffer;\nlet sharedSecret: Buffer;\nlet boostKeyPair: KeyPair, boostDiffieHellman: DiffieHellman;\n\nappAA.get('/fetchAAPublicKey', async (req: Request, res: Response) =&gt; {\n    AAPublicKey = await sendAAPublicKey();\n    res.send({ AAPublicKey: AAPublicKey.toString('hex') });\n\n    boostKeyPair = {\n        publicKey: boostPublicKey,\n        privateKey: boostPrivateKey,\n        generator: boostGenerator,\n        prime: boostPrime,\n        diffieHellman: boostDiffieHellman,\n    }\n\n    sharedSecret = generateSharedSecret(boostKeyPair, AAPublicKey);\n});\n\nappAA.get('/verifyData', async (req: Request, res: Response) =&gt; {\n    const response = await axios.get('http://localhost:3000/fetchData');\n    const { data, hmac } = response.data;\n    const verified = await verifyData(data, hmac);\n    res.send({ verified });\n});\n\nappAA.listen(PORT_AA, () =&gt; {\n  console.log(`AA server is running on http://localhost:${PORT_AA}`);\n});\n</code></pre><p>The <code>fetchAAPublicKey</code> endpoint, hosted as AA's end, will be invoked by Boost when it wants to evaluate the Shared Secret. The <code>verifyData</code> method is encapsulated within a <code>GET</code> request, enabling either party to confirm the integrity of the transmitted data.</p><h2 id=\"invoking-the-apis\">Invoking the APIs</h2><p>Head over to your Postman Client to test out these APIs. Since the <code>sendAAPublicKey</code> method takes care of the initiation, we need to start our communication using the <code>/fetchAAPublicKey</code> endpoint:</p><figure class=\"kg-card kg-image-card kg-width-wide kg-card-hascaption\"><img src=\"https://www.freecodecamp.org/news/content/images/2024/03/image-35.png\" class=\"kg-image\" alt=\"image-35\" srcset=\"https://www.freecodecamp.org/news/content/images/size/w600/2024/03/image-35.png 600w, https://www.freecodecamp.org/news/content/images/size/w1000/2024/03/image-35.png 1000w, https://www.freecodecamp.org/news/content/images/size/w1600/2024/03/image-35.png 1600w, https://www.freecodecamp.org/news/content/images/2024/03/image-35.png 1919w\" sizes=\"(min-width: 1200px) 1200px\" width=\"1919\" height=\"1003\" loading=\"lazy\"><figcaption>Postman Client: fetchAAPublicKey Endpoint</figcaption></figure><p>You will observe the AA's public key as a response. Now, Boost Inc. will use this Public Key and evaluate the Shared Secret.</p><p>Once that is done, it will use the Shared Secret to compute the message digest in the <code>/fetchData</code> endpoint. Since <code>/verifyData</code> invokes the former endpoint, we'll check this in action on our Postman Client:</p><figure class=\"kg-card kg-image-card kg-width-wide kg-card-hascaption\"><img src=\"https://www.freecodecamp.org/news/content/images/2024/03/image-36.png\" class=\"kg-image\" alt=\"image-36\" srcset=\"https://www.freecodecamp.org/news/content/images/size/w600/2024/03/image-36.png 600w, https://www.freecodecamp.org/news/content/images/size/w1000/2024/03/image-36.png 1000w, https://www.freecodecamp.org/news/content/images/size/w1600/2024/03/image-36.png 1600w, https://www.freecodecamp.org/news/content/images/2024/03/image-36.png 1919w\" sizes=\"(min-width: 1200px) 1200px\" width=\"1919\" height=\"1006\" loading=\"lazy\"><figcaption>Postman Client: verifyData Endpoint</figcaption></figure><p>You will notice that the <code>/verifyData</code> response declares the successful verification of both integrity and authenticity. This acknowledgment ensures that the transmitted data remains untampered and originates from the authenticated source, providing a layer of security for communication between the two entities.</p><h2 id=\"wrapping-up\">Wrapping Up</h2><p>And there you have it: by utilizing HMACs and the Diffie-Hellman-Merkle Key Exchange, you can verify the integrity and authenticity of your transmitted data, enhancing the security of your applications and ensuring a reliable API communication framework for developers. </p><p>By understanding the intricacies and mathematical underpinnings of these practices, you can now make informed decisions, fortifying your system against tampering threats.</p><p>Find the complete code snippets here — <a href=\"https://gist.github.com/HamdaanAliQuatil/8e0942eddfe708aafd4f95b739802c0c\">GitHub Gist | HamdaanAliQuatil</a>.<br>You may find me on X (formerly Twitter) – <a href=\"https://twitter.com/violinblackeye\">Hamdaan Ali Quatil</a>.</p><h3 id=\"references\">References</h3><p>[1] Behrouz A. Forouzan – Introduction to Cryptography and Network Security</p><p>[2] New Directions in Cryptography, Whitfield Diffie and Martin E. Hellman <a href=\"https://www.cs.jhu.edu/~rubin/courses/sp03/papers/diffie.hellman.pdf\">diffie.hellman.pdf (jhu.edu)</a></p><p>[3] Keying Hash Functions for Message Authentication, Mihir Bellare, Ran Canetti, Hugo Krawczyk <a href=\"https://cseweb.ucsd.edu/~mihir/papers/kmd5.pdf\">https://cseweb.ucsd.edu/~mihir/papers/kmd5.pdf</a></p>\n\n                        </section>\n                        \n                            <div class=\"sidebar\">\n                                \n                                    \n                                        <div class=\"ad-wrapper\" data-test-label=\"ad-wrapper\">\n    \n    <div class=\"ad-text\" data-test-label=\"ad-text\">ADVERTISEMENT</div>\n    <ins class=\"adsbygoogle\" style=\"display: block; height: 280px;\" data-ad-client=\"ca-pub-9482786369113753\" data-ad-slot=\"5720086888\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins>\n    <script>\n        (adsbygoogle = window.adsbygoogle || []).push({});\n    </script>\n</div>\n\n                                    \n                                        <div class=\"ad-wrapper\" data-test-label=\"ad-wrapper\">\n    \n    <div class=\"ad-text\" data-test-label=\"ad-text\">ADVERTISEMENT</div>\n    <ins class=\"adsbygoogle\" style=\"display: block; height: 280px;\" data-ad-client=\"ca-pub-9482786369113753\" data-ad-slot=\"5720086888\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins>\n    <script>\n        (adsbygoogle = window.adsbygoogle || []).push({});\n    </script>\n</div>\n\n                                    \n                                        <div class=\"ad-wrapper\" data-test-label=\"ad-wrapper\">\n    \n    <div class=\"ad-text\" data-test-label=\"ad-text\">ADVERTISEMENT</div>\n    <ins class=\"adsbygoogle\" style=\"display: block; height: 280px;\" data-ad-client=\"ca-pub-9482786369113753\" data-ad-slot=\"5720086888\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins>\n    <script>\n        (adsbygoogle = window.adsbygoogle || []).push({});\n    </script>\n</div>\n\n                                    \n                                        <div class=\"ad-wrapper\" data-test-label=\"ad-wrapper\">\n    \n    <div class=\"ad-text\" data-test-label=\"ad-text\">ADVERTISEMENT</div>\n    <ins class=\"adsbygoogle\" style=\"display: block; height: 280px;\" data-ad-client=\"ca-pub-9482786369113753\" data-ad-slot=\"5720086888\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins>\n    <script>\n        (adsbygoogle = window.adsbygoogle || []).push({});\n    </script>\n</div>\n\n                                    \n                                        <div class=\"ad-wrapper\" data-test-label=\"ad-wrapper\">\n    \n    <div class=\"ad-text\" data-test-label=\"ad-text\">ADVERTISEMENT</div>\n    <ins class=\"adsbygoogle\" style=\"display: block; height: 280px;\" data-ad-client=\"ca-pub-9482786369113753\" data-ad-slot=\"5720086888\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins>\n    <script>\n        (adsbygoogle = window.adsbygoogle || []).push({});\n    </script>\n</div>\n\n                                    \n                                        <div class=\"ad-wrapper\" data-test-label=\"ad-wrapper\">\n    \n    <div class=\"ad-text\" data-test-label=\"ad-text\">ADVERTISEMENT</div>\n    <ins class=\"adsbygoogle\" style=\"display: block; height: 280px;\" data-ad-client=\"ca-pub-9482786369113753\" data-ad-slot=\"5720086888\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins>\n    <script>\n        (adsbygoogle = window.adsbygoogle || []).push({});\n    </script>\n</div>\n\n                                    \n                                        <div class=\"ad-wrapper\" data-test-label=\"ad-wrapper\">\n    \n    <div class=\"ad-text\" data-test-label=\"ad-text\">ADVERTISEMENT</div>\n    <ins class=\"adsbygoogle\" style=\"display: block; height: 280px;\" data-ad-client=\"ca-pub-9482786369113753\" data-ad-slot=\"5720086888\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins>\n    <script>\n        (adsbygoogle = window.adsbygoogle || []).push({});\n    </script>\n</div>\n\n                                    \n                                        <div class=\"ad-wrapper\" data-test-label=\"ad-wrapper\">\n    \n    <div class=\"ad-text\" data-test-label=\"ad-text\">ADVERTISEMENT</div>\n    <ins class=\"adsbygoogle\" style=\"display: block; height: 280px;\" data-ad-client=\"ca-pub-9482786369113753\" data-ad-slot=\"5720086888\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins>\n    <script>\n        (adsbygoogle = window.adsbygoogle || []).push({});\n    </script>\n</div>\n\n                                    \n                                        <div class=\"ad-wrapper\" data-test-label=\"ad-wrapper\">\n    \n    <div class=\"ad-text\" data-test-label=\"ad-text\">ADVERTISEMENT</div>\n    <ins class=\"adsbygoogle\" style=\"display: block; height: 280px;\" data-ad-client=\"ca-pub-9482786369113753\" data-ad-slot=\"5720086888\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins>\n    <script>\n        (adsbygoogle = window.adsbygoogle || []).push({});\n    </script>\n</div>\n\n                                    \n                                        <div class=\"ad-wrapper\" data-test-label=\"ad-wrapper\">\n    \n    <div class=\"ad-text\" data-test-label=\"ad-text\">ADVERTISEMENT</div>\n    <ins class=\"adsbygoogle\" style=\"display: block; height: 280px;\" data-ad-client=\"ca-pub-9482786369113753\" data-ad-slot=\"5720086888\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins>\n    <script>\n        (adsbygoogle = window.adsbygoogle || []).push({});\n    </script>\n</div>\n\n                                    \n                                        <div class=\"ad-wrapper\" data-test-label=\"ad-wrapper\">\n    \n    <div class=\"ad-text\" data-test-label=\"ad-text\">ADVERTISEMENT</div>\n    <ins class=\"adsbygoogle\" style=\"display: block; height: 280px;\" data-ad-client=\"ca-pub-9482786369113753\" data-ad-slot=\"5720086888\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins>\n    <script>\n        (adsbygoogle = window.adsbygoogle || []).push({});\n    </script>\n</div>\n\n                                    \n                                        <div class=\"ad-wrapper\" data-test-label=\"ad-wrapper\">\n    \n    <div class=\"ad-text\" data-test-label=\"ad-text\">ADVERTISEMENT</div>\n    <ins class=\"adsbygoogle\" style=\"display: block; height: 280px;\" data-ad-client=\"ca-pub-9482786369113753\" data-ad-slot=\"5720086888\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins>\n    <script>\n        (adsbygoogle = window.adsbygoogle || []).push({});\n    </script>\n</div>\n\n                                    \n                                        <div class=\"ad-wrapper\" data-test-label=\"ad-wrapper\">\n    \n    <div class=\"ad-text\" data-test-label=\"ad-text\">ADVERTISEMENT</div>\n    <ins class=\"adsbygoogle\" style=\"display: block; height: 280px;\" data-ad-client=\"ca-pub-9482786369113753\" data-ad-slot=\"5720086888\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins>\n    <script>\n        (adsbygoogle = window.adsbygoogle || []).push({});\n    </script>\n</div>\n\n                                    \n                                        <div class=\"ad-wrapper\" data-test-label=\"ad-wrapper\">\n    \n    <div class=\"ad-text\" data-test-label=\"ad-text\">ADVERTISEMENT</div>\n    <ins class=\"adsbygoogle\" style=\"display: block; height: 280px;\" data-ad-client=\"ca-pub-9482786369113753\" data-ad-slot=\"5720086888\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins>\n    <script>\n        (adsbygoogle = window.adsbygoogle || []).push({});\n    </script>\n</div>\n\n                                    \n                                        <div class=\"ad-wrapper\" data-test-label=\"ad-wrapper\">\n    \n    <div class=\"ad-text\" data-test-label=\"ad-text\">ADVERTISEMENT</div>\n    <ins class=\"adsbygoogle\" style=\"display: block; height: 280px;\" data-ad-client=\"ca-pub-9482786369113753\" data-ad-slot=\"5720086888\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins>\n    <script>\n        (adsbygoogle = window.adsbygoogle || []).push({});\n    </script>\n</div>\n\n                                    \n                                        <div class=\"ad-wrapper\" data-test-label=\"ad-wrapper\">\n    \n    <div class=\"ad-text\" data-test-label=\"ad-text\">ADVERTISEMENT</div>\n    <ins class=\"adsbygoogle\" style=\"display: block; height: 280px;\" data-ad-client=\"ca-pub-9482786369113753\" data-ad-slot=\"5720086888\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins>\n    <script>\n        (adsbygoogle = window.adsbygoogle || []).push({});\n    </script>\n</div>\n\n                                    \n                                        <div class=\"ad-wrapper\" data-test-label=\"ad-wrapper\">\n    \n    <div class=\"ad-text\" data-test-label=\"ad-text\">ADVERTISEMENT</div>\n    <ins class=\"adsbygoogle\" style=\"display: block; height: 280px;\" data-ad-client=\"ca-pub-9482786369113753\" data-ad-slot=\"5720086888\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins>\n    <script>\n        (adsbygoogle = window.adsbygoogle || []).push({});\n    </script>\n</div>\n\n                                    \n                                        <div class=\"ad-wrapper\" data-test-label=\"ad-wrapper\">\n    \n    <div class=\"ad-text\" data-test-label=\"ad-text\">ADVERTISEMENT</div>\n    <ins class=\"adsbygoogle\" style=\"display: block; height: 280px;\" data-ad-client=\"ca-pub-9482786369113753\" data-ad-slot=\"5720086888\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins>\n    <script>\n        (adsbygoogle = window.adsbygoogle || []).push({});\n    </script>\n</div>\n\n                                    \n                                        <div class=\"ad-wrapper\" data-test-label=\"ad-wrapper\">\n    \n    <div class=\"ad-text\" data-test-label=\"ad-text\">ADVERTISEMENT</div>\n    <ins class=\"adsbygoogle\" style=\"display: block; height: 280px;\" data-ad-client=\"ca-pub-9482786369113753\" data-ad-slot=\"5720086888\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins>\n    <script>\n        (adsbygoogle = window.adsbygoogle || []).push({});\n    </script>\n</div>\n\n                                    \n                                        <div class=\"ad-wrapper\" data-test-label=\"ad-wrapper\">\n    \n    <div class=\"ad-text\" data-test-label=\"ad-text\">ADVERTISEMENT</div>\n    <ins class=\"adsbygoogle\" style=\"display: block; height: 280px;\" data-ad-client=\"ca-pub-9482786369113753\" data-ad-slot=\"5720086888\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins>\n    <script>\n        (adsbygoogle = window.adsbygoogle || []).push({});\n    </script>\n</div>\n\n                                    \n                                \n                            </div>\n                        \n                    </div>\n                    <hr>\n                    \n                        <div class=\"post-full-author-header\" data-test-label=\"author-header-with-bio\">\n                            \n                                \n    \n    \n    \n\n    <section class=\"author-card\" data-test-label=\"author-card\">\n        \n            \n    <img srcset=\"https://www.freecodecamp.org/news/content/images/size/w60/2023/11/698-crop.jpg 60w\" sizes=\"60px\" src=\"https://www.freecodecamp.org/news/content/images/size/w60/2023/11/698-crop.jpg\" class=\"author-profile-image\" alt=\"Hamdaan Ali\" width=\"1050\" height=\"1103\" onerror=\"this.style.display='none'\" loading=\"lazy\" data-test-label=\"profile-image\">\n  \n        \n\n        <section class=\"author-card-content \">\n            <span class=\"author-card-name\">\n                <a href=\"/news/author/hamdaan/\" data-test-label=\"profile-link\">\n                    \n                        Hamdaan Ali\n                    \n                </a>\n            </span>\n            \n                \n                    <p data-test-label=\"default-bio\">\n                        Read <a href=\"/news/author/hamdaan/\">more posts</a>.\n                    </p>\n                \n            \n        </section>\n    </section>\n\n                            \n                        </div>\n                        <hr>\n                    \n\n                    \n                    \n                        \n    \n\n\n<p data-test-label=\"social-row-cta\" class=\"social-row\">\n    If you read this far, thank the author to show them you care. <button id=\"tweet-btn\" class=\"cta-button\" data-test-label=\"tweet-button\">Say Thanks</button>\n</p>\n\n\n    \n    <script>document.addEventListener(\"DOMContentLoaded\",(()=>{const t=document.getElementById(\"tweet-btn\"),e=window.location,n=\"How%20to%20Protect%20Data%20in%20Transit%20using%20HMAC%20and%20Diffie-Hellman%20in%20Node.js%20%5BFull%20Handbook%5D\".replace(/&#39;/g,\"%27\"),o=\"\",i=\"@violinblackeye\",r=Boolean(\"\");let a;if(r&&(o||i)){const t={originalPostAuthor:\"\",currentPostAuthor:\"Hamdaan Ali\"};a=encodeURIComponent(`Thank you ${o||t.originalPostAuthor} for writing this helpful article, and ${i||t.currentPostAuthor} for translating it.`)}else!r&&i&&(a=encodeURIComponent(`Thank you ${i} for writing this helpful article.`));const l=`window.open(\\n    '${a?`https://twitter.com/intent/tweet?text=${a}%0A%0A${n}%0A%0A${e}`:`https://twitter.com/intent/tweet?text=${n}%0A%0A${e}`}',\\n    'share-twitter',\\n    'width=550, height=235'\\n  ); return false;`;t.setAttribute(\"onclick\",l)}));</script>\n\n\n                        \n\n<div class=\"learn-cta-row\" data-test-label=\"learn-cta-row\">\n    <p>\n        Learn to code for free. freeCodeCamp's open source curriculum has helped more than 40,000 people get jobs as developers. <a href=\"https://www.freecodecamp.org/learn/\" class=\"cta-button\" id=\"learn-to-code-cta\" rel=\"noopener noreferrer\" target=\"_blank\">Get started</a>\n    </p>\n</div>\n\n                    \n                </section>\n                \n                    <div class=\"banner-ad bottom\">\n                        \n                            <div class=\"ad-wrapper\" data-test-label=\"ad-wrapper\">\n    \n    <div class=\"ad-text\" data-test-label=\"ad-text\">ADVERTISEMENT</div>\n    <ins class=\"adsbygoogle\" style=\"display: block; height: 280px;\" data-ad-client=\"ca-pub-9482786369113753\" data-ad-slot=\"5720086888\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins>\n    <script>\n        (adsbygoogle = window.adsbygoogle || []).push({});\n    </script>\n</div>\n\n                        \n                    </div>\n                \n            </article>\n        </div>\n    </main>\n\n\n            \n\n\n<footer class=\"site-footer\">\n    <div class=\"footer-top\">\n        <div class=\"footer-desc-col\">\n            <p data-test-label=\"tax-exempt-status\">freeCodeCamp is a donor-supported tax-exempt 501(c)(3) charity organization (United States Federal Tax Identification Number: 82-0779546)</p>\n            <p data-test-label=\"mission-statement\">Our mission: to help people learn to code for free. We accomplish this by creating thousands of videos, articles, and interactive coding lessons - all freely available to the public.</p>\n            <p data-test-label=\"donation-initiatives\">Donations to freeCodeCamp go toward our education initiatives, and help pay for servers, services, and staff.</p>\n            <p class=\"footer-donation\" data-test-label=\"donate-text\">\n                You can <a href=\"https://www.freecodecamp.org/donate/\" class=\"inline\" rel=\"noopener noreferrer\" target=\"_blank\">make a tax-deductible donation here</a>.\n            </p>\n        </div>\n        <div class=\"trending-guides\" data-test-label=\"trending-guides\">\n            <h2 id=\"trending-guides\" class=\"col-header\">Trending Guides</h2>\n            <ul class=\"trending-guides-articles\" aria-labelledby=\"trending-guides\">\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/complete-guide-to-css-transform-functions-and-properties/\" rel=\"noopener noreferrer\" target=\"_blank\">Learn CSS Transform\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/how-to-create-a-static-blog-with-lume/\" rel=\"noopener noreferrer\" target=\"_blank\">Build a Static Blog\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/how-to-build-an-ai-chatbot-with-redis-python-and-gpt/\" rel=\"noopener noreferrer\" target=\"_blank\">Build an AI Chatbot\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/what-is-programming-tutorial-for-beginners/\" rel=\"noopener noreferrer\" target=\"_blank\">What is Programming?\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/python-code-examples-sample-script-coding-tutorial-for-beginners/\" rel=\"noopener noreferrer\" target=\"_blank\">Python Code Examples\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/a-practical-guide-to-start-opensource-contributions/\" rel=\"noopener noreferrer\" target=\"_blank\">Open Source for Devs\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/http-full-course/\" rel=\"noopener noreferrer\" target=\"_blank\">HTTP Networking in JS\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/how-to-write-unit-tests-in-react-redux/\" rel=\"noopener noreferrer\" target=\"_blank\">Write React Unit Tests\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/introduction-to-algorithms-with-javascript-examples/\" rel=\"noopener noreferrer\" target=\"_blank\">Learn Algorithms in JS\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/how-to-write-clean-code/\" rel=\"noopener noreferrer\" target=\"_blank\">How to Write Clean Code\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/the-php-handbook/\" rel=\"noopener noreferrer\" target=\"_blank\">Learn PHP\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/the-java-handbook/\" rel=\"noopener noreferrer\" target=\"_blank\">Learn Java\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/the-swift-handbook/\" rel=\"noopener noreferrer\" target=\"_blank\">Learn Swift\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/learn-golang-handbook/\" rel=\"noopener noreferrer\" target=\"_blank\">Learn Golang\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/get-started-with-nodejs/\" rel=\"noopener noreferrer\" target=\"_blank\">Learn Node.js\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/complete-guide-to-css-grid/\" rel=\"noopener noreferrer\" target=\"_blank\">Learn CSS Grid\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/learn-solidity-handbook/\" rel=\"noopener noreferrer\" target=\"_blank\">Learn Solidity\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/the-express-handbook/\" rel=\"noopener noreferrer\" target=\"_blank\">Learn Express.js\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/javascript-es-modules-and-module-bundlers/\" rel=\"noopener noreferrer\" target=\"_blank\">Learn JS Modules\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/apache-kafka-handbook/\" rel=\"noopener noreferrer\" target=\"_blank\">Learn Apache Kafka\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/rest-api-design-best-practices-build-a-rest-api/\" rel=\"noopener noreferrer\" target=\"_blank\">REST API Best Practices\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/front-end-javascript-development-react-angular-vue-compared/\" rel=\"noopener noreferrer\" target=\"_blank\">Front-End JS Development\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/build-consume-and-document-a-rest-api/\" rel=\"noopener noreferrer\" target=\"_blank\">Learn to Build REST APIs\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/build-strongly-typed-polymorphic-components-with-react-and-typescript/\" rel=\"noopener noreferrer\" target=\"_blank\">Intermediate TS and React\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/command-line-for-beginners/\" rel=\"noopener noreferrer\" target=\"_blank\">Command Line for Beginners\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/an-introduction-to-operating-systems/\" rel=\"noopener noreferrer\" target=\"_blank\">Intro to Operating Systems\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/building-consuming-and-documenting-a-graphql-api/\" rel=\"noopener noreferrer\" target=\"_blank\">Learn to Build GraphQL APIs\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/oss-security-best-practices/\" rel=\"noopener noreferrer\" target=\"_blank\">OSS Security Best Practices\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/design-patterns-for-distributed-systems/\" rel=\"noopener noreferrer\" target=\"_blank\">Distributed Systems Patterns\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/an-introduction-to-software-architecture-patterns/\" rel=\"noopener noreferrer\" target=\"_blank\">Software Architecture Patterns\n                    </a>\n                </li>\n            </ul>\n            <div class=\"spacer\" style=\"padding: 15px 0;\"></div>\n            <div>\n                <h2 id=\"mobile-app\" class=\"col-header\">\n                    Mobile App\n                </h2>\n                <div class=\"min-h-[1px] px-[15px] md:w-2/3 md:ml-[16.6%]\">\n                    <ul aria-labelledby=\"mobile-app\" class=\"mobile-app-container\">\n                        <li>\n                            <a href=\"https://apps.apple.com/us/app/freecodecamp/id6446908151?itsct=apps_box_link&itscg=30200\" rel=\"noopener noreferrer\" target=\"_blank\">\n                                <img src=\"https://cdn.freecodecamp.org/platform/universal/apple-store-badge.svg\" lang=\"en\" alt=\"Download on the App Store\">\n                            </a>\n                        </li>\n                        <li>\n                            <a href=\"https://play.google.com/store/apps/details?id=org.freecodecamp\" rel=\"noopener noreferrer\" target=\"_blank\">\n                                <img src=\"https://cdn.freecodecamp.org/platform/universal/google-play-badge.svg\" lang=\"en\" alt=\"Get it on Google Play\">\n                            </a>\n                        </li>\n                    </ul>\n                </div>\n            </div>\n        </div>\n    </div>\n    <div class=\"footer-bottom\">\n        <h2 class=\"col-header\" data-test-label=\"our-nonprofit\">Our Charity</h2>\n        <div class=\"our-nonprofit\">\n            <a href=\"https://www.freecodecamp.org/news/about/\" rel=\"noopener noreferrer\" target=\"_blank\" data-test-label=\"about\">\n                About\n            </a>\n            <a href=\"https://www.linkedin.com/school/free-code-camp/people/\" rel=\"noopener noreferrer\" target=\"_blank\" data-test-label=\"alumni\">\n                Alumni Network\n            </a>\n            <a href=\"https://github.com/freeCodeCamp/\" rel=\"noopener noreferrer\" target=\"_blank\" data-test-label=\"open-source\">\n                Open Source\n            </a>\n            <a href=\"https://www.freecodecamp.org/news/shop/\" rel=\"noopener noreferrer\" target=\"_blank\" data-test-label=\"shop\">\n                Shop\n            </a>\n            <a href=\"https://www.freecodecamp.org/news/support/\" rel=\"noopener noreferrer\" target=\"_blank\" data-test-label=\"support\">\n                Support\n            </a>\n            <a href=\"https://www.freecodecamp.org/news/sponsors/\" rel=\"noopener noreferrer\" target=\"_blank\" data-test-label=\"sponsors\">\n                Sponsors\n            </a>\n            <a href=\"https://www.freecodecamp.org/news/academic-honesty-policy/\" rel=\"noopener noreferrer\" target=\"_blank\" data-test-label=\"honesty\">\n                Academic Honesty\n            </a>\n            <a href=\"https://www.freecodecamp.org/news/code-of-conduct/\" rel=\"noopener noreferrer\" target=\"_blank\" data-test-label=\"coc\">\n                Code of Conduct\n            </a>\n            <a href=\"https://www.freecodecamp.org/news/privacy-policy/\" rel=\"noopener noreferrer\" target=\"_blank\" data-test-label=\"privacy\">\n                Privacy Policy\n            </a>\n            <a href=\"https://www.freecodecamp.org/news/terms-of-service/\" rel=\"noopener noreferrer\" target=\"_blank\" data-test-label=\"tos\">\n                Terms of Service\n            </a>\n            <a href=\"https://www.freecodecamp.org/news/copyright-policy/\" rel=\"noopener noreferrer\" target=\"_blank\" data-test-label=\"copyright\">\n                Copyright Policy\n            </a>\n        </div>\n    </div>\n</footer>\n\n        </div>\n\n        \n        \n        \n\n        <!-- Google Tag Manager (noscript) -->\n<noscript><iframe src=\"https://www.googletagmanager.com/ns.html?id=GTM-5D6RKKP\" height=\"0\" width=\"0\" style=\"display:none;visibility:hidden\"></iframe></noscript>\n<!-- End Google Tag Manager (noscript) -->\n\n        \n    <script defer src=\"https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015\" integrity=\"sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==\" data-cf-beacon='{\"rayId\":\"8ac2200e988b6bbe\",\"serverTiming\":{\"name\":{\"cfL4\":true}},\"version\":\"2024.7.0\",\"token\":\"bdb993c6dde44e178aabd9555e75e4f4\"}' crossorigin=\"anonymous\"></script>\n</body>\n</html>\n"},"https://www.freecodecamp.org//news/defending-against-ssrf-attacks/":{"metadata":[{"tagName":"meta","attributes":{"charset":"utf-8"},"content":""},{"tagName":"meta","attributes":{"http-equiv":"X-UA-Compatible","content":"IE=edge"},"content":""},{"tagName":"title","attributes":{},"content":"How to Defend Against Server-Side Request Forgery"},{"tagName":"meta","attributes":{"name":"HandheldFriendly","content":"True"},"content":""},{"tagName":"meta","attributes":{"name":"viewport","content":"width=device-width, initial-scale=1.0"},"content":""},{"tagName":"link","attributes":{"rel":"preconnect","href":"https://fonts.googleapis.com"},"content":""},{"tagName":"link","attributes":{"rel":"preconnect","href":"https://fonts.gstatic.com","crossorigin":""},"content":""},{"tagName":"link","attributes":{"rel":"preload","as":"style","onload":"this.onload=null;this.rel='stylesheet'","href":"https://fonts.googleapis.com/css2?family=Lato:ital,wght@0,300;0,400;0,700;1,400&family=Roboto+Mono:wght@400;700&display=swap"},"content":""},{"tagName":"link","attributes":{"rel":"preload","as":"style","onload":"this.onload=null;this.rel='stylesheet'","href":"https://cdn.freecodecamp.org/news-assets/prism/1.29.0/themes/prism.min.css"},"content":""},{"tagName":"noscript","attributes":{},"content":"\n  <link rel=\"stylesheet\" href=\"https://cdn.freecodecamp.org/news-assets/prism/1.29.0/themes/prism.min.css\">\n"},{"tagName":"link","attributes":{"rel":"preload","as":"style","onload":"this.onload=null;this.rel='stylesheet'","href":"https://cdn.freecodecamp.org/news-assets/prism/1.29.0/plugins/unescaped-markup/prism-unescaped-markup.min.css"},"content":""},{"tagName":"noscript","attributes":{},"content":"\n  <link rel=\"stylesheet\" href=\"https://cdn.freecodecamp.org/news-assets/prism/1.29.0/plugins/unescaped-markup/prism-unescaped-markup.min.css\">\n"},{"tagName":"script","attributes":{"defer":"","src":"https://cdn.freecodecamp.org/news-assets/prism/1.29.0/components/prism-core.min.js"},"content":""},{"tagName":"script","attributes":{"defer":"","src":"https://cdn.freecodecamp.org/news-assets/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"},"content":""},{"tagName":"link","attributes":{"rel":"preload","as":"style","onload":"this.onload=null;this.rel='stylesheet'","href":"/news/assets/css/global-26e2f3cde9.css"},"content":""},{"tagName":"link","attributes":{"rel":"stylesheet","type":"text/css","href":"/news/assets/css/screen-926fddfac2.css"},"content":""},{"tagName":"link","attributes":{"rel":"stylesheet","type":"text/css","href":"/news/assets/css/search-bar-124f5f949c.css"},"content":""},{"tagName":"script","attributes":{"defer":"","src":"https://cdn.freecodecamp.org/news-assets/algolia/algoliasearch-3-33-0/algoliasearch.min.js"},"content":""},{"tagName":"script","attributes":{"defer":"","src":"https://cdn.freecodecamp.org/news-assets/algolia/autocomplete-0-36-0/autocomplete.min.js"},"content":""},{"tagName":"script","attributes":{"defer":"","src":"https://cdn.freecodecamp.org/news-assets/dayjs/1.10.4/dayjs.min.js"},"content":""},{"tagName":"script","attributes":{"defer":"","src":"https://cdn.freecodecamp.org/news-assets/dayjs/1.10.4/localizedFormat.min.js"},"content":""},{"tagName":"script","attributes":{"defer":"","src":"https://cdn.freecodecamp.org/news-assets/dayjs/1.10.4/relativeTime.min.js"},"content":""},{"tagName":"script","attributes":{"defer":"","src":"https://cdn.freecodecamp.org/news-assets/dayjs/1.10.4/locale/en.min.js"},"content":""},{"tagName":"script","attributes":{},"content":"let client,index;document.addEventListener(\"DOMContentLoaded\",(()=>{client=algoliasearch(\"QMJYL5WYTI\",\"89770b24481654192d7a5c402c6ad9a0\"),index=client.initIndex(\"news\")})),document.addEventListener(\"DOMContentLoaded\",(()=>{const e=window.screen.width,t=window.screen.height,n=e>=767&&t>=768?8:5,o=document.getElementById(\"search-form\"),s=document.getElementById(\"search-input\"),a=document.getElementById(\"dropdown-container\");let i,d,c;s.addEventListener(\"input\",(e=>{i=e.target.value})),o.addEventListener(\"submit\",(e=>{e.preventDefault(),function(){if(d=document.getElementsByClassName(\"aa-cursor\")[0],d&&i){const e=d.querySelector(\"a\").href;window.location.assign(e)}else!d&&i&&c&&window.location.assign(`https://www.freecodecamp.org/news/search?query=${i}`)}()}));const l=autocomplete(\"#search-input\",{hint:!1,keyboardShortcuts:[\"s\",191],openOnFocus:!0,appendTo:a,debug:!0},[{source:autocomplete.sources.hits(index,{hitsPerPage:n}),debounce:250,templates:{suggestion:e=>(c=!0,`\\n            <a href=\"${e.url}\">\\n              <div class=\"algolia-result\">\\n                <span>${e._highlightResult.title.value}</span>\\n              </div>\\n            </a>\\n          `),empty:()=>(c=!1,'\\n            <div class=\"aa-suggestion footer-suggestion no-hits-footer\">\\n              <div class=\"algolia-result\">\\n                <span>\\n                  No tutorials found\\n                </span>\\n              </div>\\n            </div>\\n          '),footer:e=>{if(!e.isEmpty)return`\\n              <div class=\"aa-suggestion footer-suggestion\">\\n                <a id=\"algolia-footer-selector\" href=\"https://www.freecodecamp.org/news/search?query=${i}\">\\n                  <div class=\"algolia-result algolia-footer\">\\n                    See all results for ${i}\\n                  </div>\\n                </a>\\n              </div>\\n            `}}}]).on(\"autocomplete:selected\",((e,t,n,o)=>{d=t?t.url:`https://www.freecodecamp.org/news/search?query=${i}`,\"click\"!==o.selectionMethod&&\"tabKey\"!==o.selectionMethod&&c&&window.location.assign(d)}));document.addEventListener(\"click\",(e=>{e.target!==s&&l.autocomplete.close()}))})),document.addEventListener(\"DOMContentLoaded\",(()=>{dayjs.extend(dayjs_plugin_localizedFormat),dayjs.extend(dayjs_plugin_relativeTime),dayjs.locale(\"en\")}));const isAuthenticated=document.cookie.split(\";\").some((e=>e.trim().startsWith(\"jwt_access_token=\"))),isDonor=document.cookie.split(\";\").some((e=>e.trim().startsWith(\"isDonor=true\")));"},{"tagName":"script","attributes":{"data-ad-client":"ca-pub-9482786369113753","src":"https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js","crossorigin":"anonymous","async":""},"content":""},{"tagName":"link","attributes":{"rel":"icon","href":"https://cdn.freecodecamp.org/universal/favicons/favicon.ico","type":"image/png"},"content":""},{"tagName":"link","attributes":{"rel":"canonical","href":"https://www.freecodecamp.org/news/defending-against-ssrf-attacks/"},"content":""},{"tagName":"meta","attributes":{"name":"referrer","content":"no-referrer-when-downgrade"},"content":""},{"tagName":"meta","attributes":{"name":"description","content":"Server-Side Request Forgery (SSRF) has been a consistent issue in application security and is among the OWASP Top 10 vulnerabilities.  In this walkthrough, you'll first learn what Server-Side Request Forgery is and how it differs from Client-Side Request Forgery. We will create a sample application to gain a better"},"content":""},{"tagName":"meta","attributes":{"property":"og:site_name","content":"freeCodeCamp.org"},"content":""},{"tagName":"meta","attributes":{"property":"og:type","content":"article"},"content":""},{"tagName":"meta","attributes":{"property":"og:title","content":"How to Defend Against Server-Side Request Forgery"},"content":""},{"tagName":"meta","attributes":{"property":"og:description","content":"Server-Side Request Forgery (SSRF) has been a consistent issue in application security and is among the OWASP Top 10 vulnerabilities.  In this walkthrough, you'll first learn what Server-Side Request Forgery is and how it differs from Client-Side Request Forgery. We will create a sample application to gain a better"},"content":""},{"tagName":"meta","attributes":{"property":"og:url","content":"https://www.freecodecamp.org/news/defending-against-ssrf-attacks/"},"content":""},{"tagName":"meta","attributes":{"property":"og:image","content":"https://www.freecodecamp.org/news/content/images/2024/01/Frame-864.svg"},"content":""},{"tagName":"meta","attributes":{"property":"article:published_time","content":"2024-01-05T17:21:50.000Z"},"content":""},{"tagName":"meta","attributes":{"property":"article:modified_time","content":"2024-01-05T17:21:50.000Z"},"content":""},{"tagName":"meta","attributes":{"property":"article:tag","content":"Security"},"content":""},{"tagName":"meta","attributes":{"property":"article:tag","content":"Information Security"},"content":""},{"tagName":"meta","attributes":{"property":"article:tag","content":"back end development"},"content":""},{"tagName":"meta","attributes":{"property":"article:publisher","content":"https://www.facebook.com/freecodecamp"},"content":""},{"tagName":"meta","attributes":{"name":"twitter:card","content":"summary_large_image"},"content":""},{"tagName":"meta","attributes":{"name":"twitter:title","content":"How to Defend Against Server-Side Request Forgery"},"content":""},{"tagName":"meta","attributes":{"name":"twitter:description","content":"Server-Side Request Forgery (SSRF) has been a consistent issue in application security and is among the OWASP Top 10 vulnerabilities.  In this walkthrough, you'll first learn what Server-Side Request Forgery is and how it differs from Client-Side Request Forgery. We will create a sample application to gain a better"},"content":""},{"tagName":"meta","attributes":{"name":"twitter:url","content":"https://www.freecodecamp.org/news/defending-against-ssrf-attacks/"},"content":""},{"tagName":"meta","attributes":{"name":"twitter:image","content":"https://www.freecodecamp.org/news/content/images/2024/01/Frame-864.svg"},"content":""},{"tagName":"meta","attributes":{"name":"twitter:label1","content":"Written by"},"content":""},{"tagName":"meta","attributes":{"name":"twitter:data1","content":"Hamdaan Ali"},"content":""},{"tagName":"meta","attributes":{"name":"twitter:label2","content":"Filed under"},"content":""},{"tagName":"meta","attributes":{"name":"twitter:data2","content":"Security, Information Security, back end development"},"content":""},{"tagName":"meta","attributes":{"name":"twitter:site","content":"@freecodecamp"},"content":""},{"tagName":"meta","attributes":{"name":"twitter:creator","content":"@violinblackeye"},"content":""},{"tagName":"meta","attributes":{"property":"og:image:width","content":"1200"},"content":""},{"tagName":"meta","attributes":{"property":"og:image:height","content":"630"},"content":""},{"tagName":"script","attributes":{"type":"application/ld+json"},"content":"{\n\t\"@context\": \"https://schema.org\",\n\t\"@type\": \"Article\",\n\t\"publisher\": {\n\t\t\"@type\": \"Organization\",\n\t\t\"name\": \"freeCodeCamp.org\",\n\t\t\"url\": \"https://www.freecodecamp.org/news/\",\n\t\t\"logo\": {\n\t\t\t\"@type\": \"ImageObject\",\n\t\t\t\"url\": \"https://cdn.freecodecamp.org/platform/universal/fcc_primary.svg\",\n\t\t\t\"width\": 2100,\n\t\t\t\"height\": 240\n\t\t}\n\t},\n\t\"image\": {\n\t\t\"@type\": \"ImageObject\",\n\t\t\"url\": \"https://www.freecodecamp.org/news/content/images/2024/01/Frame-864.svg\",\n\t\t\"width\": 1200,\n\t\t\"height\": 630\n\t},\n\t\"url\": \"https://www.freecodecamp.org/news/defending-against-ssrf-attacks/\",\n\t\"mainEntityOfPage\": {\n\t\t\"@type\": \"WebPage\",\n\t\t\"@id\": \"https://www.freecodecamp.org/news/\"\n\t},\n\t\"datePublished\": \"2024-01-05T17:21:50.000Z\",\n\t\"dateModified\": \"2024-01-05T17:21:50.000Z\",\n\t\"keywords\": \"Security, Information Security, back end development\",\n\t\"description\": \"Server-Side Request Forgery (SSRF) has been a consistent issue in application\\nsecurity and is among the OWASP Top 10 vulnerabilities. \\n\\nIn this walkthrough, you&#x27;ll first learn what Server-Side Request Forgery is and\\nhow it differs from Client-Side Request Forgery. We will create a sample\\napplication to gain a better understanding of how Server-Side Request Forgery\\nattacks work, and explore various methods to safeguard our application against\\nSSRF vulnerabilities.\\n\\nTable of Contents:\\n * Prerequis\",\n\t\"headline\": \"How to Defend Against Server-Side Request Forgery\",\n\t\"author\": {\n\t\t\"@type\": \"Person\",\n\t\t\"name\": \"Hamdaan Ali\",\n\t\t\"url\": \"https://www.freecodecamp.org/news/author/hamdaan/\",\n\t\t\"sameAs\": [\n\t\t\t\"https://www.linkedin.com/in/hamdaanali/\",\n\t\t\t\"https://twitter.com/violinblackeye\"\n\t\t],\n\t\t\"image\": {\n\t\t\t\"@type\": \"ImageObject\",\n\t\t\t\"url\": \"https://www.freecodecamp.org/news/content/images/2023/11/698-crop.jpg\",\n\t\t\t\"width\": 1050,\n\t\t\t\"height\": 1103\n\t\t}\n\t}\n}"},{"tagName":"meta","attributes":{"name":"generator","content":"Eleventy"},"content":""},{"tagName":"link","attributes":{"rel":"alternate","type":"application/rss+xml","title":"freeCodeCamp.org","href":"https://www.freecodecamp.org/news/rss/"},"content":""},{"tagName":"link","attributes":{"rel":"preconnect","href":"https://fonts.gstatic.com"},"content":""},{"tagName":"script","attributes":{},"content":"\nwindow.dataLayer = window.dataLayer || [];\n"},{"tagName":"script","attributes":{},"content":"(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':\nnew Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],\nj=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=\n'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);\n})(window,document,'script','dataLayer','GTM-5D6RKKP');"},{"tagName":"meta","attributes":{"name":"google-site-verification","content":"b4tITLzEeeZGEpvD4mGNf3khKM4fvqejQaz9SYBQP8E"},"content":""},{"tagName":"meta","attributes":{"name":"x-fcc-source","data-test-label":"x-fcc-source","content":"Ghost"},"content":""}],"html":"<!DOCTYPE html>\n<html lang=\"en\">\n    <head>\n        <meta charset=\"utf-8\">\n        <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\n        \n        \n            <title>How to Defend Against Server-Side Request Forgery</title>\n        \n        <meta name=\"HandheldFriendly\" content=\"True\">\n        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n\n        <link rel=\"preconnect\" href=\"https://fonts.googleapis.com\">\n        <link rel=\"preconnect\" href=\"https://fonts.gstatic.com\" crossorigin=\"\">\n        \n            <link rel=\"preload\" as=\"style\" onload=\"this.onload=null;this.rel='stylesheet'\" href=\"https://fonts.googleapis.com/css2?family=Lato:ital,wght@0,300;0,400;0,700;1,400&family=Roboto+Mono:wght@400;700&display=swap\">\n        \n\n        \n        \n    <link rel=\"preload\" as=\"style\" onload=\"this.onload=null;this.rel='stylesheet'\" href=\"https://cdn.freecodecamp.org/news-assets/prism/1.29.0/themes/prism.min.css\">\n<noscript>\n  <link rel=\"stylesheet\" href=\"https://cdn.freecodecamp.org/news-assets/prism/1.29.0/themes/prism.min.css\">\n</noscript>\n<link rel=\"preload\" as=\"style\" onload=\"this.onload=null;this.rel='stylesheet'\" href=\"https://cdn.freecodecamp.org/news-assets/prism/1.29.0/plugins/unescaped-markup/prism-unescaped-markup.min.css\">\n<noscript>\n  <link rel=\"stylesheet\" href=\"https://cdn.freecodecamp.org/news-assets/prism/1.29.0/plugins/unescaped-markup/prism-unescaped-markup.min.css\">\n</noscript>\n\n<script defer=\"\" src=\"https://cdn.freecodecamp.org/news-assets/prism/1.29.0/components/prism-core.min.js\"></script>\n<script defer=\"\" src=\"https://cdn.freecodecamp.org/news-assets/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js\"></script>\n\n\n\n        \n        <link rel=\"preload\" as=\"style\" onload=\"this.onload=null;this.rel='stylesheet'\" href=\"/news/assets/css/global-26e2f3cde9.css\">\n        <link rel=\"stylesheet\" type=\"text/css\" href=\"/news/assets/css/screen-926fddfac2.css\">\n        <link rel=\"stylesheet\" type=\"text/css\" href=\"/news/assets/css/search-bar-124f5f949c.css\">\n\n        \n        <script defer=\"\" src=\"https://cdn.freecodecamp.org/news-assets/algolia/algoliasearch-3-33-0/algoliasearch.min.js\"></script>\n        <script defer=\"\" src=\"https://cdn.freecodecamp.org/news-assets/algolia/autocomplete-0-36-0/autocomplete.min.js\"></script>\n\n        \n        <script defer=\"\" src=\"https://cdn.freecodecamp.org/news-assets/dayjs/1.10.4/dayjs.min.js\"></script>\n        <script defer=\"\" src=\"https://cdn.freecodecamp.org/news-assets/dayjs/1.10.4/localizedFormat.min.js\"></script>\n        <script defer=\"\" src=\"https://cdn.freecodecamp.org/news-assets/dayjs/1.10.4/relativeTime.min.js\"></script>\n\n        \n        \n            <script defer=\"\" src=\"https://cdn.freecodecamp.org/news-assets/dayjs/1.10.4/locale/en.min.js\"></script>\n        \n\n        \n        <script>let client,index;document.addEventListener(\"DOMContentLoaded\",(()=>{client=algoliasearch(\"QMJYL5WYTI\",\"89770b24481654192d7a5c402c6ad9a0\"),index=client.initIndex(\"news\")})),document.addEventListener(\"DOMContentLoaded\",(()=>{const e=window.screen.width,t=window.screen.height,n=e>=767&&t>=768?8:5,o=document.getElementById(\"search-form\"),s=document.getElementById(\"search-input\"),a=document.getElementById(\"dropdown-container\");let i,d,c;s.addEventListener(\"input\",(e=>{i=e.target.value})),o.addEventListener(\"submit\",(e=>{e.preventDefault(),function(){if(d=document.getElementsByClassName(\"aa-cursor\")[0],d&&i){const e=d.querySelector(\"a\").href;window.location.assign(e)}else!d&&i&&c&&window.location.assign(`https://www.freecodecamp.org/news/search?query=${i}`)}()}));const l=autocomplete(\"#search-input\",{hint:!1,keyboardShortcuts:[\"s\",191],openOnFocus:!0,appendTo:a,debug:!0},[{source:autocomplete.sources.hits(index,{hitsPerPage:n}),debounce:250,templates:{suggestion:e=>(c=!0,`\\n            <a href=\"${e.url}\">\\n              <div class=\"algolia-result\">\\n                <span>${e._highlightResult.title.value}</span>\\n              </div>\\n            </a>\\n          `),empty:()=>(c=!1,'\\n            <div class=\"aa-suggestion footer-suggestion no-hits-footer\">\\n              <div class=\"algolia-result\">\\n                <span>\\n                  No tutorials found\\n                </span>\\n              </div>\\n            </div>\\n          '),footer:e=>{if(!e.isEmpty)return`\\n              <div class=\"aa-suggestion footer-suggestion\">\\n                <a id=\"algolia-footer-selector\" href=\"https://www.freecodecamp.org/news/search?query=${i}\">\\n                  <div class=\"algolia-result algolia-footer\">\\n                    See all results for ${i}\\n                  </div>\\n                </a>\\n              </div>\\n            `}}}]).on(\"autocomplete:selected\",((e,t,n,o)=>{d=t?t.url:`https://www.freecodecamp.org/news/search?query=${i}`,\"click\"!==o.selectionMethod&&\"tabKey\"!==o.selectionMethod&&c&&window.location.assign(d)}));document.addEventListener(\"click\",(e=>{e.target!==s&&l.autocomplete.close()}))})),document.addEventListener(\"DOMContentLoaded\",(()=>{dayjs.extend(dayjs_plugin_localizedFormat),dayjs.extend(dayjs_plugin_relativeTime),dayjs.locale(\"en\")}));const isAuthenticated=document.cookie.split(\";\").some((e=>e.trim().startsWith(\"jwt_access_token=\"))),isDonor=document.cookie.split(\";\").some((e=>e.trim().startsWith(\"isDonor=true\")));</script>\n\n        \n        \n    \n        \n            <script data-ad-client=\"ca-pub-9482786369113753\" src=\"https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js\" crossorigin=\"anonymous\" async=\"\"></script>\n        \n    \n\n\n        \n        \n    \n        \n    \n        \n    \n        \n    \n\n\n        \n        \n        \n\n        \n        \n\n        <link rel=\"icon\" href=\"https://cdn.freecodecamp.org/universal/favicons/favicon.ico\" type=\"image/png\">\n        \n        \n            <link rel=\"canonical\" href=\"https://www.freecodecamp.org/news/defending-against-ssrf-attacks/\">\n        \n        <meta name=\"referrer\" content=\"no-referrer-when-downgrade\">\n\n        \n\n        \n    <meta name=\"description\" content=\"Server-Side Request Forgery (SSRF) has been a consistent issue in application security and is among the OWASP Top 10 vulnerabilities.  In this walkthrough, you&#39;ll first learn what Server-Side Request Forgery is and how it differs from Client-Side Request Forgery. We will create a sample application to gain a better\">\n\n    \n    <meta property=\"og:site_name\" content=\"freeCodeCamp.org\">\n    <meta property=\"og:type\" content=\"article\">\n    <meta property=\"og:title\" content=\"How to Defend Against Server-Side Request Forgery\">\n    \n        <meta property=\"og:description\" content=\"Server-Side Request Forgery (SSRF) has been a consistent issue in application security and is among the OWASP Top 10 vulnerabilities.  In this walkthrough, you&#39;ll first learn what Server-Side Request Forgery is and how it differs from Client-Side Request Forgery. We will create a sample application to gain a better\">\n    \n    <meta property=\"og:url\" content=\"https://www.freecodecamp.org/news/defending-against-ssrf-attacks/\">\n    <meta property=\"og:image\" content=\"https://www.freecodecamp.org/news/content/images/2024/01/Frame-864.svg\">\n    <meta property=\"article:published_time\" content=\"2024-01-05T17:21:50.000Z\">\n    <meta property=\"article:modified_time\" content=\"2024-01-05T17:21:50.000Z\">\n    \n        <meta property=\"article:tag\" content=\"Security\">\n    \n        <meta property=\"article:tag\" content=\"Information Security\">\n    \n        <meta property=\"article:tag\" content=\"back end development\">\n    \n    <meta property=\"article:publisher\" content=\"https://www.facebook.com/freecodecamp\">\n    \n\n    \n    <meta name=\"twitter:card\" content=\"summary_large_image\">\n    <meta name=\"twitter:title\" content=\"How to Defend Against Server-Side Request Forgery\">\n    \n        <meta name=\"twitter:description\" content=\"Server-Side Request Forgery (SSRF) has been a consistent issue in application security and is among the OWASP Top 10 vulnerabilities.  In this walkthrough, you&#39;ll first learn what Server-Side Request Forgery is and how it differs from Client-Side Request Forgery. We will create a sample application to gain a better\">\n    \n    <meta name=\"twitter:url\" content=\"https://www.freecodecamp.org/news/defending-against-ssrf-attacks/\">\n    <meta name=\"twitter:image\" content=\"https://www.freecodecamp.org/news/content/images/2024/01/Frame-864.svg\">\n    <meta name=\"twitter:label1\" content=\"Written by\">\n    <meta name=\"twitter:data1\" content=\"Hamdaan Ali\">\n    <meta name=\"twitter:label2\" content=\"Filed under\">\n    <meta name=\"twitter:data2\" content=\"Security, Information Security, back end development\">\n    <meta name=\"twitter:site\" content=\"@freecodecamp\">\n    \n        <meta name=\"twitter:creator\" content=\"@violinblackeye\">\n    \n\n    <meta property=\"og:image:width\" content=\"1200\">\n    <meta property=\"og:image:height\" content=\"630\">\n\n\n        \n    <script type=\"application/ld+json\">{\n\t\"@context\": \"https://schema.org\",\n\t\"@type\": \"Article\",\n\t\"publisher\": {\n\t\t\"@type\": \"Organization\",\n\t\t\"name\": \"freeCodeCamp.org\",\n\t\t\"url\": \"https://www.freecodecamp.org/news/\",\n\t\t\"logo\": {\n\t\t\t\"@type\": \"ImageObject\",\n\t\t\t\"url\": \"https://cdn.freecodecamp.org/platform/universal/fcc_primary.svg\",\n\t\t\t\"width\": 2100,\n\t\t\t\"height\": 240\n\t\t}\n\t},\n\t\"image\": {\n\t\t\"@type\": \"ImageObject\",\n\t\t\"url\": \"https://www.freecodecamp.org/news/content/images/2024/01/Frame-864.svg\",\n\t\t\"width\": 1200,\n\t\t\"height\": 630\n\t},\n\t\"url\": \"https://www.freecodecamp.org/news/defending-against-ssrf-attacks/\",\n\t\"mainEntityOfPage\": {\n\t\t\"@type\": \"WebPage\",\n\t\t\"@id\": \"https://www.freecodecamp.org/news/\"\n\t},\n\t\"datePublished\": \"2024-01-05T17:21:50.000Z\",\n\t\"dateModified\": \"2024-01-05T17:21:50.000Z\",\n\t\"keywords\": \"Security, Information Security, back end development\",\n\t\"description\": \"Server-Side Request Forgery (SSRF) has been a consistent issue in application\\nsecurity and is among the OWASP Top 10 vulnerabilities. \\n\\nIn this walkthrough, you&#x27;ll first learn what Server-Side Request Forgery is and\\nhow it differs from Client-Side Request Forgery. We will create a sample\\napplication to gain a better understanding of how Server-Side Request Forgery\\nattacks work, and explore various methods to safeguard our application against\\nSSRF vulnerabilities.\\n\\nTable of Contents:\\n * Prerequis\",\n\t\"headline\": \"How to Defend Against Server-Side Request Forgery\",\n\t\"author\": {\n\t\t\"@type\": \"Person\",\n\t\t\"name\": \"Hamdaan Ali\",\n\t\t\"url\": \"https://www.freecodecamp.org/news/author/hamdaan/\",\n\t\t\"sameAs\": [\n\t\t\t\"https://www.linkedin.com/in/hamdaanali/\",\n\t\t\t\"https://twitter.com/violinblackeye\"\n\t\t],\n\t\t\"image\": {\n\t\t\t\"@type\": \"ImageObject\",\n\t\t\t\"url\": \"https://www.freecodecamp.org/news/content/images/2023/11/698-crop.jpg\",\n\t\t\t\"width\": 1050,\n\t\t\t\"height\": 1103\n\t\t}\n\t}\n}</script>\n\n\n        <meta name=\"generator\" content=\"Eleventy\">\n        <link rel=\"alternate\" type=\"application/rss+xml\" title=\"freeCodeCamp.org\" href=\"https://www.freecodecamp.org/news/rss/\">\n\n        <link rel=\"preconnect\" href=\"https://fonts.gstatic.com\">\n\n<!-- dataLayer setup -->\n<script>\nwindow.dataLayer = window.dataLayer || [];\n</script>\n<!-- End dataLayer setup -->\n\n<!-- Google Tag Manager -->\n<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':\nnew Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],\nj=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=\n'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);\n})(window,document,'script','dataLayer','GTM-5D6RKKP');</script>\n<!-- End Google Tag Manager -->\n\n\n<meta name=\"google-site-verification\" content=\"b4tITLzEeeZGEpvD4mGNf3khKM4fvqejQaz9SYBQP8E\">\n\n        \n        \n\n        \n  <meta name=\"x-fcc-source\" data-test-label=\"x-fcc-source\" content=\"Ghost\">\n\n    </head>\n\n    \n        <body class=\"home-template\">\n    \n        <div class=\"site-wrapper\">\n            <nav class=\"site-nav nav-padding\">\n    <div class=\"site-nav-left\">\n        \n<form id=\"search-form\" data-test-label=\"search-bar\">\n    <div role=\"search\" class=\"searchbox__wrapper\">\n        <label class=\"fcc_sr_only\" for=\"search-input\">\n            Search\n        </label>\n        <input type=\"search\" placeholder=\"\n    Search 11,200+ tutorials\n\" id=\"search-input\">\n        <button type=\"submit\" class=\"ais-SearchBox-submit\">\n            <svg class=\"ais-SearchBox-submitIcon\" xmlns=\"https://www.w3.org/2000/svg\" width=\"10\" height=\"10\" viewBox=\"0 0 40 40\">\n    <path d=\"M26.804 29.01c-2.832 2.34-6.465 3.746-10.426 3.746C7.333 32.756 0 25.424 0 16.378 0 7.333 7.333 0 16.378 0c9.046 0 16.378 7.333 16.378 16.378 0 3.96-1.406 7.594-3.746 10.426l10.534 10.534c.607.607.61 1.59-.004 2.202-.61.61-1.597.61-2.202.004L26.804 29.01zm-10.426.627c7.323 0 13.26-5.936 13.26-13.26 0-7.32-5.937-13.257-13.26-13.257C9.056 3.12 3.12 9.056 3.12 16.378c0 7.323 5.936 13.26 13.258 13.26z\"></path>\n</svg>\n\n            <span class=\"fcc_sr_only\">Submit your search query</span>\n        </button>\n        <div id=\"dropdown-container\"></div>\n    </div>\n</form>\n\n    </div>\n    <div class=\"site-nav-middle\">\n        <a class=\"site-nav-logo\" href=\"https://www.freecodecamp.org/news/\" data-test-label=\"site-nav-logo\"><img src=\"https://cdn.freecodecamp.org/platform/universal/fcc_primary.svg\" alt=\"freeCodeCamp.org\"></a>\n    </div>\n    <div class=\"site-nav-right\">\n        <div class=\"nav-group\">\n            <a class=\"nav-forum\" id=\"nav-forum\" rel=\"noopener noreferrer\" href=\"https://forum.freecodecamp.org/\" target=\"_blank\" data-test-label=\"forum-button\">Forum</a>\n            <a class=\"toggle-button-nav\" id=\"nav-donate\" rel=\"noopener noreferrer\" href=\"https://www.freecodecamp.org/donate/\" target=\"_blank\" data-test-label=\"donate-button\">Donate</a>\n        </div>\n    </div>\n</nav>\n\n\n            \n            <a class=\"banner\" id=\"banner\" data-test-label=\"banner\" rel=\"noopener noreferrer\" target=\"_blank\">\n    <p id=\"banner-text\"></p>\n</a>\n\n\n    \n    <script>document.addEventListener(\"DOMContentLoaded\",(()=>{const e=document.getElementById(\"banner\"),t=document.getElementById(\"banner-text\");isAuthenticated?(t.innerHTML=\"Support our charity and our mission. <span>Donate to freeCodeCamp.org</span>.\",e.href=\"https://www.freecodecamp.org/donate\",e.setAttribute(\"text-variation\",\"authenticated\")):isDonor?(t.innerHTML=\"Thank you for supporting freeCodeCamp through <span>your donations</span>.\",e.href=\"https://www.freecodecamp.org/news/how-to-donate-to-free-code-camp/\",e.setAttribute(\"text-variation\",\"donor\")):(t.innerHTML=\"Learn to code — <span>free 3,000-hour curriculum</span>\",e.href=\"https://www.freecodecamp.org/\",e.setAttribute(\"text-variation\",\"default\"))}));</script>\n\n\n            <div id=\"error-message\"></div>\n\n            \n    <main id=\"site-main\" class=\"post-template site-main outer\">\n        <div class=\"inner ad-layout\">\n            <article class=\"post-full post\">\n                <header class=\"post-full-header\">\n                    <section class=\"post-full-meta\">\n                        <time class=\"post-full-meta-date\" data-test-label=\"post-full-meta-date\" datetime=\"Fri Jan 05 2024 17:21:50 GMT+0000 (Coordinated Universal Time)\">\n                            January 5, 2024\n                        </time>\n                        \n                            <span class=\"date-divider\">/</span>\n                            <a dir=\"ltr\" href=\"/news/tag/security/\">\n                                #Security\n                            </a>\n                        \n                    </section>\n                    <h1 class=\"post-full-title\" data-test-label=\"post-full-title\">How to Defend Against Server-Side Request Forgery</h1>\n                </header>\n                <div class=\"post-full-author-header\" data-test-label=\"author-header-no-bio\">\n                    \n                        \n                            \n    \n    \n    \n\n    <section class=\"author-card\" data-test-label=\"author-card\">\n        \n            \n    <img srcset=\"https://www.freecodecamp.org/news/content/images/size/w60/2023/11/698-crop.jpg 60w\" sizes=\"60px\" src=\"https://www.freecodecamp.org/news/content/images/size/w60/2023/11/698-crop.jpg\" class=\"author-profile-image\" alt=\"Hamdaan Ali\" width=\"1050\" height=\"1103\" onerror=\"this.style.display='none'\" data-test-label=\"profile-image\">\n  \n        \n\n        <section class=\"author-card-content author-card-content-no-bio\">\n            <span class=\"author-card-name\">\n                <a href=\"/news/author/hamdaan/\" data-test-label=\"profile-link\">\n                    \n                        Hamdaan Ali\n                    \n                </a>\n            </span>\n            \n        </section>\n    </section>\n\n                        \n                    \n                </div>\n                <figure class=\"post-full-image\">\n                    \n    <picture>\n      <source media=\"(max-width: 700px)\" sizes=\"1px\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 1w\">\n      <source media=\"(min-width: 701px)\" sizes=\"(max-width: 800px) 400px, (max-width: 1170px) 700px, 1400px\" srcset=\"https://www.freecodecamp.org/news/content/images/size/w300/2024/01/Frame-864.svg 300w, https://www.freecodecamp.org/news/content/images/size/w600/2024/01/Frame-864.svg 600w, https://www.freecodecamp.org/news/content/images/size/w1000/2024/01/Frame-864.svg 1000w, https://www.freecodecamp.org/news/content/images/size/w2000/2024/01/Frame-864.svg 2000w\">\n      <img onerror=\"this.style.display='none'\" src=\"https://www.freecodecamp.org/news/content/images/size/w2000/2024/01/Frame-864.svg\" alt=\"How to Defend Against Server-Side Request Forgery\" ,=\"\" width=\"1200\" height=\"630\" data-test-label=\"feature-image\">\n    </picture>\n  \n                </figure>\n                <section class=\"post-full-content\">\n                    <div class=\"post-and-sidebar\">\n                        <section class=\"post-content \" data-test-label=\"post-content\">\n                            \n<p>Server-Side Request Forgery (SSRF) has been a consistent issue in application security and is among the OWASP Top 10 vulnerabilities. </p><p>In this walkthrough, you'll first learn what Server-Side Request Forgery is and how it differs from Client-Side Request Forgery. We will create a sample application to gain a better understanding of how Server-Side Request Forgery attacks work, and explore various methods to safeguard our application against SSRF vulnerabilities.</p><h2 id=\"table-of-contents-\">Table of Contents:</h2><ul><li><a href=\"#prerequisites\">Prerequisites</a></li><li><a href=\"#what-is-server-side-request-forgery\">What is Server-Side Request Forgery?</a></li><li><a href=\"#how-does-ssrf-differ-from-csrf\">How Does SSRF Differ from CSRF?</a></li><li><a href=\"#identifying-code-smells\">Identifying Code Smells</a></li><li><a href=\"#understanding-the-pain-points\">Understanding the Pain Points</a></li><li><a href=\"#project-setup\">Project Setup</a></li><li><a href=\"#how-to-exploit-the-vulnerability\">How to Exploit the Vulnerability</a></li><li><a href=\"#how-to-defend-against-ssrf-attacks\">How to Defend Against SSRF Attacks</a></li><li><a href=\"#wrapping-up\">Wrapping Up</a></li></ul><h2 id=\"prerequisites\">Prerequisites</h2><ol><li><strong>Node and Express:</strong> We'll create a JavaScript sample application using the Express framework. A basic understanding of the framework would be helpful. You will need the <a href=\"https://nodejs.org/en/download/\">Node Runtime Environment</a> to execute the scripts.</li><li><strong>Postman Client: </strong>To make an API request and to exploit the vulnerability, you will need a tool to make HTTP Requests. You may use your web browser's \"Edit and Send\" feature under the Networks tab, but since not all browsers allow this, it's best to use a tool like <a href=\"https://www.postman.com/downloads/\">Postman</a> which provides a better UI to observe responses.</li></ol><h2 id=\"what-is-server-side-request-forgery\">What is Server-Side Request Forgery?</h2><p>Server-Side Request Forgery, or SSRF, is a security vulnerability that allows malicious actors to manipulate the server into making unintended requests on behalf of the server itself. </p><p>SSRF provides a window for such malicious actors to make requests \"from\" the server when they should be making requests \"to\" the server. </p><p>To appreciate what this means, let's look at a normal request execution using the sequence diagrams below:</p><figure class=\"kg-card kg-image-card kg-width-wide kg-card-hascaption\"><img src=\"https://www.freecodecamp.org/news/content/images/2023/12/image-104.png\" class=\"kg-image\" alt=\"image-104\" srcset=\"https://www.freecodecamp.org/news/content/images/size/w600/2023/12/image-104.png 600w, https://www.freecodecamp.org/news/content/images/2023/12/image-104.png 809w\" width=\"809\" height=\"397\" loading=\"lazy\"><figcaption>UML Sequence Diagram for normal request execution</figcaption></figure><p>In a typical scenario, a server processes incoming requests from clients. Users or external systems initiate these requests, and the server responds accordingly. This is a standard client-server interaction where the server acts upon the requests it receives.</p><p>Now let's look at what SSRF looks like:</p><figure class=\"kg-card kg-image-card kg-width-wide kg-card-hascaption\"><img src=\"https://www.freecodecamp.org/news/content/images/2024/01/image-7.png\" class=\"kg-image\" alt=\"image-7\" srcset=\"https://www.freecodecamp.org/news/content/images/size/w600/2024/01/image-7.png 600w, https://www.freecodecamp.org/news/content/images/size/w1000/2024/01/image-7.png 1000w, https://www.freecodecamp.org/news/content/images/2024/01/image-7.png 1332w\" sizes=\"(min-width: 1200px) 1200px\" width=\"1332\" height=\"816\" loading=\"lazy\"><figcaption>UML Sequence Diagram for SSRF attacks</figcaption></figure><p>In applications vulnerable to SSRF, attackers exploit the server's ability to make HTTP requests to resources that should not be directly accessible from the public internet. These resources may include internal protected resources, APIs, websites, or databases that can only be accessed from the server. </p><p>Attackers achieve this by tricking the server into making unintended requests to various destinations, including internal APIs, internal HTML pages, and internal databases.</p><h2 id=\"how-does-ssrf-differ-from-csrf\">How Does SSRF Differ from CSRF?</h2><p>SSRF is an attack where an attacker can make the server perform requests on their behalf. This involves manipulating the server to make requests to internal resources, which can result in unauthorized actions or information disclosure.</p><p>On the other hand, in CSRF, or Client-Side Request Forgery, the attacker tricks a user's browser into making unintended requests to a specific web application for which the user is already authenticated. This means that actions are performed on behalf of the user without their consent.</p><p>Backend Developers must be aware of SSRF to make secure applications. In contrast, front-end developers must be mindful of and implement client-side security measures to prevent CSRF attacks.</p><h2 id=\"identifying-code-smells\">Identifying Code Smells</h2><p>SSRF attacks often occur when web applications improperly mishandle user-controlled input, leading to network requests based on inadequately sanitized user input. Processing un-sanitized URLs in API requests is a common entry point for SSRF attacks. </p><p>Another common giveaway to identifying SSRF vulnerabilities in your applications is to check for instances where XML parsing occurs without adequate validation of external entities. Applications that fail to validate and secure their XML parsers properly may inadvertently expose themselves to SSRF risks. </p><p>In this walkthrough, you will make a server that takes a URL and uses it to make network requests without proper validation and sanitization. You will then see ways to mitigate this issue.</p><h2 id=\"understanding-the-pain-points\">Understanding the Pain Points</h2><p>To better understand the issue of SSRF attacks, lets create a sample application using Express and JavaScript. Below is a Mermaid Sequence Diagram where we explain what the code base does:</p><figure class=\"kg-card kg-image-card kg-width-wide kg-card-hascaption\"><img src=\"https://www.freecodecamp.org/news/content/images/2023/12/image-169.png\" class=\"kg-image\" alt=\"image-169\" srcset=\"https://www.freecodecamp.org/news/content/images/size/w600/2023/12/image-169.png 600w, https://www.freecodecamp.org/news/content/images/size/w1000/2023/12/image-169.png 1000w, https://www.freecodecamp.org/news/content/images/2023/12/image-169.png 1231w\" sizes=\"(min-width: 1200px) 1200px\" width=\"1231\" height=\"850\" loading=\"lazy\"><figcaption>UML Sequence Diagram for the sample application</figcaption></figure><p>We will create an Express app with two endpoints — <code>/fetch</code>, a <code>GET</code> request designed to fetch content from a specified URL, and <code>/admin</code>, another <code>GET</code> request, which is an internal API within the organization that accesses an internally protected resource. </p><p>We will discover a security vulnerability associated with Server-Side Request Forgery (SSRF) in implementing the first <code>GET</code> request.</p><p>We will also create another helper function at the <code>/uploads</code> endpoint to allow our clients to fetch and view their recently uploaded content.</p><h2 id=\"project-setup\">Project Setup</h2><p>To get started, let's quickly set up our repository and install all the required packages. In the root of your workspace, install Express and Axios using the following command:</p><pre><code class=\"language-bash\">npm init -y | npm i axios express</code></pre><p>Executing this command will create a <code>package.json</code> file with default settings and install the specified packages.</p><p>To simulate the internal protected resource, let's create a <code>data.json</code> in the root of your workspace:</p><pre><code class=\"language-JSON\">{   \n    \"name\": \"Hamdaan Ali Quatil\",\n    \"password\": \"violinblackeye\"\n}</code></pre><p>Now, create a file called <code>app.js</code> in the root of your repository. Here, we will define all of our endpoints. Import all required packages like this:</p><pre><code class=\"language-javascript\">const express = require('express');\nconst axios = require('axios');\nconst fs = require('fs').promises;</code></pre><p>We use the <code>fs</code> (File System) module to interact with the local file system. Within the Express application, we use <code>fs.promises</code> to read the contents of a file. The <code>fetchPrivateResource</code> function asynchronously reads the contents of the <code>data.json</code> file, which is an internal resource. </p><p>Let's create an instance of the Express app to handle HTTP requests and define the <code>fetchPrivateResource</code> method. In the sample application, only the admin should be able to fetch this internal resource, but you will observe how a malicious actor can access this using an SSRF attack.</p><pre><code class=\"language-js\">const app = express();\nconst port = 3000;\n\n// Function to fetch private resource\nconst fetchPrivateResource = async () =&gt; {\n  try {\n    const content = await fs.readFile('data.json', 'utf-8');\n    return content;\n  } catch (error) {\n    console.error('Error reading private resource:', error.message);\n    throw error;\n  }\n};</code></pre><h3 id=\"the-fetch-endpoint\">The Fetch Endpoint</h3><p>Now, let's define our first endpoint, <code>/fetch</code> which expects a query parameter <code>url</code> containing the target URL. Upon receiving a request, the server uses the Axios library to make a GET request to the specified URL.</p><pre><code class=\"language-js\">app.get(\"/fetch\", async (req, res) =&gt; {\n  const url = req.query.url;\n\n  try {\n    const response = await axios.get(url);\n    const responseData = JSON.stringify(response.data);\n\n    const filename = path.basename(url);\n    const textFilePath = path.join(__dirname, \"uploads\", \"upload-data.txt\");\n\n    await fs.writeFile(textFilePath, responseData, \"utf-8\");\n\n    res.send(\"Upload Successful\");\n  } catch (error) {\n    console.error(\"Error:\", error.message);\n    res.status(500).send(\"Internal Server Error\");\n  }\n});</code></pre><p>The <code>axios.get</code> method is used to perform the HTTP GET request, and the response data is then converted to a JSON string. The resulting string is written to a text file named <code>upload-data.txt</code> in the <code>uploads</code> folder of the server. Finally, a success message or an error message is sent back to the client, depending on the outcome of the operation.</p><h3 id=\"the-uploads-endpoint\">The Uploads Endpoint</h3><p>With that done, let's create an endpoint to allow users to access and verify their uploaded files. The server will check if the requested file exists, and if so, it sends the file to the client. When a file cannot be found, the server returns a 404 error.</p><pre><code class=\"language-js\">app.get(\"/uploads/:filename\", async (req, res) =&gt; {\n  const filename = req.params.filename;\n  const filePath = path.join(__dirname, \"uploads\", filename);\n  console.log(filePath);\n\n  try {\n    // Check if file exists\n    await fs.access(filePath);\n\n    // If file exists, send it to the client\n    res.sendFile(filePath);\n    \n  } catch (error) {\n    res.status(404).send(\"File not found: \" + error);\n  }\n});</code></pre><h3 id=\"the-admin-endpoint\">The Admin Endpoint</h3><p>Now, we need to make an internal API – the <code>/admin</code> route – which is intentionally shielded from public access. The objective is to ensure this API is only accessible from localhost or the local machine (127.0.0.1). </p><p>We can do this by implementing a middleware that acts as a protective barrier, permitting requests to proceed to the <code>/admin</code> route only if they originate from the local host. </p><p>The middleware checks whether the <code>req.hostname</code> property, which represents the hostname specified in the HTTP request, matches <code>localhost</code> or <code>127.0.0.1</code>. If the request is from a different host, the middleware responds with a <code>403</code> Forbidden status, thereby restricting access.</p><pre><code class=\"language-js\">// middleware to protect admin API\napp.use('/admin', async (req, res, next) =&gt; {\n  const isLocalhost = req.hostname === 'localhost' || req.hostname === '127.0.0.1';\n  \n  if (isLocalhost) {\n    next();\n  } else {\n    res.status(403).send('Forbidden');\n  }\n});\n\n// Route to access the admin API\napp.get('/admin', async (req, res) =&gt; {\n  try {\n    const content = await fetchPrivateResource();\n    res.send(content);\n  } catch (error) {\n    res.status(500).send('Internal Server Error');\n  }\n});</code></pre><p>Once all routes are configured, we start the server using the <code>app.listen</code> method, and it begins listening on port 3000 for incoming requests.</p><pre><code class=\"language-js\">app.listen(port, () =&gt; {\n  console.log(`Server is running on http://localhost:${port}`);\n});</code></pre><p>With our <code>app.js</code> now set up to process incoming requests, let's run the sample application using <code>nodemon</code>:</p><pre><code class=\"language-bash\">npm i -D nodemon | nodemon app.js</code></pre><p>The server has started on the port <code>3000</code>. Now, we are ready to test our sample application and look for code smells that may lead to SSRF attacks. You may find the complete code here — <a href=\"https://gist.github.com/HamdaanAliQuatil/c7db6f3dd0666bd9396a7f4e6ebe6665\">GitHub Gist | HamdaanAliQuatil</a>.</p><h2 id=\"how-to-exploit-the-vulnerability\">How to Exploit the Vulnerability</h2><p>Let's try to make a <code>GET</code> request to the fetch API. We are simulating the process of uploading a text file using the URL to the file. In this demonstration, we will fetch the contents of an example file and save it on our servers. Here is the <a href=\"https://example-files.online-convert.com/document/txt/example.txt\">link to the text file</a>.</p><p>Open your Postman Client and execute a <code>GET</code> request with the URL <code>http://localhost:3000/fetch?url=https://example-files.online-convert.com/document/txt/example.txt</code>. We are adding the link to the file as a Query Parameter in the <code>/fetch</code> endpoint. When you hit send, you will see a response <code>\"Upload Successful\"</code>.</p><figure class=\"kg-card kg-image-card kg-width-wide kg-card-hascaption\"><img src=\"https://www.freecodecamp.org/news/content/images/2024/01/image-3.png\" class=\"kg-image\" alt=\"image-3\" srcset=\"https://www.freecodecamp.org/news/content/images/size/w600/2024/01/image-3.png 600w, https://www.freecodecamp.org/news/content/images/size/w1000/2024/01/image-3.png 1000w, https://www.freecodecamp.org/news/content/images/size/w1600/2024/01/image-3.png 1600w, https://www.freecodecamp.org/news/content/images/2024/01/image-3.png 1920w\" sizes=\"(min-width: 1200px) 1200px\" width=\"1920\" height=\"1009\" loading=\"lazy\"><figcaption>Postman Client: Fetch Endpoint</figcaption></figure><p>You'll see that your repository now has a newly created file in the <code>uploads</code> directory. Clients can now access their uploaded information using the <code>/uploads</code> API endpoint to view their files.</p><figure class=\"kg-card kg-image-card kg-width-wide kg-card-hascaption\"><img src=\"https://www.freecodecamp.org/news/content/images/2024/01/image-4.png\" class=\"kg-image\" alt=\"image-4\" srcset=\"https://www.freecodecamp.org/news/content/images/size/w600/2024/01/image-4.png 600w, https://www.freecodecamp.org/news/content/images/size/w1000/2024/01/image-4.png 1000w, https://www.freecodecamp.org/news/content/images/size/w1600/2024/01/image-4.png 1600w, https://www.freecodecamp.org/news/content/images/2024/01/image-4.png 1920w\" sizes=\"(min-width: 1200px) 1200px\" width=\"1920\" height=\"1007\" loading=\"lazy\"><figcaption>Postman Client: Uploads Endpoint</figcaption></figure><p>Now, let's send a malicious request by changing our Query param to <code>http://120.0.07/admin</code> in the same request to the <code>/fetch</code> endpoint. The updated URL will now look like this: <code>http://localhost:3000/fetch?url=http://127.0.0.1:3000/admin</code>.</p><p>In the Query parameter, <code>127.0.0.1</code> is a Loopback Address. A loopback address is a reserved IP address used to establish network connections with the same host (the local machine) for testing and communication within the device.</p><p>The malicious actor is attempting is to make a request to the server's <code>/admin</code> route from the server itself using the loopback address. This simulates an internal resource access scenario.</p><figure class=\"kg-card kg-image-card kg-width-wide kg-card-hascaption\"><img src=\"https://www.freecodecamp.org/news/content/images/2024/01/image-5.png\" class=\"kg-image\" alt=\"image-5\" srcset=\"https://www.freecodecamp.org/news/content/images/size/w600/2024/01/image-5.png 600w, https://www.freecodecamp.org/news/content/images/size/w1000/2024/01/image-5.png 1000w, https://www.freecodecamp.org/news/content/images/size/w1600/2024/01/image-5.png 1600w, https://www.freecodecamp.org/news/content/images/2024/01/image-5.png 1920w\" sizes=\"(min-width: 1200px) 1200px\" width=\"1920\" height=\"1009\" loading=\"lazy\"><figcaption>Postman Client: Admin Endpoint</figcaption></figure><p>You'll notice that an <code>\"Upload Successful\"</code> message comes as a response to this request. Now try accessing your uploaded file again using the <code>GET</code> request at the <code>/upload</code> endpoint. </p><figure class=\"kg-card kg-image-card kg-width-wide kg-card-hascaption\"><img src=\"https://www.freecodecamp.org/news/content/images/2024/01/image-6.png\" class=\"kg-image\" alt=\"image-6\" srcset=\"https://www.freecodecamp.org/news/content/images/size/w600/2024/01/image-6.png 600w, https://www.freecodecamp.org/news/content/images/size/w1000/2024/01/image-6.png 1000w, https://www.freecodecamp.org/news/content/images/size/w1600/2024/01/image-6.png 1600w, https://www.freecodecamp.org/news/content/images/2024/01/image-6.png 1920w\" sizes=\"(min-width: 1200px) 1200px\" width=\"1920\" height=\"1001\" loading=\"lazy\"><figcaption>Postman Client: Uploads Endpoint</figcaption></figure><p>You'll see that the contents of the uploaded file have been altered. This alteration highlights a successful SSRF (Server-Side Request Forgery) attack, where a malicious actor took advantage of the server's capability to initiate internal requests. </p><p>The file, which initially contained specific data, has now been tampered with. This showcases the potential for unauthorized access and manipulation of sensitive information through SSRF exploits.</p><h2 id=\"how-to-defend-against-ssrf-attacks\">How to Defend Against SSRF Attacks</h2><p>Now, let’s see the ways in which we can fix our application's vulnerability to SSRF. The most intuitive solution that comes to your mind could be to never allow a client to enter a URL. This is certainly the most powerful defense. The server should create a URL it needs. </p><p>But many times, allowing URLs in your business logic becomes an absolute necessity. In such cases, our goal is to prevent the attack or at least reduce the risk if an attack occurs. </p><p>If you really must allow a URL as it is, here are some precautionary steps you can take:</p><h3 id=\"sanitization-and-validation\">Sanitization and Validation</h3><p>As with most vulnerabilities, a pain-point in SSRF attacks is the use of untrusted data. Always treat any data coming from the client side as untrusted.</p><p>Sanitizing and validating the client-supplied data should go a long way to defend against SSRF attacks. A very intuitive validation is to restrict any URL containing localhost or the loopback address.</p><p>Let's create a helper function <code>isValidUrl</code> and call it in the function for the <code>/fetch</code> endpoint.</p><pre><code class=\"language-js\">function isValidUrl(url) {\n  // Restrict URLs to HTTP only. This blocks FTP and other protocols\n  const validUrlRegex = /^http:\\/\\/\\S+$/;\n\n  if (!validUrlRegex.test(url)) {\n    return false;\n  }\n\n  try {\n    const parsedUrl = new URL(url);\n\n    // Check if the host is localhost or a loopback IP address\n    const isLocalhost = parsedUrl.hostname === 'localhost';\n    const isLocalIP = /^127\\.\\d+\\.\\d+\\.\\d+$/g.test(parsedUrl.hostname);\n\n    return !(isLocalhost || isLocalIP);\n  } catch (error) {\n    return false;\n  }\n}</code></pre><p>Your updated function for <code>/fetch</code> endpoint should look like this:</p><pre><code class=\"language-js\">app.get(\"/fetch\", async (req, res) =&gt; {\n  const url = req.query.url;\n\n  if (!isValidUrl(url)) {\n    res.status(400).send(\"Loopback URLs are not allowed\");\n    return;\n  }\n\n  try {\n    ...\n    res.send(\"Upload Successful\");\n  } catch (error) {\n\t...\n  }\n});</code></pre><p>Now, go back to the Postman Client and resend the malicious request. You will observe that previously uploaded file is not tampered and you receive <code>\"Loopback URLs are not allowed\"</code> in the response.</p><h3 id=\"whitelisting-via-an-allow-list\">Whitelisting via an Allow List</h3><p>You may create a positive allow list to only allow certain trusted IP Addresses, URL Schema, and Port. Let's implement an allow list and improve our <code>isValidUrl</code> function:</p><pre><code class=\"language-js\">const whitelist = [\"boost.com\", \"boost.in\", \"trustedDomain3.com\"];\nconst allowedPorts = ['80', '443'];</code></pre><p>Now use your declared <code>whitelist</code> in the <code>isValidUrl</code> function:</p><pre><code class=\"language-js\">function isValidUrl(url) {\n  try {\n    const parsedUrl = new URL(url);\n\n    if (!whitelist.includes(parsedUrl.hostname)) {\n      return false;\n    }\n\n    if (!allowedPorts.includes(parsedUrl.port)) {\n      return false;\n    }\n\n    return true;\n  } catch (error) {\n    return false;\n  }\n}</code></pre><p>Notice how we've removed the need for regex. This brings us to another mitigation technique that you must avoid:</p><h3 id=\"don-t-use-a-deny-list\">Don't Use a Deny List</h3><p>You must never mitigate SSRF vulnerabilities using a deny list or regex. Restricting the use of IP Addresses is not straightforward. To understand why we must avoid a deny list, look at the following example.</p><p>A Loopback Address is typically represented using <code>127.0.0.1</code> . Its quite easy to spot this address and reject it. But a problem arises when a malicious request is sent using any other forms of this Loopback address that also points to the local machine. For example, <code>127.1</code>, <code>::1</code>, <code>localhost</code> ,<code>::ffff:7f00:1</code> all point to the local machine. </p><p>A regular expression to spot all such variations is much more complex. Malicious actors can easily bypass a deny list by passing an octal representation of decimal encoding of the IP address.</p><h3 id=\"enforce-a-url-scheme\">Enforce a URL Scheme</h3><p>In absence of this measure, a client might send requests that use any protocols other than the intended ones. To replace our <code>validUrlRegex</code>, we will use a <code>allowedSchemes</code> list. We will restrict our application to only process requests when the protocols are either <code>https:</code> or <code>http</code>. Not allowing any requests with protocols <code>file:</code> and <code>ftp:</code> will safe-guard our sample application.</p><pre><code class=\"language-js\">const allowedSchemes = ['http:', 'https:'];</code></pre><p>The updated <code>isValidUrl</code> function will look like this:</p><pre><code class=\"language-js\">function isValidUrl(url) {\n  try {\n    const parsedUrl = new URL(url);\n\n    if (!whitelist.includes(parsedUrl.hostname)) {\n      return false;\n    }\n\n    if (!allowedPorts.includes(parsedUrl.port)) {\n      return false;\n    }\n\n    if (!allowedSchemes.includes(parsedUrl.protocol)) {\n      return false;\n    }\n\n    return true;\n  } catch (error) {\n    return false;\n  }\n}</code></pre><h3 id=\"disable-redirects\">Disable Redirects</h3><p>Redirects are a mechanism used by web applications to forward a user's browser from one URL to another. If a server follows redirects automatically, an attacker could exploit this behavior to make the server inadvertently access internal resources, leading to data exposure or unauthorized actions.</p><p>To restrict redirects in Axios, pass in an Axios Configuration object in the second parameter:</p><pre><code class=\"language-js\">const response = await axios.get(url, { maxRedirects: 0 });</code></pre><p>To learn more about Axios Config, check this guide: <a href=\"https://axios-http.com/docs/req_config\">Axios | Request Config</a>.</p><h3 id=\"send-filtered-data-to-the-client\">Send Filtered Data to the Client</h3><p>Avoid sending raw response bodies directly from your server to the client. Ensure that the responses reaching the client are carefully curated and conform to expected formats. </p><p>By implementing this practice, you shield your application from potential security vulnerabilities associated with exposing unfiltered or sensitive information. Always validate, filter, and format responses to align with your application's anticipated data structures.</p><h2 id=\"wrapping-up\">Wrapping Up</h2><p>And there you have it: by implementing a few well-established methodologies and best practices, you can effectively detect and mitigate SSRF attacks in your applications and create secure APIs as developers.</p><p>Find the complete code snippets here — <a href=\"https://gist.github.com/HamdaanAliQuatil/c7db6f3dd0666bd9396a7f4e6ebe6665\">GitHub Gist | HamdaanAliQuatil</a>.<br>You may find me on X (formerly Twitter) - <a href=\"https://twitter.com/violinblackeye\">Hamdaan Ali Quatil</a>.</p>\n\n                        </section>\n                        \n                            <div class=\"sidebar\">\n                                \n                                    \n                                        <div class=\"ad-wrapper\" data-test-label=\"ad-wrapper\">\n    \n    <div class=\"ad-text\" data-test-label=\"ad-text\">ADVERTISEMENT</div>\n    <ins class=\"adsbygoogle\" style=\"display: block; height: 280px;\" data-ad-client=\"ca-pub-9482786369113753\" data-ad-slot=\"5720086888\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins>\n    <script>\n        (adsbygoogle = window.adsbygoogle || []).push({});\n    </script>\n</div>\n\n                                    \n                                        <div class=\"ad-wrapper\" data-test-label=\"ad-wrapper\">\n    \n    <div class=\"ad-text\" data-test-label=\"ad-text\">ADVERTISEMENT</div>\n    <ins class=\"adsbygoogle\" style=\"display: block; height: 280px;\" data-ad-client=\"ca-pub-9482786369113753\" data-ad-slot=\"5720086888\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins>\n    <script>\n        (adsbygoogle = window.adsbygoogle || []).push({});\n    </script>\n</div>\n\n                                    \n                                        <div class=\"ad-wrapper\" data-test-label=\"ad-wrapper\">\n    \n    <div class=\"ad-text\" data-test-label=\"ad-text\">ADVERTISEMENT</div>\n    <ins class=\"adsbygoogle\" style=\"display: block; height: 280px;\" data-ad-client=\"ca-pub-9482786369113753\" data-ad-slot=\"5720086888\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins>\n    <script>\n        (adsbygoogle = window.adsbygoogle || []).push({});\n    </script>\n</div>\n\n                                    \n                                        <div class=\"ad-wrapper\" data-test-label=\"ad-wrapper\">\n    \n    <div class=\"ad-text\" data-test-label=\"ad-text\">ADVERTISEMENT</div>\n    <ins class=\"adsbygoogle\" style=\"display: block; height: 280px;\" data-ad-client=\"ca-pub-9482786369113753\" data-ad-slot=\"5720086888\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins>\n    <script>\n        (adsbygoogle = window.adsbygoogle || []).push({});\n    </script>\n</div>\n\n                                    \n                                        <div class=\"ad-wrapper\" data-test-label=\"ad-wrapper\">\n    \n    <div class=\"ad-text\" data-test-label=\"ad-text\">ADVERTISEMENT</div>\n    <ins class=\"adsbygoogle\" style=\"display: block; height: 280px;\" data-ad-client=\"ca-pub-9482786369113753\" data-ad-slot=\"5720086888\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins>\n    <script>\n        (adsbygoogle = window.adsbygoogle || []).push({});\n    </script>\n</div>\n\n                                    \n                                        <div class=\"ad-wrapper\" data-test-label=\"ad-wrapper\">\n    \n    <div class=\"ad-text\" data-test-label=\"ad-text\">ADVERTISEMENT</div>\n    <ins class=\"adsbygoogle\" style=\"display: block; height: 280px;\" data-ad-client=\"ca-pub-9482786369113753\" data-ad-slot=\"5720086888\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins>\n    <script>\n        (adsbygoogle = window.adsbygoogle || []).push({});\n    </script>\n</div>\n\n                                    \n                                        <div class=\"ad-wrapper\" data-test-label=\"ad-wrapper\">\n    \n    <div class=\"ad-text\" data-test-label=\"ad-text\">ADVERTISEMENT</div>\n    <ins class=\"adsbygoogle\" style=\"display: block; height: 280px;\" data-ad-client=\"ca-pub-9482786369113753\" data-ad-slot=\"5720086888\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins>\n    <script>\n        (adsbygoogle = window.adsbygoogle || []).push({});\n    </script>\n</div>\n\n                                    \n                                        <div class=\"ad-wrapper\" data-test-label=\"ad-wrapper\">\n    \n    <div class=\"ad-text\" data-test-label=\"ad-text\">ADVERTISEMENT</div>\n    <ins class=\"adsbygoogle\" style=\"display: block; height: 280px;\" data-ad-client=\"ca-pub-9482786369113753\" data-ad-slot=\"5720086888\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins>\n    <script>\n        (adsbygoogle = window.adsbygoogle || []).push({});\n    </script>\n</div>\n\n                                    \n                                        <div class=\"ad-wrapper\" data-test-label=\"ad-wrapper\">\n    \n    <div class=\"ad-text\" data-test-label=\"ad-text\">ADVERTISEMENT</div>\n    <ins class=\"adsbygoogle\" style=\"display: block; height: 280px;\" data-ad-client=\"ca-pub-9482786369113753\" data-ad-slot=\"5720086888\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins>\n    <script>\n        (adsbygoogle = window.adsbygoogle || []).push({});\n    </script>\n</div>\n\n                                    \n                                        <div class=\"ad-wrapper\" data-test-label=\"ad-wrapper\">\n    \n    <div class=\"ad-text\" data-test-label=\"ad-text\">ADVERTISEMENT</div>\n    <ins class=\"adsbygoogle\" style=\"display: block; height: 280px;\" data-ad-client=\"ca-pub-9482786369113753\" data-ad-slot=\"5720086888\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins>\n    <script>\n        (adsbygoogle = window.adsbygoogle || []).push({});\n    </script>\n</div>\n\n                                    \n                                        <div class=\"ad-wrapper\" data-test-label=\"ad-wrapper\">\n    \n    <div class=\"ad-text\" data-test-label=\"ad-text\">ADVERTISEMENT</div>\n    <ins class=\"adsbygoogle\" style=\"display: block; height: 280px;\" data-ad-client=\"ca-pub-9482786369113753\" data-ad-slot=\"5720086888\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins>\n    <script>\n        (adsbygoogle = window.adsbygoogle || []).push({});\n    </script>\n</div>\n\n                                    \n                                        <div class=\"ad-wrapper\" data-test-label=\"ad-wrapper\">\n    \n    <div class=\"ad-text\" data-test-label=\"ad-text\">ADVERTISEMENT</div>\n    <ins class=\"adsbygoogle\" style=\"display: block; height: 280px;\" data-ad-client=\"ca-pub-9482786369113753\" data-ad-slot=\"5720086888\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins>\n    <script>\n        (adsbygoogle = window.adsbygoogle || []).push({});\n    </script>\n</div>\n\n                                    \n                                        <div class=\"ad-wrapper\" data-test-label=\"ad-wrapper\">\n    \n    <div class=\"ad-text\" data-test-label=\"ad-text\">ADVERTISEMENT</div>\n    <ins class=\"adsbygoogle\" style=\"display: block; height: 280px;\" data-ad-client=\"ca-pub-9482786369113753\" data-ad-slot=\"5720086888\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins>\n    <script>\n        (adsbygoogle = window.adsbygoogle || []).push({});\n    </script>\n</div>\n\n                                    \n                                \n                            </div>\n                        \n                    </div>\n                    <hr>\n                    \n                        <div class=\"post-full-author-header\" data-test-label=\"author-header-with-bio\">\n                            \n                                \n    \n    \n    \n\n    <section class=\"author-card\" data-test-label=\"author-card\">\n        \n            \n    <img srcset=\"https://www.freecodecamp.org/news/content/images/size/w60/2023/11/698-crop.jpg 60w\" sizes=\"60px\" src=\"https://www.freecodecamp.org/news/content/images/size/w60/2023/11/698-crop.jpg\" class=\"author-profile-image\" alt=\"Hamdaan Ali\" width=\"1050\" height=\"1103\" onerror=\"this.style.display='none'\" loading=\"lazy\" data-test-label=\"profile-image\">\n  \n        \n\n        <section class=\"author-card-content \">\n            <span class=\"author-card-name\">\n                <a href=\"/news/author/hamdaan/\" data-test-label=\"profile-link\">\n                    \n                        Hamdaan Ali\n                    \n                </a>\n            </span>\n            \n                \n                    <p data-test-label=\"default-bio\">\n                        Read <a href=\"/news/author/hamdaan/\">more posts</a>.\n                    </p>\n                \n            \n        </section>\n    </section>\n\n                            \n                        </div>\n                        <hr>\n                    \n\n                    \n                    \n                        \n    \n\n\n<p data-test-label=\"social-row-cta\" class=\"social-row\">\n    If you read this far, thank the author to show them you care. <button id=\"tweet-btn\" class=\"cta-button\" data-test-label=\"tweet-button\">Say Thanks</button>\n</p>\n\n\n    \n    <script>document.addEventListener(\"DOMContentLoaded\",(()=>{const t=document.getElementById(\"tweet-btn\"),e=window.location,n=\"How%20to%20Defend%20Against%20Server-Side%20Request%20Forgery\".replace(/&#39;/g,\"%27\"),o=\"\",i=\"@violinblackeye\",r=Boolean(\"\");let a;if(r&&(o||i)){const t={originalPostAuthor:\"\",currentPostAuthor:\"Hamdaan Ali\"};a=encodeURIComponent(`Thank you ${o||t.originalPostAuthor} for writing this helpful article, and ${i||t.currentPostAuthor} for translating it.`)}else!r&&i&&(a=encodeURIComponent(`Thank you ${i} for writing this helpful article.`));const l=`window.open(\\n    '${a?`https://twitter.com/intent/tweet?text=${a}%0A%0A${n}%0A%0A${e}`:`https://twitter.com/intent/tweet?text=${n}%0A%0A${e}`}',\\n    'share-twitter',\\n    'width=550, height=235'\\n  ); return false;`;t.setAttribute(\"onclick\",l)}));</script>\n\n\n                        \n\n<div class=\"learn-cta-row\" data-test-label=\"learn-cta-row\">\n    <p>\n        Learn to code for free. freeCodeCamp's open source curriculum has helped more than 40,000 people get jobs as developers. <a href=\"https://www.freecodecamp.org/learn/\" class=\"cta-button\" id=\"learn-to-code-cta\" rel=\"noopener noreferrer\" target=\"_blank\">Get started</a>\n    </p>\n</div>\n\n                    \n                </section>\n                \n                    <div class=\"banner-ad bottom\">\n                        \n                            <div class=\"ad-wrapper\" data-test-label=\"ad-wrapper\">\n    \n    <div class=\"ad-text\" data-test-label=\"ad-text\">ADVERTISEMENT</div>\n    <ins class=\"adsbygoogle\" style=\"display: block; height: 280px;\" data-ad-client=\"ca-pub-9482786369113753\" data-ad-slot=\"5720086888\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins>\n    <script>\n        (adsbygoogle = window.adsbygoogle || []).push({});\n    </script>\n</div>\n\n                        \n                    </div>\n                \n            </article>\n        </div>\n    </main>\n\n\n            \n\n\n<footer class=\"site-footer\">\n    <div class=\"footer-top\">\n        <div class=\"footer-desc-col\">\n            <p data-test-label=\"tax-exempt-status\">freeCodeCamp is a donor-supported tax-exempt 501(c)(3) charity organization (United States Federal Tax Identification Number: 82-0779546)</p>\n            <p data-test-label=\"mission-statement\">Our mission: to help people learn to code for free. We accomplish this by creating thousands of videos, articles, and interactive coding lessons - all freely available to the public.</p>\n            <p data-test-label=\"donation-initiatives\">Donations to freeCodeCamp go toward our education initiatives, and help pay for servers, services, and staff.</p>\n            <p class=\"footer-donation\" data-test-label=\"donate-text\">\n                You can <a href=\"https://www.freecodecamp.org/donate/\" class=\"inline\" rel=\"noopener noreferrer\" target=\"_blank\">make a tax-deductible donation here</a>.\n            </p>\n        </div>\n        <div class=\"trending-guides\" data-test-label=\"trending-guides\">\n            <h2 id=\"trending-guides\" class=\"col-header\">Trending Guides</h2>\n            <ul class=\"trending-guides-articles\" aria-labelledby=\"trending-guides\">\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/complete-guide-to-css-transform-functions-and-properties/\" rel=\"noopener noreferrer\" target=\"_blank\">Learn CSS Transform\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/how-to-create-a-static-blog-with-lume/\" rel=\"noopener noreferrer\" target=\"_blank\">Build a Static Blog\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/how-to-build-an-ai-chatbot-with-redis-python-and-gpt/\" rel=\"noopener noreferrer\" target=\"_blank\">Build an AI Chatbot\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/what-is-programming-tutorial-for-beginners/\" rel=\"noopener noreferrer\" target=\"_blank\">What is Programming?\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/python-code-examples-sample-script-coding-tutorial-for-beginners/\" rel=\"noopener noreferrer\" target=\"_blank\">Python Code Examples\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/a-practical-guide-to-start-opensource-contributions/\" rel=\"noopener noreferrer\" target=\"_blank\">Open Source for Devs\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/http-full-course/\" rel=\"noopener noreferrer\" target=\"_blank\">HTTP Networking in JS\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/how-to-write-unit-tests-in-react-redux/\" rel=\"noopener noreferrer\" target=\"_blank\">Write React Unit Tests\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/introduction-to-algorithms-with-javascript-examples/\" rel=\"noopener noreferrer\" target=\"_blank\">Learn Algorithms in JS\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/how-to-write-clean-code/\" rel=\"noopener noreferrer\" target=\"_blank\">How to Write Clean Code\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/the-php-handbook/\" rel=\"noopener noreferrer\" target=\"_blank\">Learn PHP\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/the-java-handbook/\" rel=\"noopener noreferrer\" target=\"_blank\">Learn Java\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/the-swift-handbook/\" rel=\"noopener noreferrer\" target=\"_blank\">Learn Swift\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/learn-golang-handbook/\" rel=\"noopener noreferrer\" target=\"_blank\">Learn Golang\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/get-started-with-nodejs/\" rel=\"noopener noreferrer\" target=\"_blank\">Learn Node.js\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/complete-guide-to-css-grid/\" rel=\"noopener noreferrer\" target=\"_blank\">Learn CSS Grid\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/learn-solidity-handbook/\" rel=\"noopener noreferrer\" target=\"_blank\">Learn Solidity\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/the-express-handbook/\" rel=\"noopener noreferrer\" target=\"_blank\">Learn Express.js\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/javascript-es-modules-and-module-bundlers/\" rel=\"noopener noreferrer\" target=\"_blank\">Learn JS Modules\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/apache-kafka-handbook/\" rel=\"noopener noreferrer\" target=\"_blank\">Learn Apache Kafka\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/rest-api-design-best-practices-build-a-rest-api/\" rel=\"noopener noreferrer\" target=\"_blank\">REST API Best Practices\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/front-end-javascript-development-react-angular-vue-compared/\" rel=\"noopener noreferrer\" target=\"_blank\">Front-End JS Development\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/build-consume-and-document-a-rest-api/\" rel=\"noopener noreferrer\" target=\"_blank\">Learn to Build REST APIs\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/build-strongly-typed-polymorphic-components-with-react-and-typescript/\" rel=\"noopener noreferrer\" target=\"_blank\">Intermediate TS and React\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/command-line-for-beginners/\" rel=\"noopener noreferrer\" target=\"_blank\">Command Line for Beginners\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/an-introduction-to-operating-systems/\" rel=\"noopener noreferrer\" target=\"_blank\">Intro to Operating Systems\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/building-consuming-and-documenting-a-graphql-api/\" rel=\"noopener noreferrer\" target=\"_blank\">Learn to Build GraphQL APIs\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/oss-security-best-practices/\" rel=\"noopener noreferrer\" target=\"_blank\">OSS Security Best Practices\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/design-patterns-for-distributed-systems/\" rel=\"noopener noreferrer\" target=\"_blank\">Distributed Systems Patterns\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/an-introduction-to-software-architecture-patterns/\" rel=\"noopener noreferrer\" target=\"_blank\">Software Architecture Patterns\n                    </a>\n                </li>\n            </ul>\n            <div class=\"spacer\" style=\"padding: 15px 0;\"></div>\n            <div>\n                <h2 id=\"mobile-app\" class=\"col-header\">\n                    Mobile App\n                </h2>\n                <div class=\"min-h-[1px] px-[15px] md:w-2/3 md:ml-[16.6%]\">\n                    <ul aria-labelledby=\"mobile-app\" class=\"mobile-app-container\">\n                        <li>\n                            <a href=\"https://apps.apple.com/us/app/freecodecamp/id6446908151?itsct=apps_box_link&itscg=30200\" rel=\"noopener noreferrer\" target=\"_blank\">\n                                <img src=\"https://cdn.freecodecamp.org/platform/universal/apple-store-badge.svg\" lang=\"en\" alt=\"Download on the App Store\">\n                            </a>\n                        </li>\n                        <li>\n                            <a href=\"https://play.google.com/store/apps/details?id=org.freecodecamp\" rel=\"noopener noreferrer\" target=\"_blank\">\n                                <img src=\"https://cdn.freecodecamp.org/platform/universal/google-play-badge.svg\" lang=\"en\" alt=\"Get it on Google Play\">\n                            </a>\n                        </li>\n                    </ul>\n                </div>\n            </div>\n        </div>\n    </div>\n    <div class=\"footer-bottom\">\n        <h2 class=\"col-header\" data-test-label=\"our-nonprofit\">Our Charity</h2>\n        <div class=\"our-nonprofit\">\n            <a href=\"https://www.freecodecamp.org/news/about/\" rel=\"noopener noreferrer\" target=\"_blank\" data-test-label=\"about\">\n                About\n            </a>\n            <a href=\"https://www.linkedin.com/school/free-code-camp/people/\" rel=\"noopener noreferrer\" target=\"_blank\" data-test-label=\"alumni\">\n                Alumni Network\n            </a>\n            <a href=\"https://github.com/freeCodeCamp/\" rel=\"noopener noreferrer\" target=\"_blank\" data-test-label=\"open-source\">\n                Open Source\n            </a>\n            <a href=\"https://www.freecodecamp.org/news/shop/\" rel=\"noopener noreferrer\" target=\"_blank\" data-test-label=\"shop\">\n                Shop\n            </a>\n            <a href=\"https://www.freecodecamp.org/news/support/\" rel=\"noopener noreferrer\" target=\"_blank\" data-test-label=\"support\">\n                Support\n            </a>\n            <a href=\"https://www.freecodecamp.org/news/sponsors/\" rel=\"noopener noreferrer\" target=\"_blank\" data-test-label=\"sponsors\">\n                Sponsors\n            </a>\n            <a href=\"https://www.freecodecamp.org/news/academic-honesty-policy/\" rel=\"noopener noreferrer\" target=\"_blank\" data-test-label=\"honesty\">\n                Academic Honesty\n            </a>\n            <a href=\"https://www.freecodecamp.org/news/code-of-conduct/\" rel=\"noopener noreferrer\" target=\"_blank\" data-test-label=\"coc\">\n                Code of Conduct\n            </a>\n            <a href=\"https://www.freecodecamp.org/news/privacy-policy/\" rel=\"noopener noreferrer\" target=\"_blank\" data-test-label=\"privacy\">\n                Privacy Policy\n            </a>\n            <a href=\"https://www.freecodecamp.org/news/terms-of-service/\" rel=\"noopener noreferrer\" target=\"_blank\" data-test-label=\"tos\">\n                Terms of Service\n            </a>\n            <a href=\"https://www.freecodecamp.org/news/copyright-policy/\" rel=\"noopener noreferrer\" target=\"_blank\" data-test-label=\"copyright\">\n                Copyright Policy\n            </a>\n        </div>\n    </div>\n</footer>\n\n        </div>\n\n        \n        \n        \n\n        <!-- Google Tag Manager (noscript) -->\n<noscript><iframe src=\"https://www.googletagmanager.com/ns.html?id=GTM-5D6RKKP\" height=\"0\" width=\"0\" style=\"display:none;visibility:hidden\"></iframe></noscript>\n<!-- End Google Tag Manager (noscript) -->\n\n        \n    <script defer src=\"https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015\" integrity=\"sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==\" data-cf-beacon='{\"rayId\":\"8ac2200e9c1c40eb\",\"serverTiming\":{\"name\":{\"cfL4\":true}},\"version\":\"2024.7.0\",\"token\":\"bdb993c6dde44e178aabd9555e75e4f4\"}' crossorigin=\"anonymous\"></script>\n</body>\n</html>\n"}}}