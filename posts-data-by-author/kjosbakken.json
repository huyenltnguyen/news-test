{"https://www.freecodecamp.org/news/author/kjosbakken/":{"https://www.freecodecamp.org//news/how-to-fine-tune-easyocr-with-a-synthetic-dataset/":{"html":"<!DOCTYPE html>\n<html lang=\"en\">\n    <head>\n        <meta charset=\"utf-8\">\n        <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\n        \n        \n            <title>How to Fine-Tune EasyOCR with a Synthetic Dataset</title>\n        \n        <meta name=\"HandheldFriendly\" content=\"True\">\n        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n\n        <link rel=\"preconnect\" href=\"https://fonts.googleapis.com\">\n        <link rel=\"preconnect\" href=\"https://fonts.gstatic.com\" crossorigin=\"\">\n        \n            <link rel=\"preload\" as=\"style\" onload=\"this.onload=null;this.rel='stylesheet'\" href=\"https://fonts.googleapis.com/css2?family=Lato:ital,wght@0,300;0,400;0,700;1,400&family=Roboto+Mono:wght@400;700&display=swap\">\n        \n\n        \n        \n    <link rel=\"preload\" as=\"style\" onload=\"this.onload=null;this.rel='stylesheet'\" href=\"https://cdn.freecodecamp.org/news-assets/prism/1.29.0/themes/prism.min.css\">\n<noscript>\n  <link rel=\"stylesheet\" href=\"https://cdn.freecodecamp.org/news-assets/prism/1.29.0/themes/prism.min.css\">\n</noscript>\n<link rel=\"preload\" as=\"style\" onload=\"this.onload=null;this.rel='stylesheet'\" href=\"https://cdn.freecodecamp.org/news-assets/prism/1.29.0/plugins/unescaped-markup/prism-unescaped-markup.min.css\">\n<noscript>\n  <link rel=\"stylesheet\" href=\"https://cdn.freecodecamp.org/news-assets/prism/1.29.0/plugins/unescaped-markup/prism-unescaped-markup.min.css\">\n</noscript>\n\n<script defer=\"\" src=\"https://cdn.freecodecamp.org/news-assets/prism/1.29.0/components/prism-core.min.js\"></script>\n<script defer=\"\" src=\"https://cdn.freecodecamp.org/news-assets/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js\"></script>\n\n\n\n        \n        <link rel=\"preload\" as=\"style\" onload=\"this.onload=null;this.rel='stylesheet'\" href=\"/news/assets/css/global-26e2f3cde9.css\">\n        <link rel=\"stylesheet\" type=\"text/css\" href=\"/news/assets/css/screen-926fddfac2.css\">\n        <link rel=\"stylesheet\" type=\"text/css\" href=\"/news/assets/css/search-bar-124f5f949c.css\">\n\n        \n        <script defer=\"\" src=\"https://cdn.freecodecamp.org/news-assets/algolia/algoliasearch-3-33-0/algoliasearch.min.js\"></script>\n        <script defer=\"\" src=\"https://cdn.freecodecamp.org/news-assets/algolia/autocomplete-0-36-0/autocomplete.min.js\"></script>\n\n        \n        <script defer=\"\" src=\"https://cdn.freecodecamp.org/news-assets/dayjs/1.10.4/dayjs.min.js\"></script>\n        <script defer=\"\" src=\"https://cdn.freecodecamp.org/news-assets/dayjs/1.10.4/localizedFormat.min.js\"></script>\n        <script defer=\"\" src=\"https://cdn.freecodecamp.org/news-assets/dayjs/1.10.4/relativeTime.min.js\"></script>\n\n        \n        \n            <script defer=\"\" src=\"https://cdn.freecodecamp.org/news-assets/dayjs/1.10.4/locale/en.min.js\"></script>\n        \n\n        \n        <script>let client,index;document.addEventListener(\"DOMContentLoaded\",(()=>{client=algoliasearch(\"QMJYL5WYTI\",\"89770b24481654192d7a5c402c6ad9a0\"),index=client.initIndex(\"news\")})),document.addEventListener(\"DOMContentLoaded\",(()=>{const e=window.screen.width,t=window.screen.height,n=e>=767&&t>=768?8:5,o=document.getElementById(\"search-form\"),s=document.getElementById(\"search-input\"),a=document.getElementById(\"dropdown-container\");let i,d,c;s.addEventListener(\"input\",(e=>{i=e.target.value})),o.addEventListener(\"submit\",(e=>{e.preventDefault(),function(){if(d=document.getElementsByClassName(\"aa-cursor\")[0],d&&i){const e=d.querySelector(\"a\").href;window.location.assign(e)}else!d&&i&&c&&window.location.assign(`https://www.freecodecamp.org/news/search?query=${i}`)}()}));const l=autocomplete(\"#search-input\",{hint:!1,keyboardShortcuts:[\"s\",191],openOnFocus:!0,appendTo:a,debug:!0},[{source:autocomplete.sources.hits(index,{hitsPerPage:n}),debounce:250,templates:{suggestion:e=>(c=!0,`\\n            <a href=\"${e.url}\">\\n              <div class=\"algolia-result\">\\n                <span>${e._highlightResult.title.value}</span>\\n              </div>\\n            </a>\\n          `),empty:()=>(c=!1,'\\n            <div class=\"aa-suggestion footer-suggestion no-hits-footer\">\\n              <div class=\"algolia-result\">\\n                <span>\\n                  No tutorials found\\n                </span>\\n              </div>\\n            </div>\\n          '),footer:e=>{if(!e.isEmpty)return`\\n              <div class=\"aa-suggestion footer-suggestion\">\\n                <a id=\"algolia-footer-selector\" href=\"https://www.freecodecamp.org/news/search?query=${i}\">\\n                  <div class=\"algolia-result algolia-footer\">\\n                    See all results for ${i}\\n                  </div>\\n                </a>\\n              </div>\\n            `}}}]).on(\"autocomplete:selected\",((e,t,n,o)=>{d=t?t.url:`https://www.freecodecamp.org/news/search?query=${i}`,\"click\"!==o.selectionMethod&&\"tabKey\"!==o.selectionMethod&&c&&window.location.assign(d)}));document.addEventListener(\"click\",(e=>{e.target!==s&&l.autocomplete.close()}))})),document.addEventListener(\"DOMContentLoaded\",(()=>{dayjs.extend(dayjs_plugin_localizedFormat),dayjs.extend(dayjs_plugin_relativeTime),dayjs.locale(\"en\")}));const isAuthenticated=document.cookie.split(\";\").some((e=>e.trim().startsWith(\"jwt_access_token=\"))),isDonor=document.cookie.split(\";\").some((e=>e.trim().startsWith(\"isDonor=true\")));</script>\n\n        \n        \n    \n        \n            <script data-ad-client=\"ca-pub-9482786369113753\" src=\"https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js\" crossorigin=\"anonymous\" async=\"\"></script>\n        \n    \n\n\n        \n        \n    \n        \n    \n        \n    \n\n\n        \n        \n        \n\n        \n        \n\n        <link rel=\"icon\" href=\"https://cdn.freecodecamp.org/universal/favicons/favicon.ico\" type=\"image/png\">\n        \n        \n            <link rel=\"canonical\" href=\"https://www.freecodecamp.org/news/how-to-fine-tune-easyocr-with-a-synthetic-dataset/\">\n        \n        <meta name=\"referrer\" content=\"no-referrer-when-downgrade\">\n\n        \n\n        \n    <meta name=\"description\" content=\"OCR is a valuable tool that you can use to extract text from images. But the OCR you are using may not work as intended for your specific needs. In such situations, fine-tuning your OCR engine is the way to go.  In this tutorial, I will show you how\">\n\n    \n    <meta property=\"og:site_name\" content=\"freeCodeCamp.org\">\n    <meta property=\"og:type\" content=\"article\">\n    <meta property=\"og:title\" content=\"How to Fine-Tune EasyOCR with a Synthetic Dataset\">\n    \n        <meta property=\"og:description\" content=\"OCR is a valuable tool that you can use to extract text from images. But the OCR you are using may not work as intended for your specific needs. In such situations, fine-tuning your OCR engine is the way to go.  In this tutorial, I will show you how\">\n    \n    <meta property=\"og:url\" content=\"https://www.freecodecamp.org/news/how-to-fine-tune-easyocr-with-a-synthetic-dataset/\">\n    <meta property=\"og:image\" content=\"https://www.freecodecamp.org/news/content/images/2024/01/image-53.png\">\n    <meta property=\"article:published_time\" content=\"2024-01-05T17:48:17.000Z\">\n    <meta property=\"article:modified_time\" content=\"2024-06-25T07:12:01.000Z\">\n    \n        <meta property=\"article:tag\" content=\"Data Science\">\n    \n        <meta property=\"article:tag\" content=\"Artificial Intelligence\">\n    \n    <meta property=\"article:publisher\" content=\"https://www.facebook.com/freecodecamp\">\n    \n\n    \n    <meta name=\"twitter:card\" content=\"summary_large_image\">\n    <meta name=\"twitter:title\" content=\"How to Fine-Tune EasyOCR with a Synthetic Dataset\">\n    \n        <meta name=\"twitter:description\" content=\"OCR is a valuable tool that you can use to extract text from images. But the OCR you are using may not work as intended for your specific needs. In such situations, fine-tuning your OCR engine is the way to go.  In this tutorial, I will show you how\">\n    \n    <meta name=\"twitter:url\" content=\"https://www.freecodecamp.org/news/how-to-fine-tune-easyocr-with-a-synthetic-dataset/\">\n    <meta name=\"twitter:image\" content=\"https://www.freecodecamp.org/news/content/images/2024/01/image-53.png\">\n    <meta name=\"twitter:label1\" content=\"Written by\">\n    <meta name=\"twitter:data1\" content=\"Eivind Kjosbakken\">\n    <meta name=\"twitter:label2\" content=\"Filed under\">\n    <meta name=\"twitter:data2\" content=\"Data Science, Artificial Intelligence\">\n    <meta name=\"twitter:site\" content=\"@freecodecamp\">\n    \n        <meta name=\"twitter:creator\" content=\"@Ravenspike21\">\n    \n\n    <meta property=\"og:image:width\" content=\"720\">\n    <meta property=\"og:image:height\" content=\"720\">\n\n\n        \n    <script type=\"application/ld+json\">{\n\t\"@context\": \"https://schema.org\",\n\t\"@type\": \"Article\",\n\t\"publisher\": {\n\t\t\"@type\": \"Organization\",\n\t\t\"name\": \"freeCodeCamp.org\",\n\t\t\"url\": \"https://www.freecodecamp.org/news/\",\n\t\t\"logo\": {\n\t\t\t\"@type\": \"ImageObject\",\n\t\t\t\"url\": \"https://cdn.freecodecamp.org/platform/universal/fcc_primary.svg\",\n\t\t\t\"width\": 2100,\n\t\t\t\"height\": 240\n\t\t}\n\t},\n\t\"image\": {\n\t\t\"@type\": \"ImageObject\",\n\t\t\"url\": \"https://www.freecodecamp.org/news/content/images/2024/01/image-53.png\",\n\t\t\"width\": 720,\n\t\t\"height\": 720\n\t},\n\t\"url\": \"https://www.freecodecamp.org/news/how-to-fine-tune-easyocr-with-a-synthetic-dataset/\",\n\t\"mainEntityOfPage\": {\n\t\t\"@type\": \"WebPage\",\n\t\t\"@id\": \"https://www.freecodecamp.org/news/\"\n\t},\n\t\"datePublished\": \"2024-01-05T17:48:17.000Z\",\n\t\"dateModified\": \"2024-06-25T07:12:01.000Z\",\n\t\"keywords\": \"Data Science, Artificial Intelligence\",\n\t\"description\": \"OCR is a valuable tool that you can use to extract text from images. But the OCR\\nyou are using may not work as intended for your specific needs. In such\\nsituations, fine-tuning your OCR engine is the way to go. \\n\\nIn this tutorial, I will show you how to fine-tune EasyOCR, a free, open-source\\nOCR engine that you can use with Python.\\n\\nTable of Contents\\n * Prerequisites\\n * How to Install Required Packages\\n * How to Clone the Git repository\\n * How to Get a Dataset\\n * How to Generate your Synthetic D\",\n\t\"headline\": \"How to Fine-Tune EasyOCR with a Synthetic Dataset\",\n\t\"author\": {\n\t\t\"@type\": \"Person\",\n\t\t\"name\": \"Eivind Kjosbakken\",\n\t\t\"url\": \"https://www.freecodecamp.org/news/author/kjosbakken/\",\n\t\t\"sameAs\": [\n\t\t\t\"https://twitter.com/Ravenspike21\"\n\t\t],\n\t\t\"image\": {\n\t\t\t\"@type\": \"ImageObject\",\n\t\t\t\"url\": \"https://www.freecodecamp.org/news/content/images/2023/09/Screenshot_20230816_114245_Gallery--5----Copy.jpg\",\n\t\t\t\"width\": 920,\n\t\t\t\"height\": 1725\n\t\t}\n\t}\n}</script>\n\n\n        <meta name=\"generator\" content=\"Eleventy\">\n        <link rel=\"alternate\" type=\"application/rss+xml\" title=\"freeCodeCamp.org\" href=\"https://www.freecodecamp.org/news/rss/\">\n\n        <link rel=\"preconnect\" href=\"https://fonts.gstatic.com\">\n\n<!-- dataLayer setup -->\n<script>\nwindow.dataLayer = window.dataLayer || [];\n</script>\n<!-- End dataLayer setup -->\n\n<!-- Google Tag Manager -->\n<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':\nnew Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],\nj=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=\n'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);\n})(window,document,'script','dataLayer','GTM-5D6RKKP');</script>\n<!-- End Google Tag Manager -->\n\n\n<meta name=\"google-site-verification\" content=\"b4tITLzEeeZGEpvD4mGNf3khKM4fvqejQaz9SYBQP8E\">\n\n        \n        \n\n        \n  <meta name=\"x-fcc-source\" data-test-label=\"x-fcc-source\" content=\"Ghost\">\n\n    </head>\n\n    \n        <body class=\"home-template\">\n    \n        <div class=\"site-wrapper\">\n            <nav class=\"site-nav nav-padding\">\n    <div class=\"site-nav-left\">\n        \n<form id=\"search-form\" data-test-label=\"search-bar\">\n    <div role=\"search\" class=\"searchbox__wrapper\">\n        <label class=\"fcc_sr_only\" for=\"search-input\">\n            Search\n        </label>\n        <input type=\"search\" placeholder=\"\n    Search 11,200+ tutorials\n\" id=\"search-input\">\n        <button type=\"submit\" class=\"ais-SearchBox-submit\">\n            <svg class=\"ais-SearchBox-submitIcon\" xmlns=\"https://www.w3.org/2000/svg\" width=\"10\" height=\"10\" viewBox=\"0 0 40 40\">\n    <path d=\"M26.804 29.01c-2.832 2.34-6.465 3.746-10.426 3.746C7.333 32.756 0 25.424 0 16.378 0 7.333 7.333 0 16.378 0c9.046 0 16.378 7.333 16.378 16.378 0 3.96-1.406 7.594-3.746 10.426l10.534 10.534c.607.607.61 1.59-.004 2.202-.61.61-1.597.61-2.202.004L26.804 29.01zm-10.426.627c7.323 0 13.26-5.936 13.26-13.26 0-7.32-5.937-13.257-13.26-13.257C9.056 3.12 3.12 9.056 3.12 16.378c0 7.323 5.936 13.26 13.258 13.26z\"></path>\n</svg>\n\n            <span class=\"fcc_sr_only\">Submit your search query</span>\n        </button>\n        <div id=\"dropdown-container\"></div>\n    </div>\n</form>\n\n    </div>\n    <div class=\"site-nav-middle\">\n        <a class=\"site-nav-logo\" href=\"https://www.freecodecamp.org/news/\" data-test-label=\"site-nav-logo\"><img src=\"https://cdn.freecodecamp.org/platform/universal/fcc_primary.svg\" alt=\"freeCodeCamp.org\"></a>\n    </div>\n    <div class=\"site-nav-right\">\n        <div class=\"nav-group\">\n            <a class=\"nav-forum\" id=\"nav-forum\" rel=\"noopener noreferrer\" href=\"https://forum.freecodecamp.org/\" target=\"_blank\" data-test-label=\"forum-button\">Forum</a>\n            <a class=\"toggle-button-nav\" id=\"nav-donate\" rel=\"noopener noreferrer\" href=\"https://www.freecodecamp.org/donate/\" target=\"_blank\" data-test-label=\"donate-button\">Donate</a>\n        </div>\n    </div>\n</nav>\n\n\n            \n            <a class=\"banner\" id=\"banner\" data-test-label=\"banner\" rel=\"noopener noreferrer\" target=\"_blank\">\n    <p id=\"banner-text\"></p>\n</a>\n\n\n    \n    <script>document.addEventListener(\"DOMContentLoaded\",(()=>{const e=document.getElementById(\"banner\"),t=document.getElementById(\"banner-text\");isAuthenticated?(t.innerHTML=\"Support our charity and our mission. <span>Donate to freeCodeCamp.org</span>.\",e.href=\"https://www.freecodecamp.org/donate\",e.setAttribute(\"text-variation\",\"authenticated\")):isDonor?(t.innerHTML=\"Thank you for supporting freeCodeCamp through <span>your donations</span>.\",e.href=\"https://www.freecodecamp.org/news/how-to-donate-to-free-code-camp/\",e.setAttribute(\"text-variation\",\"donor\")):(t.innerHTML=\"Learn to code — <span>free 3,000-hour curriculum</span>\",e.href=\"https://www.freecodecamp.org/\",e.setAttribute(\"text-variation\",\"default\"))}));</script>\n\n\n            <div id=\"error-message\"></div>\n\n            \n    <main id=\"site-main\" class=\"post-template site-main outer\">\n        <div class=\"inner ad-layout\">\n            <article class=\"post-full post\">\n                <header class=\"post-full-header\">\n                    <section class=\"post-full-meta\">\n                        <time class=\"post-full-meta-date\" data-test-label=\"post-full-meta-date\" datetime=\"Fri Jan 05 2024 17:48:17 GMT+0000 (Coordinated Universal Time)\">\n                            January 5, 2024\n                        </time>\n                        \n                            <span class=\"date-divider\">/</span>\n                            <a dir=\"ltr\" href=\"/news/tag/data-science/\">\n                                #Data Science\n                            </a>\n                        \n                    </section>\n                    <h1 class=\"post-full-title\" data-test-label=\"post-full-title\">How to Fine-Tune EasyOCR with a Synthetic Dataset</h1>\n                </header>\n                <div class=\"post-full-author-header\" data-test-label=\"author-header-no-bio\">\n                    \n                        \n                            \n    \n    \n    \n\n    <section class=\"author-card\" data-test-label=\"author-card\">\n        \n            \n    <img srcset=\"https://www.freecodecamp.org/news/content/images/size/w60/2023/09/Screenshot_20230816_114245_Gallery--5----Copy.jpg 60w\" sizes=\"60px\" src=\"https://www.freecodecamp.org/news/content/images/size/w60/2023/09/Screenshot_20230816_114245_Gallery--5----Copy.jpg\" class=\"author-profile-image\" alt=\"Eivind Kjosbakken\" width=\"920\" height=\"1725\" onerror=\"this.style.display='none'\" data-test-label=\"profile-image\">\n  \n        \n\n        <section class=\"author-card-content author-card-content-no-bio\">\n            <span class=\"author-card-name\">\n                <a href=\"/news/author/kjosbakken/\" data-test-label=\"profile-link\">\n                    \n                        Eivind Kjosbakken\n                    \n                </a>\n            </span>\n            \n        </section>\n    </section>\n\n                        \n                    \n                </div>\n                <figure class=\"post-full-image\">\n                    \n    <picture>\n      <source media=\"(max-width: 700px)\" sizes=\"1px\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 1w\">\n      <source media=\"(min-width: 701px)\" sizes=\"(max-width: 800px) 400px, (max-width: 1170px) 700px, 1400px\" srcset=\"https://www.freecodecamp.org/news/content/images/size/w300/2024/01/image-53.png 300w, https://www.freecodecamp.org/news/content/images/size/w600/2024/01/image-53.png 600w, https://www.freecodecamp.org/news/content/images/size/w1000/2024/01/image-53.png 1000w, https://www.freecodecamp.org/news/content/images/size/w2000/2024/01/image-53.png 2000w\">\n      <img onerror=\"this.style.display='none'\" src=\"https://www.freecodecamp.org/news/content/images/size/w2000/2024/01/image-53.png\" alt=\"How to Fine-Tune EasyOCR with a Synthetic Dataset\" ,=\"\" width=\"720\" height=\"720\" data-test-label=\"feature-image\">\n    </picture>\n  \n                </figure>\n                <section class=\"post-full-content\">\n                    <div class=\"post-and-sidebar\">\n                        <section class=\"post-content \" data-test-label=\"post-content\">\n                            \n<p>OCR is a valuable tool that you can use to extract text from images. But the OCR you are using may not work as intended for your specific needs. In such situations, fine-tuning your OCR engine is the way to go. </p><p>In this tutorial, I will show you how to fine-tune EasyOCR, a free, open-source OCR engine that you can use with Python.</p><h2 id=\"table-of-contents\">Table of Contents</h2><ul><li><a href=\"#prerequisites\">Prerequisites</a></li><li><a href=\"#how-to-install-required-packages\">How to Install Required Packages</a></li><li><a href=\"#how-to-clone-the-git-repository\">How to Clone the Git repository</a></li><li><a href=\"#how-get-a-dataset\">How to Get a Dataset</a></li><li><a href=\"#how-to-generate-your-synthetic-dataset\">How to Generate your Synthetic Dataset</a></li><li><a href=\"#convert-the-dataset-to-lmdb-format\">Convert the dataset to lmdb format</a></li><li><a href=\"#how-to-retrieve-a-pre-trained-ocr-model\">How to Retrieve a Pre-trained OCR Model</a></li><li><a href=\"#how-to-run-the-fine-tuning\">How to Run the fine-tuning</a></li><li><a href=\"#how-to-run-inference-with-your-fine-tuned-model\">How to Run Inference with your Fine-tuned Model</a></li><li><a href=\"#a-qualitative-test-of-performance\">A Qualitative Test of Performance</a></li><li><a href=\"#quantitative-test-of-performance\">Quantitative Test of Performance</a></li><li><a href=\"#conclusion\">Conclusion</a></li></ul><h2 id=\"prerequisites\">Prerequisites</h2><ul><li>Basic knowledge of Python.</li><li>Basic knowledge of how to use the terminal</li></ul><h2 id=\"how-to-install-required-packages\">How to Install Required Packages</h2><p>First off, let's install the required <code>pip</code> packages. I recommend making a virtual environment for this, though it is not required. </p><p>Run the commands below, one line at a time:</p><pre><code class=\"language-bash\">pip install fire\npip install lmdb\npip install opencv-python\npip install natsort\npip install nltk</code></pre><p>You also need to install PyTorch from <a href=\"https://pytorch.org/get-started/locally/\" rel=\"noopener ugc nofollow\">this website</a> (choose your specifications and copy the pip install command. The command below is for my specifications). You can choose either the GPU version or the CPU version. The difference is that running the fine-tuning process will be slower on the CPU.</p><pre><code class=\"language-bash\">pip install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu118</code></pre><h2 id=\"how-to-clone-the-git-repository\">How to Clone the Git Repository</h2><p>You''ll need a Git repository that will help you run the fine-tuning. Clone<a href=\"https://github.com/clovaai/deep-text-recognition-benchmark\" rel=\"noopener ugc nofollow\"> this Git repo</a> with the command below:</p><pre><code class=\"language-bash\">git clone https://github.com/clovaai/deep-text-recognition-benchmark</code></pre><p>The <a href=\"https://github.com/clovaai/deep-text-recognition-benchmark\" rel=\"noopener ugc nofollow\">deep-text-recognition-benchmark Github repo</a> will give us some useful files for fine-tuning the EasyOCR model. Note that some of the terminal commands used in this article were taken from the repository and then adapted to my needs, so the repository is worth a read.</p><p>I would like to add a note here that <a href=\"https://github.com/clovaai\" rel=\"noopener ugc nofollow\">Clova AI on Git</a> has a lot of good repositories that have been of immense help to me, so feel free to check out other interesting repositories that they have. </p><p>Another interesting repo they have is the <a href=\"https://github.com/clovaai/donut\" rel=\"noopener ugc nofollow\">Donut model repo</a>, and I have written an <a href=\"https://python.plainenglish.io/empower-your-donut-model-for-receipts-with-self-annotated-data-51fc882b7229\" rel=\"noopener ugc nofollow\">article on fine-tuning the Donut model</a> that you should check out.</p><h2 id=\"how-to-get-a-dataset\">How to Get a Dataset</h2><p>Before you can fine-tune your OCR, you'll need a dataset. You can either download a dataset or make one yourself.</p><p>Since I want my OCR to be particularly good at scanning supermarket receipts, I will make a dataset of items you can find in the supermarket, but feel free to make a dataset from whatever data you need your OCR to be good at. For this section, I made use of <a href=\"https://github.com/JaidedAI/EasyOCR/blob/master/custom_model.md\" rel=\"noopener ugc nofollow\">this GitHub page</a>.</p><p>If you want to learn how to generate your own dataset, you can go to the next section right away, but &nbsp;if you want a simpler solution then you can use one of the options below:</p><h3 id=\"option-1-use-my-dummy-dataset-\">Option 1 – Use my dummy dataset:</h3><p>If you want to have this step as simple as possible (recommended if you are just testing), you can download a dummy dataset. I have made and uploaded one to <a href=\"https://drive.google.com/drive/folders/1rS-WFRqN9zkD3vetwcYYFmOzg_cMv9su?usp=sharing\" rel=\"noopener ugc nofollow\">this Google Drive</a> (download the whole folder).</p><h3 id=\"option-2-download-a-dataset\">Option 2 – Download a dataset</h3><p>If you want a larger dataset, you can download a dataset from <a href=\"https://www.dropbox.com/sh/i39abvnefllx2si/AAAbAYRvxzRp3cIE5HzqUw3ra?dl=0\">this Dropbox page</a> by downloading the data_lmdb_release.zip file (note that it is a bit over 18GB in size).</p><h2 id=\"how-to-generate-your-synthetic-dataset\">How to Generate your Synthetic Dataset</h2><p>If you want a cooler approach to creating your own dataset, you can follow along with this section. I originally wrote about it in <a href=\"https://blog.devgenius.io/generating-a-fine-tuning-dataset-for-an-ocr-engine-3509167bc8a1\">this Medium article</a>. </p><p>For this section, you should use a separate Python file.</p><p>The great thing about a synthetic dataset is that you don't need any labor-intensive labeling, as you are creating the images based on provided textual descriptions. This means that you have both the input to the model (the image) and the label (the text of the images), the two components needed to fine-tune an AI model.</p><figure class=\"kg-card kg-image-card kg-width-wide kg-card-hascaption\"><img src=\"https://www.freecodecamp.org/news/content/images/2023/12/image-61.png\" class=\"kg-image\" alt=\"image-61\" width=\"450\" height=\"200\" loading=\"lazy\"><figcaption>Make synthetic images like this by following this section</figcaption></figure><h3 id=\"clone-the-synthetic-generation-repo\">Clone the Synthetic Generation Repo</h3><p>First, you have to clone <a href=\"https://github.com/Belval/TextRecognitionDataGenerator\" rel=\"noopener ugc nofollow\">this synthetic data generation</a> repository to be able to create synthetic data. To clone it, open a new folder, and run this command:</p><pre><code class=\"language-bash\">git clone https://github.com/Belval/TextRecognitionDataGenerator.git</code></pre><p>This repository allows you to create images from a given text description. You will then have the dataset you need: images, and a txt file stating the text on the images (the label).</p><h3 id=\"create-a-file-to-generate-the-synthetic-data\">Create a File to Generate the Synthetic Data</h3><p>Now create a new file called <code>generate_synth_data.py</code>, and add the code below to import the useful packages:</p><pre><code class=\"language-py\">from trdg.generators import (\n    GeneratorFromStrings,\n)\nfrom tqdm.auto import tqdm\nimport os\nimport pandas as pd\nimport numpy as np\nimport random</code></pre><p>To run them, you need these <code>pip</code> installations (run one line at a time in the terminal). Note that a specific <code>Pillow</code> version is needed (you will get an error if you have the newest Pillow version):</p><pre><code class=\"language-bash\">pip install trdg\npip install pandas\npip install Pillow==9.5.0</code></pre><p>Next, define some hyperparameters (set them to whatever values you prefer):</p><pre><code class=\"language-py\">NUM_IMAGES_TO_SAVE = 10\nNUM_PRICES_TO_GENERATE = 10000</code></pre><p>Now you need a large dataset with words you want to have on the images you create. Since I want my OCR to be good at reading supermarket receipts, I used <a href=\"https://no.openfoodfacts.org/\" rel=\"noopener ugc nofollow\">Openfoodfacts</a>, which is a website that contains a lot of supermarket items. </p><p>To make it as simple as possible, you can use the CSV file on <a href=\"https://drive.google.com/file/d/1DZhRBVGpf9smuiom3JdL0QW0HEgKIqtQ/view?usp=sharing\" rel=\"noopener ugc nofollow\">this Google Drive page</a> (just download it and place it in your folder).</p><p>Note that you can make use of any other data, instead of using mine. If you want to use your own data, all you need is a list of strings, which you can feed into the generator to create images.</p><p>Here's how you can read the CSV file containing supermarket items:</p><pre><code class=\"language-py\"># helper funcs and data to generate images\ndf = pd.read_csv(\"openfoodfacts_export_csv.csv\", on_bad_lines='skip', sep='\\t', low_memory=True)\ndf[[\"product_name_nb\", \"generic_name_nb\", \"brands\"]]\nall_words = df[[\"product_name_nb\", \"generic_name_nb\", \"brands\"]].to_numpy().flatten()</code></pre><p>Here I am loading in my own data, but the code will look different if you are using your own data.</p><p>Here's how you can filter the data:</p><pre><code class=\"language-py\"># ignore np nan \nnum_before = len(all_words)\nall_words = [x for x in all_words if str(x) != 'nan']\nafter_nan_filter = len(all_words)\nprint(\"removed: \", num_before - after_nan_filter, \"words because of nan values\")\nall_words = list(set(all_words))\nprint(\"Removed\", len(all_words), \"duplicates\")\nprint(\"Current number of words: \", len(all_words))</code></pre><p>Note that I am always printing the amount of words removed in the filtering process. This is good practice, as it lets you have a better overview of the size and quality of your dataset.</p><p>I also want to have a price on the images, so I am randomly generating some prices with the code below:</p><pre><code class=\"language-py\">#randomly generate 2 digits between 0-99\nnumber_strings = []\nfor i in range(len(all_words)*9//10): #90 percent of all words\n digits = np.random.randint(1, 100, 4)\n before_comma = f\"{str(digits[0])}\" #before comma is just given as 1 digit if 0-9\n after_comma = f\"{str(digits[1])}\" if len(str(digits[1])) == 2 else f\"0{str(digits[1])}\"\n number_string = f\"{before_comma},{after_comma}\"\n number_strings.append(number_string)\n\n#then create 10 percent of the words with price between 100-999\nfor i in range(len(all_words)*1//10): #90 percent of all words\n before_comma = np.random.randint(100, 999, 1)\n after_comma = np.random.randint(1, 99, 1)\n after_comma = f\"{str(after_comma[0])}\" if len(str(after_comma[0])) == 2 else f\"0{str(after_comma[0])}\"\n number_string = f\"{str(before_comma[0])},{str(after_comma)}\"\n number_strings.append(number_string)</code></pre><p>The code below randomly combines the supermarket items with the prices:</p><pre><code class=\"language-py\">#now given word list and number list, get all combinations\nall_combinations = []\nfor word in tqdm(all_words):\n for number in random.sample(number_strings, 20): #only need 20 prices per product for example\n  for num_tabs in [1]:\n   combined_string = word + \"    \"*num_tabs + number\n   all_combinations.append(combined_string)</code></pre><p>Use the repository you cloned earlier to create the images from the list of strings we have created:</p><pre><code class=\"language-py\">#generate the images\ngenerator = GeneratorFromStrings(\n    random.sample(all_combinations, 10000),\n\n    # uncomment the lines below for some image augmentation options\n    # blur=6,\n    # random_blur=True,\n    # random_skew=True,\n    # skewing_angle=20,\n    # background_type=1,\n    # text_color=\"red\",\n)</code></pre><p>There are a lot of options for generating the data, which you can read more about <a href=\"https://github.com/Belval/TextRecognitionDataGenerator\" rel=\"noopener ugc nofollow\">here</a>. Some examples are: changing the background, adding blur, and adding skewing. You can try this out by uncommenting some of the lines in the code snippet above.</p><p>Then save the images from the generator to a specific format:</p><pre><code class=\"language-py\"># save images from generator\n# if output folder doesnt exist, create it\nif not os.path.exists('output'):\n    os.makedirs('output')\n#if labels.txt doesnt exist, create it\nif not os.path.exists('output/labels.txt'):\n    f = open(\"output/labels.txt\", \"w\")\n    f.close()\n\n#open txt file\ncurrent_index = len(os.listdir('output')) - 1 #all images minus the labels file\nf = open(\"output/labels.txt\", \"a\")\n\nfor counter, (img, lbl) in tqdm(enumerate(generator), total = NUM_IMAGES_TO_SAVE):\n    if (counter &gt;= NUM_IMAGES_TO_SAVE):\n        break\n    # img.show()\n    #save pillow image\n    img.save(f'output/image{current_index}.png')\n    f.write(f'image{current_index}.png {lbl}\\n')\n    current_index += 1\n    # Do something with the pillow images here.\nf.close()</code></pre><h3 id=\"generate-the-synthetic-data\">Generate the Synthetic Data</h3><p>You can run the <code>generate_synth_data.py</code><em><em> </em></em>file you created with this command in the terminal:</p><pre><code class=\"language-bash\">python generate_synth_data.py</code></pre><p>You should see an image similar to the one below (you may have a different text, in your output folder):</p><figure class=\"kg-card kg-image-card kg-width-wide kg-card-hascaption\"><img src=\"https://www.freecodecamp.org/news/content/images/2023/12/image-62.png\" class=\"kg-image\" alt=\"image-62\" width=\"140\" height=\"32\" loading=\"lazy\"><figcaption>This image was synthetically generated</figcaption></figure><p>Your images will be organized in the order in the image below, where the <code>.png</code> files are your images, and the <code>labels.txt</code> file contains the text in each image. This allows you to use the dataset for fine-tuning.</p><figure class=\"kg-card kg-image-card kg-width-wide kg-card-hascaption\"><img src=\"https://www.freecodecamp.org/news/content/images/2023/12/image-63.png\" class=\"kg-image\" alt=\"image-63\" width=\"99\" height=\"223\" loading=\"lazy\"><figcaption>The output folder structure from running the code above.</figcaption></figure><p>Congrats, you can now make your own synthetic dataset. Since you now have both an image and the text of that image in a <code>labels.txt</code> file, you can use this to fine-tune an OCR engine, which I will talk more about below.</p><h2 id=\"how-to-convert-the-dataset-to-lmdb-format\">How to Convert the Dataset to LMDB Format</h2><p>LMDB stands for <a href=\"http://www.lmdb.tech/doc/\" rel=\"noopener ugc nofollow\">Lightning Memory-Mapped Database Manager</a> and is essentially an encoding you can use for your dataset to train AI models. </p><p>You can read more about it on the <a href=\"https://lmdb.readthedocs.io/en/release/\" rel=\"noopener ugc nofollow\">LMDB docs</a>. After you have created your dataset, you should have a folder with your images, and the labels for all the images (the text in the images) in a <code>labels.txt</code> file. </p><p>Your folder should look similar to the image below, and should be inside the <strong>deep-text-recognition</strong> folder:</p><figure class=\"kg-card kg-image-card kg-card-hascaption\"><img src=\"https://www.freecodecamp.org/news/content/images/2023/12/image-54.png\" class=\"kg-image\" alt=\"image-54\" width=\"99\" height=\"238\" loading=\"lazy\"><figcaption>How the folder for your dataset should look before converting to LMDB format</figcaption></figure><p><strong>NOTE</strong>: Make sure you have at least 10 images in your folder. You may get an error when running the training script later in the tutorial if you have fewer images.</p><p>You have to make some changes in the <code>create_lmdb_dataset.py</code><em><em> </em></em>file in the <strong>deep-text-recognition-benchmark</strong> folder:</p><p>Set the <code>map_size</code><em><em> </em></em>variable to a lower value — I was getting a disk memory error with the previous value. I set the new value for <code>map_size</code><em><em> </em></em>to 1073741824, as can be seen below:</p><pre><code class=\"language-py\"># OLD LINE\n# ...\nenv = lmdb.open(outputPath, map_size=1099511627776)\n# ...\n\n# NEW LINE \n# ...\nenv = lmdb.open(outputPath, map_size=1073741824) \n# ...</code></pre><p>I also got an error with the utf encoding, so I removed the utf-8 encoding when opening the <code>gtFile</code>. The new line then looks like this:</p><pre><code class=\"language-py\"># OLD LINE\n# ...\nwith open(gtFile, 'r', encoding='utf-8') as data:\n# ...\n\n# NEW LINE\n# ...\nwith open(gtFile, 'r') as data:\n# ...</code></pre><p>Lastly, I changed the way <code>imagePath</code> was read:</p><pre><code class=\"language-py\"># OLD LINE\n# ...\nimagePath, label = datalist[i].strip('\\n').split('\\t')\n# ...\n\n# NEW LINES\n# ...\nimagePath, label = datalist[i].strip('\\n').split('.png')\nimagePath += '.png'\n# ...</code></pre><p>The <code>create_lmdb_dataset.py</code> file should look like this (code from <a href=\"https://github.com/clovaai/deep-text-recognition-benchmark\" rel=\"noopener ugc nofollow\">this Git repo</a>, with the changes above applied):</p><pre><code class=\"language-py\">import fire\nimport os\nimport lmdb\nimport cv2\n\nimport numpy as np\n\n\ndef checkImageIsValid(imageBin):\n    if imageBin is None:\n        return False\n    imageBuf = np.frombuffer(imageBin, dtype=np.uint8)\n    img = cv2.imdecode(imageBuf, cv2.IMREAD_GRAYSCALE)\n    imgH, imgW = img.shape[0], img.shape[1]\n    if imgH * imgW == 0:\n        return False\n    return True\n\n\ndef writeCache(env, cache):\n    with env.begin(write=True) as txn:\n        for k, v in cache.items():\n            txn.put(k, v)\n\n\ndef createDataset(inputPath, gtFile, outputPath, checkValid=True):\n    \"\"\"\n    Create LMDB dataset for training and evaluation.\n    ARGS:\n        inputPath  : input folder path where starts imagePath\n        outputPath : LMDB output path\n        gtFile     : list of image path and label\n        checkValid : if true, check the validity of every image\n    \"\"\"\n    os.makedirs(outputPath, exist_ok=True)\n    env = lmdb.open(outputPath, map_size=1073741824) #TODO Changed map size\n    cache = {}\n    cnt = 1\n\n    with open(gtFile, 'r') as data: #TODO removed utf-8 encoding here since I have norwegian letters\n        datalist = data.readlines()\n\n    nSamples = len(datalist)\n    print(nSamples)\n    for i in range(nSamples):\n        #TODO changed the way imagePath is found as well to match my usecase\n        imagePath, label = datalist[i].strip('\\n').split('.png')\n        imagePath += '.png'\n\n        # imagePath, label = datalist[i].strip('\\n').split('\\t')\n        imagePath = os.path.join(inputPath, imagePath)\n\n        # # only use alphanumeric data\n        # if re.search('[^a-zA-Z0-9]', label):\n        #     continue\n\n        if not os.path.exists(imagePath):\n            print('%s does not exist' % imagePath)\n            continue\n        with open(imagePath, 'rb') as f:\n            imageBin = f.read()\n        if checkValid:\n            try:\n                if not checkImageIsValid(imageBin):\n                    print('%s is not a valid image' % imagePath)\n                    continue\n            except:\n                print('error occured', i)\n                with open(outputPath + '/error_image_log.txt', 'a') as log:\n                    log.write('%s-th image data occured error\\n' % str(i))\n                continue\n\n        imageKey = 'image-%09d'.encode() % cnt\n        labelKey = 'label-%09d'.encode() % cnt\n        cache[imageKey] = imageBin\n        cache[labelKey] = label.encode()\n\n        if cnt % 1000 == 0:\n            writeCache(env, cache)\n            cache = {}\n            print('Written %d / %d' % (cnt, nSamples))\n        cnt += 1\n    nSamples = cnt-1\n    cache['num-samples'.encode()] = str(nSamples).encode()\n    writeCache(env, cache)\n    print('Created dataset with %d samples' % nSamples)\n\n\nif __name__ == '__main__':\n    fire.Fire(createDataset)</code></pre><p>Next, move the folder over to the <strong>deep-text-recognition-benchmark</strong> folder (the Git repo you cloned). Then run the following command in the terminal:</p><pre><code class=\"language-bash\">python .\\create_lmdb_dataset.py &lt;data folder name&gt; &lt;path to labels.txt in data folder&gt; &lt;output folder for your lmdb dataset&gt;</code></pre><p>Where:</p><ul><li><code>&lt;data folder name&gt;</code> is the name of your folder with images and <code>labels.txt</code> (<code>output</code><em><em> </em></em>in my case)</li><li><code>&lt;path to labels.txt&gt;</code> is the <code>&lt;data folder name&gt;</code> + the <code>labels.txt</code> (so <code>.\\output\\labels.tx<em><em>t</em></em></code><em><em> </em></em>in my case)</li><li><code>&lt;output folder for your lmdb dataset&gt;</code> is the name of a folder that will be created for your dataset converted to LMDB format (I called it<em><em> </em></em><code>.\\lmbd_output</code>)</li></ul><p>For me, this was the command (make sure to run this command inside the <strong>deep-text-recognition-benchmark</strong> folder):</p><pre><code class=\"language-bash\">python .\\create_lmdb_dataset.py .\\output .\\output\\labels.txt .\\lmbd_output</code></pre><p>Now, you should have a new folder, like the image below, in your <strong>deep-text-recognition-benchmark</strong> folder.</p><p></p><figure class=\"kg-card kg-image-card kg-card-hascaption\"><img src=\"https://www.freecodecamp.org/news/content/images/2023/12/image-55.png\" class=\"kg-image\" alt=\"image-55\" width=\"94\" height=\"58\" loading=\"lazy\"><figcaption>How the folder for your lmdb converted data should look</figcaption></figure><p><strong>NOTE</strong>: Running the command on an existing folder does not overwrite the existing folder. Make sure you either delete a folder or give the <strong>lmdb_output</strong><em><em> </em></em>a new name (this was something I struggled with for a while, so hopefully, this will help you avoid that error).</p><h2 id=\"how-to-retrieve-a-pre-trained-ocr-model\">How to Retrieve a Pre-trained OCR Model</h2><p>Next, you need a pre-trained OCR model that you can fine-tune with your dataset. For this, you can go to <a href=\"https://drive.google.com/drive/folders/15WPsuPJDCzhp2SvYZLRj8mAlT3zmoAMW\" rel=\"noopener ugc nofollow\">this Dropbox website</a> and download the <code>TPS-ResNet-BiLSTM-Attn.pth</code> model. </p><p>Place the model in your <strong>deep-text-recognition-benchmark</strong> folder (I know this looks a bit shady, but this is the part of the instructions in the deep-text-recognition-benchmark<em><em> </em></em>repository. The Dropbox is not mine, and I am linking it here because it is linked in the Git repo <em><em>text-recognition-benchmark</em></em>)</p><h2 id=\"how-to-run-the-fine-tuning\">How to Run the Fine-tuning</h2><p>If you run on CPU (this can be ignored if you are using GPU), you'll likely get an error that says: \"RuntimeError: Attempting to deserialize object on a CUDA device but torch.cuda.is_available() is False\". </p><p>This can be fixed by changing lines 85 and 87 in the <code>train.py</code> file:</p><pre><code class=\"language-py\"># OLD LINES\n# ...\nif opt.FT:\n    model.load_state_dict(torch.load(opt.saved_model), strict=False)\nelse:\n    model.load_state_dict(torch.load(opt.saved_model))\n# ...\n\n\n# NEW LINES (change to this if you are using CPU)\n#\nif opt.FT:\n    model.load_state_dict(torch.load(opt.saved_model,map_location='cpu'), strict=False)\nelse:\n    model.load_state_dict(torch.load(opt.saved_model,map_location='cpu'))\n# ...</code></pre><p>Finally, you can then run the fine-tuning. To do that, you can use the command below in the terminal:</p><pre><code class=\"language-bash\">python train.py --train_data lmdb_output --valid_data lmdb_output --select_data \"/\" --batch_ratio 1.0 --Transformation TPS --FeatureExtraction ResNet --SequenceModeling BiLSTM --Prediction Attn --batch_size 2 --data_filtering_off --workers 0 --batch_max_length 80 --num_iter 10 --valInterval 5 --saved_model TPS-ResNet-BiLSTM-Attn.pth</code></pre><p>Some notes on the command:</p><ul><li><code>data_filtering_off</code> is set to <code>True</code> (you only have to use the flag, not give it a variable). I did not use <code>data_filtering</code> because I'll have no samples to train on if filtering was enabled.</li><li>Workers were to set to 0 to avoid errors. I think this has something to do with multi-GPU settings, and this is also referred to in the <code>train.py</code> file in the <strong>deep-text-recognition-benchmark</strong> folder.</li><li><code>batch_max_length</code> is the maximum length of any text in the training dataset. If you are using a different dataset, feel free to change this variable. Make sure this variable is as large as the longest string you are using in your dataset, or you'll get an error.</li><li>For this tutorial, I use <code>train_data</code><em><em> </em></em>and <code>valid_data</code><em><em> </em></em>to refer<em><em> </em></em>to the same folder. In practice, I would create one folder with a training dataset, and one for a validation dataset and refer to those instead.</li><li>I set <code>num_iter</code> to 10 so you can make sure it works. Naturally, this variable must be set much higher when running the actual fine-tuning of a model.</li><li><code>saved_model</code> is an optional parameter. If you don’t set it, you will train a model from scratch. You probably don't want that (as this will require a lot of training), so set the <code>saved_model</code> flag to the existing model you <a href=\"https://drive.google.com/drive/folders/15WPsuPJDCzhp2SvYZLRj8mAlT3zmoAMW\" rel=\"noopener ugc nofollow\">downloaded from Dropbox</a>.</li></ul><h2 id=\"how-to-run-inference-with-your-fine-tuned-model\">How to Run Inference with your Fine-tuned Model</h2><p>After you have fine-tuned your model, you'd want to run inference with it. To do this, you can use the command below:</p><pre><code class=\"language-bash\">python demo.py --Transformation TPS --FeatureExtraction ResNet --SequenceModeling BiLSTM --Prediction Attn --image_folder &lt;path to images to test on&gt; --saved_model &lt;path to model to use&gt;</code></pre><p>Where:</p><ul><li><code>&lt;path to images to test on&gt;</code> is a folder consisting of PNG images you want to test on. For me, this was <strong>output</strong></li><li><code>&lt;path to model to use&gt;</code> is the path to the saved model from your fine-tuning. For me, this was <strong>.\\saved_models\\TPS-ResNet-BiLSTM-Attn-Seed1111\\best_accuracy.pth</strong><em><em> </em></em>(the fine-tuning saves the fine-tuned model in a <code>saved_models</code><em><em> </em></em>folder)</li></ul><p>Here's the command that I used:</p><pre><code class=\"language-bash\">python demo.py --Transformation TPS --FeatureExtraction ResNet --SequenceModeling BiLSTM --Prediction Attn --image_folder output --saved_model .\\saved_models\\TPS-ResNet-BiLSTM-Attn-Seed1111\\best_accuracy.pth</code></pre><p>The command simply outputs the model's prediction and confidence score for each image in the <code>&lt;path to images to test on&gt;</code> folder, so you can check the performance of the model by looking at the images yourself to see if the model made the right prediction. This is a qualitative test of the performance of the model.</p><h2 id=\"a-qualitative-test-of-performance\">A Qualitative Test of Performance</h2><p>To see if the fine-tuning worked, I will do a qualitative test of the performance by testing the original model against my fine-tuned model on 10 specific words and numbers. </p><p>The words I tested are shown below (merged vertically into one image). I had to make it a bit difficult for the model by adding skewed and blurred texts.</p><figure class=\"kg-card kg-image-card kg-card-hascaption\"><img src=\"https://www.freecodecamp.org/news/content/images/2023/12/image-56.png\" class=\"kg-image\" alt=\"image-56\" width=\"95\" height=\"128\" loading=\"lazy\"><figcaption>Self-made images merged with <a href=\"https://products.aspose.app/pdf/merger/png-to-png\" rel=\"noopener ugc nofollow\">https://products.aspose.app/pdf/merger/png-to-png</a>. The words from top to bottom are: “vanskeligheter”, “uvanligheter”, “skrekkeksempel”, “rosenborg”</figcaption></figure><p>Considering that I want my OCR to read Norwegian supermarket receipts, I added some Norwegian words (the words are taken from <a href=\"http://openfoodfacts.com/\" rel=\"noopener ugc nofollow\">http://openfoodfacts.com/</a>, you can read more about it in <a href=\"https://medium.com/dev-genius/generating-a-fine-tuning-dataset-for-an-ocr-engine-3509167bc8a1\" rel=\"noopener\">this article</a>). </p><p>Hopefully, my fine-tuned model should perform better on these words, as the original OCR model is not used to seeing Norwegian words. My fine-tuned model has been trained on some Norwegian words.</p><p>The texts in each image are:</p><ul><li>image0 -&gt; vanskeligheter</li><li>image1 -&gt; uvanligheter</li><li>image2 -&gt; skrekkeksempel</li><li>image3 -&gt; rosenborg</li></ul><p>Results for the original model (not fine-tuned):</p><figure class=\"kg-card kg-image-card kg-card-hascaption\"><img src=\"https://www.freecodecamp.org/news/content/images/2023/12/image-57.png\" class=\"kg-image\" alt=\"image-57\" srcset=\"https://www.freecodecamp.org/news/content/images/size/w600/2023/12/image-57.png 600w, https://www.freecodecamp.org/news/content/images/2023/12/image-57.png 659w\" width=\"659\" height=\"156\" loading=\"lazy\"><figcaption>Results for the original model (not fine-tuned) on a qualitative test. You can see the model struggles quite a bit</figcaption></figure><p>Results for fine-tuned model:</p><figure class=\"kg-card kg-image-card kg-card-hascaption\"><img src=\"https://www.freecodecamp.org/news/content/images/2023/12/image-58.png\" class=\"kg-image\" alt=\"image-58\" srcset=\"https://www.freecodecamp.org/news/content/images/size/w600/2023/12/image-58.png 600w, https://www.freecodecamp.org/news/content/images/2023/12/image-58.png 720w\" sizes=\"(min-width: 720px) 720px\" width=\"720\" height=\"113\" loading=\"lazy\"><figcaption>Results for the fine-tuned model. You can see the model achieves perfect accuracy because of the fine-tuning.</figcaption></figure><p>As you can see, the fine-tuning has worked, and the fine-tuned model achieves perfect results in this qualitative example.</p><p>To interpret your results qualitatively, you should grab a sample of documents that are representative for the full dataset and manually compare the OCR output and the ground truth. This will give you a feel of how well the model is performing, as you can see how often it makes errors. </p><p>You should note that you often cannot expect perfect results from the fine-tuned OCR engine, and you can therefore use the qualitative analysis to determine specific errors the model is making. </p><p>This could, for example, be the model having difficulties recognizing certain characters. If this is the case, you can train the model on more examples of those characters to further increase the performance of your model. </p><h2 id=\"quantitative-test-of-performance\">Quantitative Test of Performance</h2><p>If you want a more quantitative test, you can either look at the validation results that show up during fine-tuning, or you can use the command below:</p><pre><code class=\"language-bash\">python test.py --eval_data &lt;path to test data set in lmdb format&gt; --Transformation TPS --FeatureExtraction ResNet --SequenceModeling BiLSTM --Prediction Attn --saved_model &lt;path to model to test&gt; --batch_max_length 70 --workers 0 --batch_size 2 --data_filtering_off</code></pre><p>Where:</p><ul><li><code>&lt;path to test data set in lmdb format&gt;</code> is the path to the folder containing the test data in LMDB format. For me, this was: <code>lmdb_norwegian_data_test</code></li><li><code>&lt;path to model to test&gt;</code> is the path to the model you want to test its performance of. For me, this was:<em><em> </em></em><code>saved_models/TPS-ResNet-BiLSTM-Attn-Seed1111/best_accuracy.pth</code>.</li></ul><p>The command I used was therefore:</p><pre><code class=\"language-bash\">python test.py --eval_data lmdb_norwegian_data_test --Transformation TPS --FeatureExtraction ResNet --SequenceModeling BiLSTM --Prediction Attn --saved_model saved_models/TPS-ResNet-BiLSTM-Attn-Seed1111/best_accuracy.pth --batch_max_length 70 --workers 0 --batch_size 2 --data_filtering_off</code></pre><p>This will output accuracy in percentage, so a number between 0 and 100, which is the accuracy the OCR model achieves on your test dataset.</p><p>In my experience, the model you downloaded from Dropbox needs a bit of training. At first, the model will make inaccurate predictions, but if you let it train for 30 minutes or so you should start seeing some improvements.</p><p>I then ran the <code>test.py</code> on the 4 images I showed above and got the results in the images below: with the old (not fine-tuned) model to on top and the new fine-tuned model below. </p><p>Results from the old model:</p><figure class=\"kg-card kg-image-card kg-width-wide kg-card-hascaption\"><img src=\"https://www.freecodecamp.org/news/content/images/2023/12/image-59.png\" class=\"kg-image\" alt=\"image-59\" width=\"586\" height=\"99\" loading=\"lazy\"><figcaption>Result for the old model, which acieves an accuracy of 50%.</figcaption></figure><p>Results from the fine-tuned model:</p><figure class=\"kg-card kg-image-card kg-width-wide kg-card-hascaption\"><img src=\"https://www.freecodecamp.org/news/content/images/2023/12/image-60.png\" class=\"kg-image\" alt=\"image-60\" srcset=\"https://www.freecodecamp.org/news/content/images/size/w600/2023/12/image-60.png 600w, https://www.freecodecamp.org/news/content/images/2023/12/image-60.png 640w\" width=\"640\" height=\"65\" loading=\"lazy\"><figcaption>Result for the new fine-tuned model which achieves an accuracy of 100%, which indicates the fine-tuning worked</figcaption></figure><p>You can see that the new fine-tuned model performs better with a accuracy of 100 percent.</p><h2 id=\"conclusion\">Conclusion</h2><p>Congrats, you can now fine-tune your OCR model. To make a significant impact on a larger model and generalize it, you probably have to make a larger dataset. You can learn about that in <a href=\"https://medium.com/dev-genius/generating-a-fine-tuning-dataset-for-an-ocr-engine-3509167bc8a1\" rel=\"noopener\">this tutorial</a>, and then let the model train for a while. </p><p>In the end, the OCR model will hopefully perform better for your specific use case.</p><p>This tutorial was originally written part by part on my Medium, you can check out each part here:</p><ul><li><a href=\"https://blog.devgenius.io/generating-a-fine-tuning-dataset-for-an-ocr-engine-3509167bc8a1\">Generating a synthetic fine-tuning dataset for an OCR engine</a></li><li><a href=\"https://pub.towardsai.net/how-to-fine-tune-easyocr-to-achieve-better-ocr-performance-1540f5076428\">How to Fine-tune EasyOCR to achieve better OCR performance</a></li></ul><p>If you are interested and want to learn more about similar topics, you can find me on:</p><ul><li><a href=\"https://medium.com/@oieivind\">✅ Medium</a></li><li><a href=\"https://twitter.com/Ravenspike21\">✅</a> <a href=\"https://twitter.com/Ravenspike21\">Twitter</a></li><li><a href=\"https://www.linkedin.com/in/eivind-kjosbakken/\">✅</a><a href=\"https://www.linkedin.com/in/eivind-kjosbakken/\">LinkedIn</a></li></ul><p>Cover image: Use OCR to read documents. Image made with DALL-E. OpenAI. (2023). ChatGPT (Large language model) <a href=\"https://chat.openai.com/\" rel=\"noopener ugc nofollow\">https://chat.openai.com</a>.</p>\n\n                        </section>\n                        \n                            <div class=\"sidebar\">\n                                \n                                    \n                                        <div class=\"ad-wrapper\" data-test-label=\"ad-wrapper\">\n    \n    <div class=\"ad-text\" data-test-label=\"ad-text\">ADVERTISEMENT</div>\n    <ins class=\"adsbygoogle\" style=\"display: block; height: 280px;\" data-ad-client=\"ca-pub-9482786369113753\" data-ad-slot=\"5720086888\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins>\n    <script>\n        (adsbygoogle = window.adsbygoogle || []).push({});\n    </script>\n</div>\n\n                                    \n                                        <div class=\"ad-wrapper\" data-test-label=\"ad-wrapper\">\n    \n    <div class=\"ad-text\" data-test-label=\"ad-text\">ADVERTISEMENT</div>\n    <ins class=\"adsbygoogle\" style=\"display: block; height: 280px;\" data-ad-client=\"ca-pub-9482786369113753\" data-ad-slot=\"5720086888\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins>\n    <script>\n        (adsbygoogle = window.adsbygoogle || []).push({});\n    </script>\n</div>\n\n                                    \n                                        <div class=\"ad-wrapper\" data-test-label=\"ad-wrapper\">\n    \n    <div class=\"ad-text\" data-test-label=\"ad-text\">ADVERTISEMENT</div>\n    <ins class=\"adsbygoogle\" style=\"display: block; height: 280px;\" data-ad-client=\"ca-pub-9482786369113753\" data-ad-slot=\"5720086888\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins>\n    <script>\n        (adsbygoogle = window.adsbygoogle || []).push({});\n    </script>\n</div>\n\n                                    \n                                        <div class=\"ad-wrapper\" data-test-label=\"ad-wrapper\">\n    \n    <div class=\"ad-text\" data-test-label=\"ad-text\">ADVERTISEMENT</div>\n    <ins class=\"adsbygoogle\" style=\"display: block; height: 280px;\" data-ad-client=\"ca-pub-9482786369113753\" data-ad-slot=\"5720086888\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins>\n    <script>\n        (adsbygoogle = window.adsbygoogle || []).push({});\n    </script>\n</div>\n\n                                    \n                                        <div class=\"ad-wrapper\" data-test-label=\"ad-wrapper\">\n    \n    <div class=\"ad-text\" data-test-label=\"ad-text\">ADVERTISEMENT</div>\n    <ins class=\"adsbygoogle\" style=\"display: block; height: 280px;\" data-ad-client=\"ca-pub-9482786369113753\" data-ad-slot=\"5720086888\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins>\n    <script>\n        (adsbygoogle = window.adsbygoogle || []).push({});\n    </script>\n</div>\n\n                                    \n                                        <div class=\"ad-wrapper\" data-test-label=\"ad-wrapper\">\n    \n    <div class=\"ad-text\" data-test-label=\"ad-text\">ADVERTISEMENT</div>\n    <ins class=\"adsbygoogle\" style=\"display: block; height: 280px;\" data-ad-client=\"ca-pub-9482786369113753\" data-ad-slot=\"5720086888\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins>\n    <script>\n        (adsbygoogle = window.adsbygoogle || []).push({});\n    </script>\n</div>\n\n                                    \n                                        <div class=\"ad-wrapper\" data-test-label=\"ad-wrapper\">\n    \n    <div class=\"ad-text\" data-test-label=\"ad-text\">ADVERTISEMENT</div>\n    <ins class=\"adsbygoogle\" style=\"display: block; height: 280px;\" data-ad-client=\"ca-pub-9482786369113753\" data-ad-slot=\"5720086888\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins>\n    <script>\n        (adsbygoogle = window.adsbygoogle || []).push({});\n    </script>\n</div>\n\n                                    \n                                        <div class=\"ad-wrapper\" data-test-label=\"ad-wrapper\">\n    \n    <div class=\"ad-text\" data-test-label=\"ad-text\">ADVERTISEMENT</div>\n    <ins class=\"adsbygoogle\" style=\"display: block; height: 280px;\" data-ad-client=\"ca-pub-9482786369113753\" data-ad-slot=\"5720086888\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins>\n    <script>\n        (adsbygoogle = window.adsbygoogle || []).push({});\n    </script>\n</div>\n\n                                    \n                                        <div class=\"ad-wrapper\" data-test-label=\"ad-wrapper\">\n    \n    <div class=\"ad-text\" data-test-label=\"ad-text\">ADVERTISEMENT</div>\n    <ins class=\"adsbygoogle\" style=\"display: block; height: 280px;\" data-ad-client=\"ca-pub-9482786369113753\" data-ad-slot=\"5720086888\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins>\n    <script>\n        (adsbygoogle = window.adsbygoogle || []).push({});\n    </script>\n</div>\n\n                                    \n                                        <div class=\"ad-wrapper\" data-test-label=\"ad-wrapper\">\n    \n    <div class=\"ad-text\" data-test-label=\"ad-text\">ADVERTISEMENT</div>\n    <ins class=\"adsbygoogle\" style=\"display: block; height: 280px;\" data-ad-client=\"ca-pub-9482786369113753\" data-ad-slot=\"5720086888\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins>\n    <script>\n        (adsbygoogle = window.adsbygoogle || []).push({});\n    </script>\n</div>\n\n                                    \n                                        <div class=\"ad-wrapper\" data-test-label=\"ad-wrapper\">\n    \n    <div class=\"ad-text\" data-test-label=\"ad-text\">ADVERTISEMENT</div>\n    <ins class=\"adsbygoogle\" style=\"display: block; height: 280px;\" data-ad-client=\"ca-pub-9482786369113753\" data-ad-slot=\"5720086888\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins>\n    <script>\n        (adsbygoogle = window.adsbygoogle || []).push({});\n    </script>\n</div>\n\n                                    \n                                        <div class=\"ad-wrapper\" data-test-label=\"ad-wrapper\">\n    \n    <div class=\"ad-text\" data-test-label=\"ad-text\">ADVERTISEMENT</div>\n    <ins class=\"adsbygoogle\" style=\"display: block; height: 280px;\" data-ad-client=\"ca-pub-9482786369113753\" data-ad-slot=\"5720086888\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins>\n    <script>\n        (adsbygoogle = window.adsbygoogle || []).push({});\n    </script>\n</div>\n\n                                    \n                                        <div class=\"ad-wrapper\" data-test-label=\"ad-wrapper\">\n    \n    <div class=\"ad-text\" data-test-label=\"ad-text\">ADVERTISEMENT</div>\n    <ins class=\"adsbygoogle\" style=\"display: block; height: 280px;\" data-ad-client=\"ca-pub-9482786369113753\" data-ad-slot=\"5720086888\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins>\n    <script>\n        (adsbygoogle = window.adsbygoogle || []).push({});\n    </script>\n</div>\n\n                                    \n                                        <div class=\"ad-wrapper\" data-test-label=\"ad-wrapper\">\n    \n    <div class=\"ad-text\" data-test-label=\"ad-text\">ADVERTISEMENT</div>\n    <ins class=\"adsbygoogle\" style=\"display: block; height: 280px;\" data-ad-client=\"ca-pub-9482786369113753\" data-ad-slot=\"5720086888\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins>\n    <script>\n        (adsbygoogle = window.adsbygoogle || []).push({});\n    </script>\n</div>\n\n                                    \n                                        <div class=\"ad-wrapper\" data-test-label=\"ad-wrapper\">\n    \n    <div class=\"ad-text\" data-test-label=\"ad-text\">ADVERTISEMENT</div>\n    <ins class=\"adsbygoogle\" style=\"display: block; height: 280px;\" data-ad-client=\"ca-pub-9482786369113753\" data-ad-slot=\"5720086888\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins>\n    <script>\n        (adsbygoogle = window.adsbygoogle || []).push({});\n    </script>\n</div>\n\n                                    \n                                        <div class=\"ad-wrapper\" data-test-label=\"ad-wrapper\">\n    \n    <div class=\"ad-text\" data-test-label=\"ad-text\">ADVERTISEMENT</div>\n    <ins class=\"adsbygoogle\" style=\"display: block; height: 280px;\" data-ad-client=\"ca-pub-9482786369113753\" data-ad-slot=\"5720086888\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins>\n    <script>\n        (adsbygoogle = window.adsbygoogle || []).push({});\n    </script>\n</div>\n\n                                    \n                                        <div class=\"ad-wrapper\" data-test-label=\"ad-wrapper\">\n    \n    <div class=\"ad-text\" data-test-label=\"ad-text\">ADVERTISEMENT</div>\n    <ins class=\"adsbygoogle\" style=\"display: block; height: 280px;\" data-ad-client=\"ca-pub-9482786369113753\" data-ad-slot=\"5720086888\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins>\n    <script>\n        (adsbygoogle = window.adsbygoogle || []).push({});\n    </script>\n</div>\n\n                                    \n                                        <div class=\"ad-wrapper\" data-test-label=\"ad-wrapper\">\n    \n    <div class=\"ad-text\" data-test-label=\"ad-text\">ADVERTISEMENT</div>\n    <ins class=\"adsbygoogle\" style=\"display: block; height: 280px;\" data-ad-client=\"ca-pub-9482786369113753\" data-ad-slot=\"5720086888\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins>\n    <script>\n        (adsbygoogle = window.adsbygoogle || []).push({});\n    </script>\n</div>\n\n                                    \n                                \n                            </div>\n                        \n                    </div>\n                    <hr>\n                    \n                        <div class=\"post-full-author-header\" data-test-label=\"author-header-with-bio\">\n                            \n                                \n    \n    \n    \n\n    <section class=\"author-card\" data-test-label=\"author-card\">\n        \n            \n    <img srcset=\"https://www.freecodecamp.org/news/content/images/size/w60/2023/09/Screenshot_20230816_114245_Gallery--5----Copy.jpg 60w\" sizes=\"60px\" src=\"https://www.freecodecamp.org/news/content/images/size/w60/2023/09/Screenshot_20230816_114245_Gallery--5----Copy.jpg\" class=\"author-profile-image\" alt=\"Eivind Kjosbakken\" width=\"920\" height=\"1725\" onerror=\"this.style.display='none'\" loading=\"lazy\" data-test-label=\"profile-image\">\n  \n        \n\n        <section class=\"author-card-content \">\n            <span class=\"author-card-name\">\n                <a href=\"/news/author/kjosbakken/\" data-test-label=\"profile-link\">\n                    \n                        Eivind Kjosbakken\n                    \n                </a>\n            </span>\n            \n                \n                    <p data-test-label=\"author-bio\">CS Student at Norwegian University of Science and Technology</p>\n                \n            \n        </section>\n    </section>\n\n                            \n                        </div>\n                        <hr>\n                    \n\n                    \n                    \n                        \n    \n\n\n<p data-test-label=\"social-row-cta\" class=\"social-row\">\n    If you read this far, thank the author to show them you care. <button id=\"tweet-btn\" class=\"cta-button\" data-test-label=\"tweet-button\">Say Thanks</button>\n</p>\n\n\n    \n    <script>document.addEventListener(\"DOMContentLoaded\",(()=>{const t=document.getElementById(\"tweet-btn\"),e=window.location,n=\"How%20to%20Fine-Tune%20EasyOCR%20with%20a%20Synthetic%20Dataset\".replace(/&#39;/g,\"%27\"),o=\"\",i=\"@Ravenspike21\",r=Boolean(\"\");let a;if(r&&(o||i)){const t={originalPostAuthor:\"\",currentPostAuthor:\"Eivind Kjosbakken\"};a=encodeURIComponent(`Thank you ${o||t.originalPostAuthor} for writing this helpful article, and ${i||t.currentPostAuthor} for translating it.`)}else!r&&i&&(a=encodeURIComponent(`Thank you ${i} for writing this helpful article.`));const s=`window.open(\\n    '${a?`https://twitter.com/intent/tweet?text=${a}%0A%0A${n}%0A%0A${e}`:`https://twitter.com/intent/tweet?text=${n}%0A%0A${e}`}',\\n    'share-twitter',\\n    'width=550, height=235'\\n  ); return false;`;t.setAttribute(\"onclick\",s)}));</script>\n\n\n                        \n\n<div class=\"learn-cta-row\" data-test-label=\"learn-cta-row\">\n    <p>\n        Learn to code for free. freeCodeCamp's open source curriculum has helped more than 40,000 people get jobs as developers. <a href=\"https://www.freecodecamp.org/learn/\" class=\"cta-button\" id=\"learn-to-code-cta\" rel=\"noopener noreferrer\" target=\"_blank\">Get started</a>\n    </p>\n</div>\n\n                    \n                </section>\n                \n                    <div class=\"banner-ad bottom\">\n                        \n                            <div class=\"ad-wrapper\" data-test-label=\"ad-wrapper\">\n    \n    <div class=\"ad-text\" data-test-label=\"ad-text\">ADVERTISEMENT</div>\n    <ins class=\"adsbygoogle\" style=\"display: block; height: 280px;\" data-ad-client=\"ca-pub-9482786369113753\" data-ad-slot=\"5720086888\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins>\n    <script>\n        (adsbygoogle = window.adsbygoogle || []).push({});\n    </script>\n</div>\n\n                        \n                    </div>\n                \n            </article>\n        </div>\n    </main>\n\n\n            \n\n\n<footer class=\"site-footer\">\n    <div class=\"footer-top\">\n        <div class=\"footer-desc-col\">\n            <p data-test-label=\"tax-exempt-status\">freeCodeCamp is a donor-supported tax-exempt 501(c)(3) charity organization (United States Federal Tax Identification Number: 82-0779546)</p>\n            <p data-test-label=\"mission-statement\">Our mission: to help people learn to code for free. We accomplish this by creating thousands of videos, articles, and interactive coding lessons - all freely available to the public.</p>\n            <p data-test-label=\"donation-initiatives\">Donations to freeCodeCamp go toward our education initiatives, and help pay for servers, services, and staff.</p>\n            <p class=\"footer-donation\" data-test-label=\"donate-text\">\n                You can <a href=\"https://www.freecodecamp.org/donate/\" class=\"inline\" rel=\"noopener noreferrer\" target=\"_blank\">make a tax-deductible donation here</a>.\n            </p>\n        </div>\n        <div class=\"trending-guides\" data-test-label=\"trending-guides\">\n            <h2 id=\"trending-guides\" class=\"col-header\">Trending Guides</h2>\n            <ul class=\"trending-guides-articles\" aria-labelledby=\"trending-guides\">\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/complete-guide-to-css-transform-functions-and-properties/\" rel=\"noopener noreferrer\" target=\"_blank\">Learn CSS Transform\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/how-to-create-a-static-blog-with-lume/\" rel=\"noopener noreferrer\" target=\"_blank\">Build a Static Blog\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/how-to-build-an-ai-chatbot-with-redis-python-and-gpt/\" rel=\"noopener noreferrer\" target=\"_blank\">Build an AI Chatbot\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/what-is-programming-tutorial-for-beginners/\" rel=\"noopener noreferrer\" target=\"_blank\">What is Programming?\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/python-code-examples-sample-script-coding-tutorial-for-beginners/\" rel=\"noopener noreferrer\" target=\"_blank\">Python Code Examples\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/a-practical-guide-to-start-opensource-contributions/\" rel=\"noopener noreferrer\" target=\"_blank\">Open Source for Devs\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/http-full-course/\" rel=\"noopener noreferrer\" target=\"_blank\">HTTP Networking in JS\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/how-to-write-unit-tests-in-react-redux/\" rel=\"noopener noreferrer\" target=\"_blank\">Write React Unit Tests\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/introduction-to-algorithms-with-javascript-examples/\" rel=\"noopener noreferrer\" target=\"_blank\">Learn Algorithms in JS\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/how-to-write-clean-code/\" rel=\"noopener noreferrer\" target=\"_blank\">How to Write Clean Code\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/the-php-handbook/\" rel=\"noopener noreferrer\" target=\"_blank\">Learn PHP\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/the-java-handbook/\" rel=\"noopener noreferrer\" target=\"_blank\">Learn Java\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/the-swift-handbook/\" rel=\"noopener noreferrer\" target=\"_blank\">Learn Swift\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/learn-golang-handbook/\" rel=\"noopener noreferrer\" target=\"_blank\">Learn Golang\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/get-started-with-nodejs/\" rel=\"noopener noreferrer\" target=\"_blank\">Learn Node.js\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/complete-guide-to-css-grid/\" rel=\"noopener noreferrer\" target=\"_blank\">Learn CSS Grid\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/learn-solidity-handbook/\" rel=\"noopener noreferrer\" target=\"_blank\">Learn Solidity\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/the-express-handbook/\" rel=\"noopener noreferrer\" target=\"_blank\">Learn Express.js\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/javascript-es-modules-and-module-bundlers/\" rel=\"noopener noreferrer\" target=\"_blank\">Learn JS Modules\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/apache-kafka-handbook/\" rel=\"noopener noreferrer\" target=\"_blank\">Learn Apache Kafka\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/rest-api-design-best-practices-build-a-rest-api/\" rel=\"noopener noreferrer\" target=\"_blank\">REST API Best Practices\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/front-end-javascript-development-react-angular-vue-compared/\" rel=\"noopener noreferrer\" target=\"_blank\">Front-End JS Development\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/build-consume-and-document-a-rest-api/\" rel=\"noopener noreferrer\" target=\"_blank\">Learn to Build REST APIs\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/build-strongly-typed-polymorphic-components-with-react-and-typescript/\" rel=\"noopener noreferrer\" target=\"_blank\">Intermediate TS and React\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/command-line-for-beginners/\" rel=\"noopener noreferrer\" target=\"_blank\">Command Line for Beginners\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/an-introduction-to-operating-systems/\" rel=\"noopener noreferrer\" target=\"_blank\">Intro to Operating Systems\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/building-consuming-and-documenting-a-graphql-api/\" rel=\"noopener noreferrer\" target=\"_blank\">Learn to Build GraphQL APIs\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/oss-security-best-practices/\" rel=\"noopener noreferrer\" target=\"_blank\">OSS Security Best Practices\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/design-patterns-for-distributed-systems/\" rel=\"noopener noreferrer\" target=\"_blank\">Distributed Systems Patterns\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/an-introduction-to-software-architecture-patterns/\" rel=\"noopener noreferrer\" target=\"_blank\">Software Architecture Patterns\n                    </a>\n                </li>\n            </ul>\n            <div class=\"spacer\" style=\"padding: 15px 0;\"></div>\n            <div>\n                <h2 id=\"mobile-app\" class=\"col-header\">\n                    Mobile App\n                </h2>\n                <div class=\"min-h-[1px] px-[15px] md:w-2/3 md:ml-[16.6%]\">\n                    <ul aria-labelledby=\"mobile-app\" class=\"mobile-app-container\">\n                        <li>\n                            <a href=\"https://apps.apple.com/us/app/freecodecamp/id6446908151?itsct=apps_box_link&itscg=30200\" rel=\"noopener noreferrer\" target=\"_blank\">\n                                <img src=\"https://cdn.freecodecamp.org/platform/universal/apple-store-badge.svg\" lang=\"en\" alt=\"Download on the App Store\">\n                            </a>\n                        </li>\n                        <li>\n                            <a href=\"https://play.google.com/store/apps/details?id=org.freecodecamp\" rel=\"noopener noreferrer\" target=\"_blank\">\n                                <img src=\"https://cdn.freecodecamp.org/platform/universal/google-play-badge.svg\" lang=\"en\" alt=\"Get it on Google Play\">\n                            </a>\n                        </li>\n                    </ul>\n                </div>\n            </div>\n        </div>\n    </div>\n    <div class=\"footer-bottom\">\n        <h2 class=\"col-header\" data-test-label=\"our-nonprofit\">Our Charity</h2>\n        <div class=\"our-nonprofit\">\n            <a href=\"https://www.freecodecamp.org/news/about/\" rel=\"noopener noreferrer\" target=\"_blank\" data-test-label=\"about\">\n                About\n            </a>\n            <a href=\"https://www.linkedin.com/school/free-code-camp/people/\" rel=\"noopener noreferrer\" target=\"_blank\" data-test-label=\"alumni\">\n                Alumni Network\n            </a>\n            <a href=\"https://github.com/freeCodeCamp/\" rel=\"noopener noreferrer\" target=\"_blank\" data-test-label=\"open-source\">\n                Open Source\n            </a>\n            <a href=\"https://www.freecodecamp.org/news/shop/\" rel=\"noopener noreferrer\" target=\"_blank\" data-test-label=\"shop\">\n                Shop\n            </a>\n            <a href=\"https://www.freecodecamp.org/news/support/\" rel=\"noopener noreferrer\" target=\"_blank\" data-test-label=\"support\">\n                Support\n            </a>\n            <a href=\"https://www.freecodecamp.org/news/sponsors/\" rel=\"noopener noreferrer\" target=\"_blank\" data-test-label=\"sponsors\">\n                Sponsors\n            </a>\n            <a href=\"https://www.freecodecamp.org/news/academic-honesty-policy/\" rel=\"noopener noreferrer\" target=\"_blank\" data-test-label=\"honesty\">\n                Academic Honesty\n            </a>\n            <a href=\"https://www.freecodecamp.org/news/code-of-conduct/\" rel=\"noopener noreferrer\" target=\"_blank\" data-test-label=\"coc\">\n                Code of Conduct\n            </a>\n            <a href=\"https://www.freecodecamp.org/news/privacy-policy/\" rel=\"noopener noreferrer\" target=\"_blank\" data-test-label=\"privacy\">\n                Privacy Policy\n            </a>\n            <a href=\"https://www.freecodecamp.org/news/terms-of-service/\" rel=\"noopener noreferrer\" target=\"_blank\" data-test-label=\"tos\">\n                Terms of Service\n            </a>\n            <a href=\"https://www.freecodecamp.org/news/copyright-policy/\" rel=\"noopener noreferrer\" target=\"_blank\" data-test-label=\"copyright\">\n                Copyright Policy\n            </a>\n        </div>\n    </div>\n</footer>\n\n        </div>\n\n        \n        \n        \n\n        <!-- Google Tag Manager (noscript) -->\n<noscript><iframe src=\"https://www.googletagmanager.com/ns.html?id=GTM-5D6RKKP\" height=\"0\" width=\"0\" style=\"display:none;visibility:hidden\"></iframe></noscript>\n<!-- End Google Tag Manager (noscript) -->\n\n        \n    <script defer src=\"https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015\" integrity=\"sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==\" data-cf-beacon='{\"rayId\":\"8ac95a118d32ce19\",\"version\":\"2024.7.0\",\"serverTiming\":{\"name\":{\"cfL4\":true}},\"token\":\"bdb993c6dde44e178aabd9555e75e4f4\",\"b\":1}' crossorigin=\"anonymous\"></script>\n</body>\n</html>\n"},"https://www.freecodecamp.org//news/create-a-self-playing-ai-chess-engine-from-scratch/":{"html":"<!DOCTYPE html>\n<html lang=\"en\">\n    <head>\n        <meta charset=\"utf-8\">\n        <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\n        \n        \n            <title>Create a Self-Playing AI Chess Engine from Scratch with Imitation Learning</title>\n        \n        <meta name=\"HandheldFriendly\" content=\"True\">\n        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n\n        <link rel=\"preconnect\" href=\"https://fonts.googleapis.com\">\n        <link rel=\"preconnect\" href=\"https://fonts.gstatic.com\" crossorigin=\"\">\n        \n            <link rel=\"preload\" as=\"style\" onload=\"this.onload=null;this.rel='stylesheet'\" href=\"https://fonts.googleapis.com/css2?family=Lato:ital,wght@0,300;0,400;0,700;1,400&family=Roboto+Mono:wght@400;700&display=swap\">\n        \n\n        \n        \n    <link rel=\"preload\" as=\"style\" onload=\"this.onload=null;this.rel='stylesheet'\" href=\"https://cdn.freecodecamp.org/news-assets/prism/1.29.0/themes/prism.min.css\">\n<noscript>\n  <link rel=\"stylesheet\" href=\"https://cdn.freecodecamp.org/news-assets/prism/1.29.0/themes/prism.min.css\">\n</noscript>\n<link rel=\"preload\" as=\"style\" onload=\"this.onload=null;this.rel='stylesheet'\" href=\"https://cdn.freecodecamp.org/news-assets/prism/1.29.0/plugins/unescaped-markup/prism-unescaped-markup.min.css\">\n<noscript>\n  <link rel=\"stylesheet\" href=\"https://cdn.freecodecamp.org/news-assets/prism/1.29.0/plugins/unescaped-markup/prism-unescaped-markup.min.css\">\n</noscript>\n\n<script defer=\"\" src=\"https://cdn.freecodecamp.org/news-assets/prism/1.29.0/components/prism-core.min.js\"></script>\n<script defer=\"\" src=\"https://cdn.freecodecamp.org/news-assets/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js\"></script>\n\n\n\n        \n        <link rel=\"preload\" as=\"style\" onload=\"this.onload=null;this.rel='stylesheet'\" href=\"/news/assets/css/global-26e2f3cde9.css\">\n        <link rel=\"stylesheet\" type=\"text/css\" href=\"/news/assets/css/screen-926fddfac2.css\">\n        <link rel=\"stylesheet\" type=\"text/css\" href=\"/news/assets/css/search-bar-124f5f949c.css\">\n\n        \n        <script defer=\"\" src=\"https://cdn.freecodecamp.org/news-assets/algolia/algoliasearch-3-33-0/algoliasearch.min.js\"></script>\n        <script defer=\"\" src=\"https://cdn.freecodecamp.org/news-assets/algolia/autocomplete-0-36-0/autocomplete.min.js\"></script>\n\n        \n        <script defer=\"\" src=\"https://cdn.freecodecamp.org/news-assets/dayjs/1.10.4/dayjs.min.js\"></script>\n        <script defer=\"\" src=\"https://cdn.freecodecamp.org/news-assets/dayjs/1.10.4/localizedFormat.min.js\"></script>\n        <script defer=\"\" src=\"https://cdn.freecodecamp.org/news-assets/dayjs/1.10.4/relativeTime.min.js\"></script>\n\n        \n        \n            <script defer=\"\" src=\"https://cdn.freecodecamp.org/news-assets/dayjs/1.10.4/locale/en.min.js\"></script>\n        \n\n        \n        <script>let client,index;document.addEventListener(\"DOMContentLoaded\",(()=>{client=algoliasearch(\"QMJYL5WYTI\",\"89770b24481654192d7a5c402c6ad9a0\"),index=client.initIndex(\"news\")})),document.addEventListener(\"DOMContentLoaded\",(()=>{const e=window.screen.width,t=window.screen.height,n=e>=767&&t>=768?8:5,o=document.getElementById(\"search-form\"),s=document.getElementById(\"search-input\"),a=document.getElementById(\"dropdown-container\");let i,d,c;s.addEventListener(\"input\",(e=>{i=e.target.value})),o.addEventListener(\"submit\",(e=>{e.preventDefault(),function(){if(d=document.getElementsByClassName(\"aa-cursor\")[0],d&&i){const e=d.querySelector(\"a\").href;window.location.assign(e)}else!d&&i&&c&&window.location.assign(`https://www.freecodecamp.org/news/search?query=${i}`)}()}));const l=autocomplete(\"#search-input\",{hint:!1,keyboardShortcuts:[\"s\",191],openOnFocus:!0,appendTo:a,debug:!0},[{source:autocomplete.sources.hits(index,{hitsPerPage:n}),debounce:250,templates:{suggestion:e=>(c=!0,`\\n            <a href=\"${e.url}\">\\n              <div class=\"algolia-result\">\\n                <span>${e._highlightResult.title.value}</span>\\n              </div>\\n            </a>\\n          `),empty:()=>(c=!1,'\\n            <div class=\"aa-suggestion footer-suggestion no-hits-footer\">\\n              <div class=\"algolia-result\">\\n                <span>\\n                  No tutorials found\\n                </span>\\n              </div>\\n            </div>\\n          '),footer:e=>{if(!e.isEmpty)return`\\n              <div class=\"aa-suggestion footer-suggestion\">\\n                <a id=\"algolia-footer-selector\" href=\"https://www.freecodecamp.org/news/search?query=${i}\">\\n                  <div class=\"algolia-result algolia-footer\">\\n                    See all results for ${i}\\n                  </div>\\n                </a>\\n              </div>\\n            `}}}]).on(\"autocomplete:selected\",((e,t,n,o)=>{d=t?t.url:`https://www.freecodecamp.org/news/search?query=${i}`,\"click\"!==o.selectionMethod&&\"tabKey\"!==o.selectionMethod&&c&&window.location.assign(d)}));document.addEventListener(\"click\",(e=>{e.target!==s&&l.autocomplete.close()}))})),document.addEventListener(\"DOMContentLoaded\",(()=>{dayjs.extend(dayjs_plugin_localizedFormat),dayjs.extend(dayjs_plugin_relativeTime),dayjs.locale(\"en\")}));const isAuthenticated=document.cookie.split(\";\").some((e=>e.trim().startsWith(\"jwt_access_token=\"))),isDonor=document.cookie.split(\";\").some((e=>e.trim().startsWith(\"isDonor=true\")));</script>\n\n        \n        \n    \n        \n            <script data-ad-client=\"ca-pub-9482786369113753\" src=\"https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js\" crossorigin=\"anonymous\" async=\"\"></script>\n        \n    \n\n\n        \n        \n    \n        \n    \n        \n    \n        \n    \n\n\n        \n        \n        \n\n        \n        \n\n        <link rel=\"icon\" href=\"https://cdn.freecodecamp.org/universal/favicons/favicon.ico\" type=\"image/png\">\n        \n        \n            <link rel=\"canonical\" href=\"https://www.freecodecamp.org/news/create-a-self-playing-ai-chess-engine-from-scratch/\">\n        \n        <meta name=\"referrer\" content=\"no-referrer-when-downgrade\">\n\n        \n\n        \n    <meta name=\"description\" content=\"This is an article on how I created an AI chess engine, starting completely from scratch to building my very own AI chess engine.  Because creating an AI chess engine from scratch is a relatively complex task, this will be a long article, but stay tuned, as the product\">\n\n    \n    <meta property=\"og:site_name\" content=\"freeCodeCamp.org\">\n    <meta property=\"og:type\" content=\"article\">\n    <meta property=\"og:title\" content=\"Create a Self-Playing AI Chess Engine from Scratch with Imitation Learning\">\n    \n        <meta property=\"og:description\" content=\"This is an article on how I created an AI chess engine, starting completely from scratch to building my very own AI chess engine.  Because creating an AI chess engine from scratch is a relatively complex task, this will be a long article, but stay tuned, as the product\">\n    \n    <meta property=\"og:url\" content=\"https://www.freecodecamp.org/news/create-a-self-playing-ai-chess-engine-from-scratch/\">\n    <meta property=\"og:image\" content=\"https://www.freecodecamp.org/news/content/images/2023/09/undraw_Programmer_re_owql.png\">\n    <meta property=\"article:published_time\" content=\"2023-09-21T08:11:38.000Z\">\n    <meta property=\"article:modified_time\" content=\"2023-09-22T04:35:52.000Z\">\n    \n        <meta property=\"article:tag\" content=\"Artificial Intelligence\">\n    \n        <meta property=\"article:tag\" content=\"AI\">\n    \n        <meta property=\"article:tag\" content=\"Python\">\n    \n    <meta property=\"article:publisher\" content=\"https://www.facebook.com/freecodecamp\">\n    \n\n    \n    <meta name=\"twitter:card\" content=\"summary_large_image\">\n    <meta name=\"twitter:title\" content=\"Create a Self-Playing AI Chess Engine from Scratch with Imitation Learning\">\n    \n        <meta name=\"twitter:description\" content=\"This is an article on how I created an AI chess engine, starting completely from scratch to building my very own AI chess engine.  Because creating an AI chess engine from scratch is a relatively complex task, this will be a long article, but stay tuned, as the product\">\n    \n    <meta name=\"twitter:url\" content=\"https://www.freecodecamp.org/news/create-a-self-playing-ai-chess-engine-from-scratch/\">\n    <meta name=\"twitter:image\" content=\"https://www.freecodecamp.org/news/content/images/2023/09/undraw_Programmer_re_owql.png\">\n    <meta name=\"twitter:label1\" content=\"Written by\">\n    <meta name=\"twitter:data1\" content=\"Eivind Kjosbakken\">\n    <meta name=\"twitter:label2\" content=\"Filed under\">\n    <meta name=\"twitter:data2\" content=\"Artificial Intelligence, AI, Python\">\n    <meta name=\"twitter:site\" content=\"@freecodecamp\">\n    \n        <meta name=\"twitter:creator\" content=\"@Ravenspike21\">\n    \n\n    <meta property=\"og:image:width\" content=\"818\">\n    <meta property=\"og:image:height\" content=\"738\">\n\n\n        \n    <script type=\"application/ld+json\">{\n\t\"@context\": \"https://schema.org\",\n\t\"@type\": \"Article\",\n\t\"publisher\": {\n\t\t\"@type\": \"Organization\",\n\t\t\"name\": \"freeCodeCamp.org\",\n\t\t\"url\": \"https://www.freecodecamp.org/news/\",\n\t\t\"logo\": {\n\t\t\t\"@type\": \"ImageObject\",\n\t\t\t\"url\": \"https://cdn.freecodecamp.org/platform/universal/fcc_primary.svg\",\n\t\t\t\"width\": 2100,\n\t\t\t\"height\": 240\n\t\t}\n\t},\n\t\"image\": {\n\t\t\"@type\": \"ImageObject\",\n\t\t\"url\": \"https://www.freecodecamp.org/news/content/images/2023/09/undraw_Programmer_re_owql.png\",\n\t\t\"width\": 818,\n\t\t\"height\": 738\n\t},\n\t\"url\": \"https://www.freecodecamp.org/news/create-a-self-playing-ai-chess-engine-from-scratch/\",\n\t\"mainEntityOfPage\": {\n\t\t\"@type\": \"WebPage\",\n\t\t\"@id\": \"https://www.freecodecamp.org/news/\"\n\t},\n\t\"datePublished\": \"2023-09-21T08:11:38.000Z\",\n\t\"dateModified\": \"2023-09-22T04:35:52.000Z\",\n\t\"keywords\": \"Artificial Intelligence, AI, Python\",\n\t\"description\": \"This is an article on how I created an AI chess engine, starting completely from\\nscratch to building my very own AI chess engine. \\n\\nBecause creating an AI chess engine from scratch is a relatively complex task,\\nthis will be a long article, but stay tuned, as the product you will end up with\\nwill be a cool project to showcase!\\n\\nPrerequisites\\nThis article will explain most concepts in detail. However, there are some\\nrecommended prerequisites to follow the tutorial. You should be familiar with\\nthe \",\n\t\"headline\": \"Create a Self-Playing AI Chess Engine from Scratch with Imitation Learning\",\n\t\"author\": {\n\t\t\"@type\": \"Person\",\n\t\t\"name\": \"Eivind Kjosbakken\",\n\t\t\"url\": \"https://www.freecodecamp.org/news/author/kjosbakken/\",\n\t\t\"sameAs\": [\n\t\t\t\"https://twitter.com/Ravenspike21\"\n\t\t],\n\t\t\"image\": {\n\t\t\t\"@type\": \"ImageObject\",\n\t\t\t\"url\": \"https://www.freecodecamp.org/news/content/images/2023/09/Screenshot_20230816_114245_Gallery--5----Copy.jpg\",\n\t\t\t\"width\": 920,\n\t\t\t\"height\": 1725\n\t\t}\n\t}\n}</script>\n\n\n        <meta name=\"generator\" content=\"Eleventy\">\n        <link rel=\"alternate\" type=\"application/rss+xml\" title=\"freeCodeCamp.org\" href=\"https://www.freecodecamp.org/news/rss/\">\n\n        <link rel=\"preconnect\" href=\"https://fonts.gstatic.com\">\n\n<!-- dataLayer setup -->\n<script>\nwindow.dataLayer = window.dataLayer || [];\n</script>\n<!-- End dataLayer setup -->\n\n<!-- Google Tag Manager -->\n<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':\nnew Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],\nj=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=\n'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);\n})(window,document,'script','dataLayer','GTM-5D6RKKP');</script>\n<!-- End Google Tag Manager -->\n\n\n<meta name=\"google-site-verification\" content=\"b4tITLzEeeZGEpvD4mGNf3khKM4fvqejQaz9SYBQP8E\">\n\n        \n        \n\n        \n  <meta name=\"x-fcc-source\" data-test-label=\"x-fcc-source\" content=\"Ghost\">\n\n    </head>\n\n    \n        <body class=\"home-template\">\n    \n        <div class=\"site-wrapper\">\n            <nav class=\"site-nav nav-padding\">\n    <div class=\"site-nav-left\">\n        \n<form id=\"search-form\" data-test-label=\"search-bar\">\n    <div role=\"search\" class=\"searchbox__wrapper\">\n        <label class=\"fcc_sr_only\" for=\"search-input\">\n            Search\n        </label>\n        <input type=\"search\" placeholder=\"\n    Search 11,200+ tutorials\n\" id=\"search-input\">\n        <button type=\"submit\" class=\"ais-SearchBox-submit\">\n            <svg class=\"ais-SearchBox-submitIcon\" xmlns=\"https://www.w3.org/2000/svg\" width=\"10\" height=\"10\" viewBox=\"0 0 40 40\">\n    <path d=\"M26.804 29.01c-2.832 2.34-6.465 3.746-10.426 3.746C7.333 32.756 0 25.424 0 16.378 0 7.333 7.333 0 16.378 0c9.046 0 16.378 7.333 16.378 16.378 0 3.96-1.406 7.594-3.746 10.426l10.534 10.534c.607.607.61 1.59-.004 2.202-.61.61-1.597.61-2.202.004L26.804 29.01zm-10.426.627c7.323 0 13.26-5.936 13.26-13.26 0-7.32-5.937-13.257-13.26-13.257C9.056 3.12 3.12 9.056 3.12 16.378c0 7.323 5.936 13.26 13.258 13.26z\"></path>\n</svg>\n\n            <span class=\"fcc_sr_only\">Submit your search query</span>\n        </button>\n        <div id=\"dropdown-container\"></div>\n    </div>\n</form>\n\n    </div>\n    <div class=\"site-nav-middle\">\n        <a class=\"site-nav-logo\" href=\"https://www.freecodecamp.org/news/\" data-test-label=\"site-nav-logo\"><img src=\"https://cdn.freecodecamp.org/platform/universal/fcc_primary.svg\" alt=\"freeCodeCamp.org\"></a>\n    </div>\n    <div class=\"site-nav-right\">\n        <div class=\"nav-group\">\n            <a class=\"nav-forum\" id=\"nav-forum\" rel=\"noopener noreferrer\" href=\"https://forum.freecodecamp.org/\" target=\"_blank\" data-test-label=\"forum-button\">Forum</a>\n            <a class=\"toggle-button-nav\" id=\"nav-donate\" rel=\"noopener noreferrer\" href=\"https://www.freecodecamp.org/donate/\" target=\"_blank\" data-test-label=\"donate-button\">Donate</a>\n        </div>\n    </div>\n</nav>\n\n\n            \n            <a class=\"banner\" id=\"banner\" data-test-label=\"banner\" rel=\"noopener noreferrer\" target=\"_blank\">\n    <p id=\"banner-text\"></p>\n</a>\n\n\n    \n    <script>document.addEventListener(\"DOMContentLoaded\",(()=>{const e=document.getElementById(\"banner\"),t=document.getElementById(\"banner-text\");isAuthenticated?(t.innerHTML=\"Support our charity and our mission. <span>Donate to freeCodeCamp.org</span>.\",e.href=\"https://www.freecodecamp.org/donate\",e.setAttribute(\"text-variation\",\"authenticated\")):isDonor?(t.innerHTML=\"Thank you for supporting freeCodeCamp through <span>your donations</span>.\",e.href=\"https://www.freecodecamp.org/news/how-to-donate-to-free-code-camp/\",e.setAttribute(\"text-variation\",\"donor\")):(t.innerHTML=\"Learn to code — <span>free 3,000-hour curriculum</span>\",e.href=\"https://www.freecodecamp.org/\",e.setAttribute(\"text-variation\",\"default\"))}));</script>\n\n\n            <div id=\"error-message\"></div>\n\n            \n    <main id=\"site-main\" class=\"post-template site-main outer\">\n        <div class=\"inner ad-layout\">\n            <article class=\"post-full post\">\n                <header class=\"post-full-header\">\n                    <section class=\"post-full-meta\">\n                        <time class=\"post-full-meta-date\" data-test-label=\"post-full-meta-date\" datetime=\"Thu Sep 21 2023 08:11:38 GMT+0000 (Coordinated Universal Time)\">\n                            September 21, 2023\n                        </time>\n                        \n                            <span class=\"date-divider\">/</span>\n                            <a dir=\"ltr\" href=\"/news/tag/artificial-intelligence/\">\n                                #Artificial Intelligence\n                            </a>\n                        \n                    </section>\n                    <h1 class=\"post-full-title\" data-test-label=\"post-full-title\">Create a Self-Playing AI Chess Engine from Scratch with Imitation Learning</h1>\n                </header>\n                <div class=\"post-full-author-header\" data-test-label=\"author-header-no-bio\">\n                    \n                        \n                            \n    \n    \n    \n\n    <section class=\"author-card\" data-test-label=\"author-card\">\n        \n            \n    <img srcset=\"https://www.freecodecamp.org/news/content/images/size/w60/2023/09/Screenshot_20230816_114245_Gallery--5----Copy.jpg 60w\" sizes=\"60px\" src=\"https://www.freecodecamp.org/news/content/images/size/w60/2023/09/Screenshot_20230816_114245_Gallery--5----Copy.jpg\" class=\"author-profile-image\" alt=\"Eivind Kjosbakken\" width=\"920\" height=\"1725\" onerror=\"this.style.display='none'\" data-test-label=\"profile-image\">\n  \n        \n\n        <section class=\"author-card-content author-card-content-no-bio\">\n            <span class=\"author-card-name\">\n                <a href=\"/news/author/kjosbakken/\" data-test-label=\"profile-link\">\n                    \n                        Eivind Kjosbakken\n                    \n                </a>\n            </span>\n            \n        </section>\n    </section>\n\n                        \n                    \n                </div>\n                <figure class=\"post-full-image\">\n                    \n    <picture>\n      <source media=\"(max-width: 700px)\" sizes=\"1px\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 1w\">\n      <source media=\"(min-width: 701px)\" sizes=\"(max-width: 800px) 400px, (max-width: 1170px) 700px, 1400px\" srcset=\"https://www.freecodecamp.org/news/content/images/size/w300/2023/09/undraw_Programmer_re_owql.png 300w, https://www.freecodecamp.org/news/content/images/size/w600/2023/09/undraw_Programmer_re_owql.png 600w, https://www.freecodecamp.org/news/content/images/size/w1000/2023/09/undraw_Programmer_re_owql.png 1000w, https://www.freecodecamp.org/news/content/images/size/w2000/2023/09/undraw_Programmer_re_owql.png 2000w\">\n      <img onerror=\"this.style.display='none'\" src=\"https://www.freecodecamp.org/news/content/images/size/w2000/2023/09/undraw_Programmer_re_owql.png\" alt=\"Create a Self-Playing AI Chess Engine from Scratch with Imitation Learning\" ,=\"\" width=\"818\" height=\"738\" data-test-label=\"feature-image\">\n    </picture>\n  \n                </figure>\n                <section class=\"post-full-content\">\n                    <div class=\"post-and-sidebar\">\n                        <section class=\"post-content \" data-test-label=\"post-content\">\n                            \n<p>This is an article on how I created an AI chess engine, starting completely from scratch to building my very own AI chess engine. </p><p>Because creating an AI chess engine from scratch is a relatively complex task, this will be a long article, but stay tuned, as the product you will end up with will be a cool project to showcase!</p><h2 id=\"prerequisites\">Prerequisites</h2><p>This article will explain most concepts in detail. However, there are some recommended prerequisites to follow the tutorial. You should be familiar with the following:</p><ul><li>Python</li><li>How to use the terminal</li><li>Jupyter Notebook</li><li>Fundamental AI concepts</li><li>Chess rules</li></ul><p>I will also use the following tools:</p><ul><li>Python</li><li>Different Python packages</li><li>Stockfish</li></ul><h2 id=\"table-of-contents\">Table of Contents</h2><ul><li><a href=\"#part-1-how-to-generate-a-dataset\">Part 1 : How to Generate a Dataset</a></li><li><a href=\"#part-2-how-to-encode-data\">Part 2 : How to Encode data</a></li><li><a href=\"#part-3-how-to-train-the-ai-model\">Part 3: How to Train the AI model</a></li><li><a href=\"#conclusion\">Conclusion</a></li></ul><h2 id=\"part-1-how-to-generate-a-dataset\">Part 1: How to Generate a Dataset</h2><p>In this part, I will use Stockfish to generate a large dataset of moves from different positions. This data can then be used later on to train the chess AI.</p><h3 id=\"how-to-download-stockfish\">How to download Stockfish</h3><p>The most important component of my chess engine is Stockfish, so I will therefore show you how to install it. </p><p>Go to the <a href=\"https://stockfishchess.org/download/\" rel=\"noopener ugc nofollow noopener\">Stockfish website download page</a> and download the version for you. I am using Windows myself, so I chose the Windows (faster) version:</p><figure class=\"kg-card kg-image-card kg-width-wide kg-card-hascaption\"><img src=\"https://www.freecodecamp.org/news/content/images/2023/09/0_GxqQ42GNX21JB1GN.png\" class=\"kg-image\" alt=\"0_GxqQ42GNX21JB1GN\" srcset=\"https://www.freecodecamp.org/news/content/images/size/w600/2023/09/0_GxqQ42GNX21JB1GN.png 600w, https://www.freecodecamp.org/news/content/images/2023/09/0_GxqQ42GNX21JB1GN.png 700w\" width=\"700\" height=\"547\" loading=\"lazy\"><figcaption>Press the download button marked in red if you have a Windows PC</figcaption></figure><p>After downloading, extract the zip file to whatever location on your PC you want your chess engine to be. Remember where you place it as you need the path for the next step.</p><h3 id=\"how-to-incorporate-stockfish-with-python\">How to incorporate Stockfish with Python</h3><p>Now you also need to incorporate the engine into Python. You could manually do this, but I found it easier to use the <a href=\"https://pypi.org/project/stockfish/\" rel=\"noopener ugc nofollow noopener\">Python Stockfish package</a> as it has all the functions you need. </p><p>First install the package from <code>pip</code> (preferably in your virtual environment):</p><pre><code class=\"language-bash\">pip install stockfish\n</code></pre><p>You can then import it using the following command:</p><pre><code class=\"language-py\">from stockfish import Stockfish\nstockfish = Stockfish(path=r\"C:\\Users\\eivin\\Documents\\ownProgrammingProjects18062023\\ChessEngine\\stockfish\\stockfish\\stockfish-windows-2022-x86-64-avx2\")</code></pre><p>Note that you need to give your own path to the Stockfish executable file:</p><figure class=\"kg-card kg-image-card kg-width-wide kg-card-hascaption\"><img src=\"https://www.freecodecamp.org/news/content/images/2023/09/0_MSlKl_UJHCvdpje6.png\" class=\"kg-image\" alt=\"0_MSlKl_UJHCvdpje6\" srcset=\"https://www.freecodecamp.org/news/content/images/size/w600/2023/09/0_MSlKl_UJHCvdpje6.png 600w, https://www.freecodecamp.org/news/content/images/2023/09/0_MSlKl_UJHCvdpje6.png 643w\" width=\"643\" height=\"145\" loading=\"lazy\"><figcaption>The stockfish executable file is the second file from the bottom</figcaption></figure><p>You can copy the file path from the folder structure, or if you are on Windows 11 you can press ctrl + shift + c to automatically copy the file path.</p><p>Great! Now you have Stockfish available in Python!</p><h3 id=\"how-to-generate-a-dataset\">How to generate a dataset</h3><p>Now you need a dataset so you can train the AI chess engine! You can do this by making Stockfish play games and remembering each position and the moves you could take from there. </p><p>Those moves will be along the best possible moves, considering Stockfish is a strong chess engine.</p><p>First, install a <a href=\"https://pypi.org/project/chess/\" rel=\"noopener ugc nofollow noopener\">chess package</a> and NumPy (there are plenty to choose from, but I will be using the one below). </p><p>Enter each line (individually) in the terminal:</p><pre><code class=\"language-bash\">pip install chess\npip install numpy\n</code></pre><p>Then import packages (remember to also import Stockfish as shown earlier in this article):</p><pre><code class=\"language-py\">import chess\nimport random\nfrom pprint import pprint\nimport numpy as np\nimport os\nimport glob\nimport time\n</code></pre><p>You also need some helper functions here:</p><pre><code class=\"language-py\">#helper functions:\ndef checkEndCondition(board):\n if (board.is_checkmate() or board.is_stalemate() or board.is_insufficient_material() or board.can_claim_threefold_repetition() or board.can_claim_fifty_moves() or board.can_claim_draw()):\n  return True\n return False\n\n#save\ndef findNextIdx():\n files = (glob.glob(r\"C:\\Users\\eivin\\Documents\\ownProgrammingProjects18062023\\ChessEngine\\data\\*.npy\"))\n if (len(files) == 0):\n  return 1 #if no files, return 1\n highestIdx = 0\n for f in files:\n  file = f\n  currIdx = file.split(\"movesAndPositions\")[-1].split(\".npy\")[0]\n  highestIdx = max(highestIdx, int(currIdx))\n\n return int(highestIdx)+1\n\ndef saveData(moves, positions):\n moves = np.array(moves).reshape(-1, 1)\n positions = np.array(positions).reshape(-1,1)\n movesAndPositions = np.concatenate((moves, positions), axis = 1)\n nextIdx = findNextIdx()\n np.save(f\"data/movesAndPositions{nextIdx}.npy\", movesAndPositions)\n print(\"Saved successfully\")\n\ndef runGame(numMoves, filename = \"movesAndPositions1.npy\"):\n \"\"\"run a game you stored\"\"\"\n testing = np.load(f\"data/{filename}\")\n moves = testing[:, 0]\n if (numMoves &gt; len(moves)):\n  print(\"Must enter a lower number of moves than maximum game length. Game length here is: \", len(moves))\n  return\n\n testBoard = chess.Board()\n\n for i in range(numMoves):\n  move = moves[i]\n  testBoard.push_san(move)\n return testBoard</code></pre><p>Remember to change the file path in the <code>findNextIdx</code><em> </em>function, as this is personal for your computer. </p><p>Create a data folder within the folder you are coding, and copy the path (but still keep the <code>*.npy</code> at the end)</p><p>The <code>checkEndCondition</code><em> </em>function uses functions from the <a href=\"https://pypi.org/project/chess/\" rel=\"noopener ugc nofollow noopener\">Chess pip package</a> to check if the game is to be ended. </p><p>The <code>saveData</code><em> </em>function saves a game to npy files which is a highly optimized way of storing arrays. </p><p>The function uses the <code>findNextIdx</code><em> </em>function to save to a new file (remember here to create a new folder called data to store all data in). </p><p>Finally, the <code>runGame</code><em> </em>function makes it so you can run a game that you saved to check the positions after <code>numMoves</code><em> </em>number of moves.</p><p>Then you can finally get to the function that mines the chess games:</p><pre><code class=\"language-py\">def mineGames(numGames : int):\n \"\"\"mines numGames games of moves\"\"\"\n MAX_MOVES = 500 #don't continue games after this number\n\n for i in range(numGames):\n  currentGameMoves = []\n  currentGamePositions = []\n  board = chess.Board()\n  stockfish.set_position([])\n\n  for i in range(MAX_MOVES):\n   #randomly choose from those 3 moves\n   moves = stockfish.get_top_moves(3)\n   #if less than 3 moves available, choose first one, if none available, exit\n   if (len(moves) == 0):\n    print(\"game is over\")\n    break\n   elif (len(moves) == 1):\n    move = moves[0][\"Move\"]\n   elif (len(moves) == 2):\n    move = random.choices(moves, weights=(80, 20), k=1)[0][\"Move\"]\n   else:\n    move = random.choices(moves, weights=(80, 15, 5), k=1)[0][\"Move\"]\n\n   currentGamePositions.append(stockfish.get_fen_position())\n   board.push_san(move)\n   currentGameMoves.append(move)\n   stockfish.set_position(currentGameMoves)\n   if (checkEndCondition(board)):\n    print(\"game is over\")\n    break\n  saveData(currentGameMoves, currentGamePositions)</code></pre><p>Here you first set a max limit so a game does not last infinitely long. </p><p>Then, you run the number of games you want to run and make sure both Stockfish and the Chess pip package are reset to the starting position. </p><p>Next, you get the top 3 moves suggested by Stockfish and choose one of them to play (80 % change for the best move, 15 % change for the second best move, 5 % change for the third best move). The reason you are not always choosing the best move is for the move selection to be more stochastic. </p><p>Then, you choose a move (making sure no error occurs even if there are less than three possible moves), save the board position using <a href=\"https://en.wikipedia.org/wiki/Forsyth%E2%80%93Edwards_Notation#:~:text=Forsyth%E2%80%93Edwards%20Notation%20%28FEN%29,Scottish%20newspaper%20journalist%20David%20Forsyth.\" rel=\"noopener ugc nofollow noopener\">FEN</a> (a way of encoding a chess position), as well as the move done from that position. </p><p>If the game is done, you break the loop and store all positions and the moves made from those positions. If the game is not done, you continue making moves until the game is over.</p><p>You can then mine one game with:</p><pre><code class=\"language-py\">mineGames(1)\n</code></pre><p>Remember to create a data folder here, as this is where I store the games!</p><h3 id=\"how-to-review-a-mined-game\">How to review a mined game</h3><p>Run the <code>mineGames</code><em> </em>function to mine one game using the following command:</p><pre><code class=\"language-py\">mineGames(1)\n</code></pre><p>You can access this game with a helper function shown earlier using the following command:</p><pre><code class=\"language-py\">testBoard = runGame(12, \"movesAndPositions1.npy\")\ntestBoard\n</code></pre><p>Assuming there have been 12 moves in the game, you will then see something like this:</p><figure class=\"kg-card kg-image-card kg-width-wide kg-card-hascaption\"><img src=\"https://www.freecodecamp.org/news/content/images/2023/09/0_pjARgYsCMqZjj8lK.png\" class=\"kg-image\" alt=\"0_pjARgYsCMqZjj8lK\" width=\"339\" height=\"335\" loading=\"lazy\"><figcaption>Output from printing board position after 12 moves. (Note that the last line with just testBoard is printed, since in a Jupyter notebook, a variable is printed if it is written alone at the bottom of a cell).</figcaption></figure><p>And that’s it, you can now mine as many games as you would like. </p><p>It is going to take some time, and there are potentials for optimizing this mining process, such as parallelizing the game simulations (since each game is completely separate from the other). </p><p>For the full code from part 1, you can check out the full code on <a href=\"https://github.com/EivindKjosbakken/ChessEngine/blob/main/part1RetrievingDataset.ipynb\" rel=\"noopener ugc nofollow noopener\">my GitHub</a>.</p><h2 id=\"part-2-how-to-encode-data\">Part 2 : How to Encode Data</h2><p>In this part, you will encode chess moves and positions in the same way DeepMind did with AlphaZero!</p><p>I will use the data you gathered in part 1 of this series. </p><p>As a reminder, you installed Stockfish and made sure you could access it on the computer. You then made it play games against itself, while you stored all moves and positions. </p><p>You now have a supervised learning problem, since the input is the current position, and the label (the correct move from the positions) is the move that Stockfish decided was the best.</p><h3 id=\"how-to-install-and-import-packages\">How to install and import packages</h3><p>First, you need to install and import all required packages, some of which you may already have if you followed part 1 of this series. </p><p>All imports are below – remember to only input one line at a time when installing via <code>pip</code>:</p><pre><code class=\"language-bash\">pip install numpy\npip install gym-chess\npip install chess\n</code></pre><p>Additionally, you need to make a small change in one of the files in the gym-chess package since <code>np.int</code> was used, which is now deprecated. </p><p>In the file with the relative path (from the virtual environment) <code>venv\\Lib\\site-packages\\gym_chess\\alphazero\\board_encoding.py</code> where <code>venv</code><em> </em>is the name of my virtual environment, you have to search for \"np.int\" and replace them with \"int\".</p><p> If you don't, you will see an error message stating that np.int is deprecated. </p><p>I also had to restart VS Code after replacing \"np.int\" with \"int\", to make it work.</p><p>All imports you need are below:</p><pre><code class=\"language-py\">import numpy as np\nimport gym\nimport chess\nimport os\nimport gym.spaces\nfrom gym_chess.alphazero.move_encoding import utils, queenmoves, knightmoves, underpromotions\nfrom typing import List\n</code></pre><p>And then you also need to create the gym environment to encode and decode moves:</p><pre><code class=\"language-py\">env = gym.make('ChessAlphaZero-v0')\n</code></pre><h3 id=\"how-to-encode-board-positions-and-moves\">How to encode board positions and moves</h3><p>Encoding is an important element within AI, as it allows us to represent problems in a readable way for the AI. </p><p>Instead of an image of a chess board, or a string representing a chess move like \"d2d4\", you instead represent this using arrays (lists of numbers). </p><p>Finding out how to do this manually is quite challenging, but luckily for us, the <a href=\"https://pypi.org/project/gym-chess/\" rel=\"noopener ugc nofollow noopener\">gym-chess Python package</a> has already solved this problem for us.</p><p>I am not going to go into more details on how they encoded it, but you can see using the code below that a position is represented with an (8,8,119) shaped array, and all possible moves are given with a (4672) array (1 column with 4672 values).</p><p> If you want to read more about this, you can check out the <a href=\"https://arxiv.org/abs/1712.01815v1\" rel=\"noopener ugc nofollow noopener\">AlphaZero paper</a>, though this is quite a complicated paper to fully understand.</p><pre><code class=\"language-py\">#code to print action and state space\nenv = gym.make('ChessAlphaZero-v0')\nenv.reset()\nprint(env.observation_space)\nprint(env.action_space)\n</code></pre><p>Which outputs:</p><figure class=\"kg-card kg-image-card kg-width-wide kg-card-hascaption\"><img src=\"https://www.freecodecamp.org/news/content/images/2023/09/0_yDTpZm519oQl-fJm.png\" class=\"kg-image\" alt=\"0_yDTpZm519oQl-fJm\" width=\"439\" height=\"73\" loading=\"lazy\"><figcaption>Output from printing state (first line) and action space (second line)</figcaption></figure><p>You can also check out the encoding of a move. From string notation to encoded notation. Make sure to reset the environment as it may give an error if you do not:</p><pre><code class=\"language-py\">#first set the environment and make sure to reset the positions\nenv = gym.make('ChessAlphaZero-v0')\nenv.reset()\n\n#encoding the move e2 to e4\nmove = chess.Move.from_uci('e2e4')\nprint(env.encode(move))\n# -&gt; outputs: 877\n\n#decoding the encoded move 877\nprint(env.decode(877))\n# -&gt; outputs: Move.from_uci('e2e4')\n</code></pre><p>With this, you can now have functions to encode the moves and positions you stored from part 1 where you generated a dataset.</p><h3 id=\"how-to-create-functions-for-encoding-moves\">How to create functions for encoding moves</h3><p>These functions are copied from the <a href=\"https://pypi.org/project/gym-chess/\" rel=\"noopener ugc nofollow noopener\">Gym-Chess package</a>, but with small tweaks so it is not dependent on a class. </p><p>I manually changed these functions so that it was easier to encode. I would not worry too much about understanding these functions fully, as they are quite complicated. </p><p>Just know that they are a way of making sure moves that humans understand, are converted to a way that computers can understand.</p><pre><code class=\"language-py\">#fixing encoding funcs from openai\n\ndef encodeKnight(move: chess.Move):\n    _NUM_TYPES: int = 8\n\n    #: Starting point of knight moves in last dimension of 8 x 8 x 73 action array.\n    _TYPE_OFFSET: int = 56\n\n    #: Set of possible directions for a knight move, encoded as \n    #: (delta rank, delta square).\n    _DIRECTIONS = utils.IndexedTuple(\n        (+2, +1),\n        (+1, +2),\n        (-1, +2),\n        (-2, +1),\n        (-2, -1),\n        (-1, -2),\n        (+1, -2),\n        (+2, -1),\n    )\n\n    from_rank, from_file, to_rank, to_file = utils.unpack(move)\n\n    delta = (to_rank - from_rank, to_file - from_file)\n    is_knight_move = delta in _DIRECTIONS\n    \n    if not is_knight_move:\n        return None\n\n    knight_move_type = _DIRECTIONS.index(delta)\n    move_type = _TYPE_OFFSET + knight_move_type\n\n    action = np.ravel_multi_index(\n        multi_index=((from_rank, from_file, move_type)),\n        dims=(8, 8, 73)\n    )\n\n    return action\n\ndef encodeQueen(move: chess.Move):\n    _NUM_TYPES: int = 56 # = 8 directions * 7 squares max. distance\n    _DIRECTIONS = utils.IndexedTuple(\n        (+1,  0),\n        (+1, +1),\n        ( 0, +1),\n        (-1, +1),\n        (-1,  0),\n        (-1, -1),\n        ( 0, -1),\n        (+1, -1),\n    )\n\n    from_rank, from_file, to_rank, to_file = utils.unpack(move)\n\n    delta = (to_rank - from_rank, to_file - from_file)\n\n    is_horizontal = delta[0] == 0\n    is_vertical = delta[1] == 0\n    is_diagonal = abs(delta[0]) == abs(delta[1])\n    is_queen_move_promotion = move.promotion in (chess.QUEEN, None)\n\n    is_queen_move = (\n        (is_horizontal or is_vertical or is_diagonal) \n            and is_queen_move_promotion\n    )\n\n    if not is_queen_move:\n        return None\n\n    direction = tuple(np.sign(delta))\n    distance = np.max(np.abs(delta))\n\n    direction_idx = _DIRECTIONS.index(direction)\n    distance_idx = distance - 1\n\n    move_type = np.ravel_multi_index(\n        multi_index=([direction_idx, distance_idx]),\n        dims=(8,7)\n    )\n\n    action = np.ravel_multi_index(\n        multi_index=((from_rank, from_file, move_type)),\n        dims=(8, 8, 73)\n    )\n\n    return action\n\ndef encodeUnder(move):\n    _NUM_TYPES: int = 9 # = 3 directions * 3 piece types (see below)\n    _TYPE_OFFSET: int = 64\n    _DIRECTIONS = utils.IndexedTuple(\n        -1,\n        0,\n        +1,\n    )\n    _PROMOTIONS = utils.IndexedTuple(\n        chess.KNIGHT,\n        chess.BISHOP,\n        chess.ROOK,\n    )\n\n    from_rank, from_file, to_rank, to_file = utils.unpack(move)\n\n    is_underpromotion = (\n        move.promotion in _PROMOTIONS \n        and from_rank == 6 \n        and to_rank == 7\n    )\n\n    if not is_underpromotion:\n        return None\n\n    delta_file = to_file - from_file\n\n    direction_idx = _DIRECTIONS.index(delta_file)\n    promotion_idx = _PROMOTIONS.index(move.promotion)\n\n    underpromotion_type = np.ravel_multi_index(\n        multi_index=([direction_idx, promotion_idx]),\n        dims=(3,3)\n    )\n\n    move_type = _TYPE_OFFSET + underpromotion_type\n\n    action = np.ravel_multi_index(\n        multi_index=((from_rank, from_file, move_type)),\n        dims=(8, 8, 73)\n    )\n\n    return action\n\ndef encodeMove(move: str, board) -&gt; int:\n    move = chess.Move.from_uci(move)\n    if board.turn == chess.BLACK:\n        move = utils.rotate(move)\n\n    action = encodeQueen(move)\n\n    if action is None:\n        action = encodeKnight(move)\n\n    if action is None:\n        action = encodeUnder(move)\n\n    if action is None:\n        raise ValueError(f\"{move} is not a valid move\")\n\n    return action\n</code></pre><p>So now you can give in a move as a string (for example: \"e2e4\" for the move from e2 to e4), and it outputs a number (the encoded version of the move).</p><h3 id=\"how-to-create-a-function-for-encoding-positions\">How to create a function for encoding positions</h3><p>Encoding the positions is a bit more difficult. I took a function from the gym-chess package (\"encodeBoard\") since I had some issues using the package directly. The function I copied is below:</p><pre><code class=\"language-py\">def encodeBoard(board: chess.Board) -&gt; np.array:\n \"\"\"Converts a board to numpy array representation.\"\"\"\n\n array = np.zeros((8, 8, 14), dtype=int)\n\n for square, piece in board.piece_map().items():\n  rank, file = chess.square_rank(square), chess.square_file(square)\n  piece_type, color = piece.piece_type, piece.color\n \n  # The first six planes encode the pieces of the active player, \n  # the following six those of the active player's opponent. Since\n  # this class always stores boards oriented towards the white player,\n  # White is considered to be the active player here.\n  offset = 0 if color == chess.WHITE else 6\n  \n  # Chess enumerates piece types beginning with one, which you have\n  # to account for\n  idx = piece_type - 1\n \n  array[rank, file, idx + offset] = 1\n\n # Repetition counters\n array[:, :, 12] = board.is_repetition(2)\n array[:, :, 13] = board.is_repetition(3)\n\n return array\n\ndef encodeBoardFromFen(fen: str) -&gt; np.array:\n board = chess.Board(fen)\n return encodeBoard(board)</code></pre><p>I also added the <code>encodeBoardFromFen</code><em> </em>function, since the copied function required a chess board represented using the <a href=\"https://python-chess.readthedocs.io/en/latest/\" rel=\"noopener ugc nofollow noopener\">Python Chess package</a>, so I first convert from <a href=\"https://en.wikipedia.org/wiki/Forsyth%E2%80%93Edwards_Notation\" rel=\"noopener ugc nofollow noopener\">FEN-notation</a> (a way of encoding chess positions to a string – you cannot use this as you need the encoding to be in numbers) to a chess board given in that package.</p><p>Then you have all you need to encode all your files.</p><h3 id=\"how-to-automate-encoding-for-all-raw-data-files\">How to automate encoding for all raw data files</h3><p>Now that you can encode moves and positions, you will automate this process for all files in your folder that you generated from part 1 of this series. This involves finding all files in which you have to encode the data and saving these to new files.</p><p>Note that from part 1 I changed the folder structure slightly. </p><p>I now have a parent <code>Data</code><em> </em>folder, and within this folder, I have the <code>rawData</code>, which is the moves in string format and positions in FEN-format (from part 1).</p><p>I also have the <code>preparedData</code><em> </em>folder under the data folder, where the encoded moves and positions will be stored. </p><p>Note that the encoded moves and positions will be stored in separate files since the encodings have different dimensions.</p><figure class=\"kg-card kg-image-card kg-card-hascaption\"><img src=\"https://www.freecodecamp.org/news/content/images/2023/09/0_oiZbBdWwveJNMCPe.png\" class=\"kg-image\" alt=\"0_oiZbBdWwveJNMCPe\" width=\"109\" height=\"63\" loading=\"lazy\"><figcaption>Folder structure for the data. Make sure to have two folders called preparedData and rawData within the Data folder. The Data folder is on the same level as your notebook files.</figcaption></figure><pre><code class=\"language-py\">#function to encode all moves and positions from rawData folder\ndef encodeAllMovesAndPositions():\n    board = chess.Board() #this is used to change whose turn it is so that the encoding works\n    board.turn = False #set turn to black first, changed on first run\n\n    #find all files in folder:\n    files = os.listdir('data/rawData')\n    for idx, f in enumerate(files):\n        movesAndPositions = np.load(f'data/rawData/{f}', allow_pickle=True)\n        moves = movesAndPositions[:,0]\n        positions = movesAndPositions[:,1]\n        encodedMoves = []\n        encodedPositions = []\n\n        for i in range(len(moves)):\n            board.turn = (not board.turn) #swap turns\n            try:\n                encodedMoves.append(encodeMove(moves[i], board)) \n                encodedPositions.append(encodeBoardFromFen(positions[i]))\n            except:\n                try:\n                    board.turn = (not board.turn) #change turn, since you  skip moves sometimes, you  might need to change turn\n                    encodedMoves.append(encodeMove(moves[i], board)) \n                    encodedPositions.append(encodeBoardFromFen(positions[i]))\n                except:\n                    print(f'error in file: {f}')\n                    print(\"Turn: \", board.turn)\n                    print(moves[i])\n                    print(positions[i])\n                    print(i)\n                    break\n            \n        np.save(f'data/preparedData/moves{idx}', np.array(encodedMoves))\n        np.save(f'data/preparedData/positions{idx}', np.array(encodedPositions))\n    \nencodeAllMovesAndPositions()\n\n#NOTE: shape of files:\n#moves: (number of moves in gamew)\n#positions: (number of moves in game, 8, 8, 14) (number of moves in game is including both black and white moves)\n</code></pre><p>I first create the environment and reset it. </p><p>Then, I open all raw data files made from part 1 and encode this. I also do it in a <code>try/catch</code> statement, as I sometimes see errors with move encodings. </p><p>The first except statement is for if a move is skipped (so the program thinks it’s the wrong turn). If this happens, the encoding will not work, so the except statement changes the turn and tries again. This is not the most optimal code, but the encoding is a minor part of the total runtime to creating an AI chess engine, and it is therefore acceptable.</p><p>Make sure you have the correct folder structure and have created all the different folders. If not, you will receive an error.</p><p>You have now encoded your chess board and moves. If you want to, you can check out the full code from this part on <a href=\"https://github.com/EivindKjosbakken/ChessEngine/blob/main/part2Encoding.ipynb\" rel=\"noopener ugc nofollow noopener\">my GitHub</a>.</p><h2 id=\"part-3-how-to-train-the-ai-model\">Part 3: How to Train the AI model</h2><p>This is the third and last part in the for creating your own AI chess engine! </p><p>In part 1 you learned how to create a dataset, and in part 2 you looked at encoding the dataset so that it could be used for an AI. </p><p>You will now use this encoded dataset to train your own AI using PyTorch!</p><h3 id=\"how-to-import-packages\">How to import packages</h3><p>As always, you have all the imports that will be used in the tutorial. Most are straightforward, but you need to install PyTorch, which I recommend installing using <a href=\"https://pytorch.org/\" rel=\"noopener ugc nofollow noopener\">this website</a>. </p><p>Here you can scroll down a bit, where you see some options for which build and operating system you are on. </p><p>After selecting the options that apply to you, you will get some code you can paste into the terminal to install PyTorch. </p><p>You can see the options I chose in the image below, but in general, I recommend using the stable build and choosing your own operating system. </p><p>Then, select what package you are most used to (Conda or <code>pip</code> is probably the easiest as you can just paste it into the terminal). </p><p>Select CUDA 11.7/11.8 (does not matter which one), and install using the given command at the bottom.</p><figure class=\"kg-card kg-image-card kg-width-wide kg-card-hascaption\"><img src=\"https://www.freecodecamp.org/news/content/images/2023/09/0_UJVBkAt40X6-FXuV.png\" class=\"kg-image\" alt=\"0_UJVBkAt40X6-FXuV\" srcset=\"https://www.freecodecamp.org/news/content/images/size/w600/2023/09/0_UJVBkAt40X6-FXuV.png 600w, https://www.freecodecamp.org/news/content/images/2023/09/0_UJVBkAt40X6-FXuV.png 700w\" width=\"700\" height=\"272\" loading=\"lazy\"><figcaption>My selections when installing PyTorch.</figcaption></figure><p>You can then import all your packages with the code below:</p><pre><code class=\"language-py\">import numpy as np\nimport torch\nimport torch.nn as nn\nimport torch.functional as F\nimport torchvision\nimport torchvision.transforms as transforms\nfrom torch.utils.tensorboard import SummaryWriter\nfrom datetime import datetime\nimport gym\nimport gym_chess\nimport os\nimport chess\nfrom tqdm import tqdm\nfrom gym_chess.alphazero.move_encoding import utils\nfrom pathlib import Path\nfrom typing import Optional\n</code></pre><h3 id=\"how-to-install-cuda\">How to Install CUDA</h3><p>This is an optional step, that allows you to utilize your GPU to train your model much faster. It is not required, but will save you some time when training your AI. </p><p>The way you install CUDA varies depending on your operating system, but I am using Windows and followed <a href=\"https://docs.nvidia.com/cuda/cuda-installation-guide-microsoft-windows/index.html\" rel=\"noopener ugc nofollow noopener\">this tutorial</a>.</p><p>If you are on MacOS or Linux, then you can find a tutorial by googling: “installing CUDA Mac/Linux”.</p><p>To check if you have CUDA available (your GPU is available), you can use this code:</p><pre><code class=\"language-py\">#check if cuda available\ntorch.cuda.is_available()\n</code></pre><p>Which outputs <code>True</code> if your GPU is available. If you do not have a GPU available however, do not worry, the only downside here is training the model takes longer, which is not that big of a deal when doing hobby projects like this one.</p><h3 id=\"how-to-create-encoding-methods\">How to create encoding methods</h3><p>I then define some helper methods for encoding and decoding from the <a href=\"https://pypi.org/project/gym-chess/\" rel=\"noopener ugc nofollow noopener\">Python Gym-Chess package</a>. </p><p>I had to make some modifications to the package, to make it work. Most of the code is copied from the package, with just a few small tweaks making the code not dependent on a class and so forth. </p><p>Note that you do not have to understand all the code below, as the way Deepmind encodes all moves in chess is complicated.</p><pre><code class=\"language-py\">#helper methods:\n\n#decoding moves from idx to uci notation\ndef _decodeKnight(action: int) -&gt; Optional[chess.Move]:\n    _NUM_TYPES: int = 8\n\n    #: Starting point of knight moves in last dimension of 8 x 8 x 73 action array.\n    _TYPE_OFFSET: int = 56\n\n    #: Set of possible directions for a knight move, encoded as \n    #: (delta rank, delta square).\n    _DIRECTIONS = utils.IndexedTuple(\n        (+2, +1),\n        (+1, +2),\n        (-1, +2),\n        (-2, +1),\n        (-2, -1),\n        (-1, -2),\n        (+1, -2),\n        (+2, -1),\n    )\n\n    from_rank, from_file, move_type = np.unravel_index(action, (8, 8, 73))\n\n    is_knight_move = (\n        _TYPE_OFFSET &lt;= move_type\n        and move_type &lt; _TYPE_OFFSET + _NUM_TYPES\n    )\n\n    if not is_knight_move:\n        return None\n\n    knight_move_type = move_type - _TYPE_OFFSET\n\n    delta_rank, delta_file = _DIRECTIONS[knight_move_type]\n\n    to_rank = from_rank + delta_rank\n    to_file = from_file + delta_file\n\n    move = utils.pack(from_rank, from_file, to_rank, to_file)\n    return move\n\ndef _decodeQueen(action: int) -&gt; Optional[chess.Move]:\n\n    _NUM_TYPES: int = 56 # = 8 directions * 7 squares max. distance\n\n    #: Set of possible directions for a queen move, encoded as \n    #: (delta rank, delta square).\n    _DIRECTIONS = utils.IndexedTuple(\n        (+1,  0),\n        (+1, +1),\n        ( 0, +1),\n        (-1, +1),\n        (-1,  0),\n        (-1, -1),\n        ( 0, -1),\n        (+1, -1),\n    )\n    from_rank, from_file, move_type = np.unravel_index(action, (8, 8, 73))\n    \n    is_queen_move = move_type &lt; _NUM_TYPES\n\n    if not is_queen_move:\n        return None\n\n    direction_idx, distance_idx = np.unravel_index(\n        indices=move_type,\n        shape=(8,7)\n    )\n\n    direction = _DIRECTIONS[direction_idx]\n    distance = distance_idx + 1\n\n    delta_rank = direction[0] * distance\n    delta_file = direction[1] * distance\n\n    to_rank = from_rank + delta_rank\n    to_file = from_file + delta_file\n\n    move = utils.pack(from_rank, from_file, to_rank, to_file)\n    return move\n\ndef _decodeUnderPromotion(action):\n    _NUM_TYPES: int = 9 # = 3 directions * 3 piece types (see below)\n\n    #: Starting point of underpromotions in last dimension of 8 x 8 x 73 action \n    #: array.\n    _TYPE_OFFSET: int = 64\n\n    #: Set of possibel directions for an underpromotion, encoded as file delta.\n    _DIRECTIONS = utils.IndexedTuple(\n        -1,\n        0,\n        +1,\n    )\n\n    #: Set of possibel piece types for an underpromotion (promoting to a queen\n    #: is implicitly encoded by the corresponding queen move).\n    _PROMOTIONS = utils.IndexedTuple(\n        chess.KNIGHT,\n        chess.BISHOP,\n        chess.ROOK,\n    )\n\n    from_rank, from_file, move_type = np.unravel_index(action, (8, 8, 73))\n\n    is_underpromotion = (\n        _TYPE_OFFSET &lt;= move_type\n        and move_type &lt; _TYPE_OFFSET + _NUM_TYPES\n    )\n\n    if not is_underpromotion:\n        return None\n\n    underpromotion_type = move_type - _TYPE_OFFSET\n\n    direction_idx, promotion_idx = np.unravel_index(\n        indices=underpromotion_type,\n        shape=(3,3)\n    )\n\n    direction = _DIRECTIONS[direction_idx]\n    promotion = _PROMOTIONS[promotion_idx]\n\n    to_rank = from_rank + 1\n    to_file = from_file + direction\n\n    move = utils.pack(from_rank, from_file, to_rank, to_file)\n    move.promotion = promotion\n\n    return move\n\n#primary decoding function, the ones above are just helper functions\ndef decodeMove(action: int, board) -&gt; chess.Move:\n        move = _decodeQueen(action)\n        is_queen_move = move is not None\n\n        if not move:\n            move = _decodeKnight(action)\n\n        if not move:\n            move = _decodeUnderPromotion(action)\n\n        if not move:\n            raise ValueError(f\"{action} is not a valid action\")\n\n        # Actions encode moves from the perspective of the current player. If\n        # this is the black player, the move must be reoriented.\n        turn = board.turn\n        \n        if turn == False: #black to move\n            move = utils.rotate(move)\n\n        # Moving a pawn to the opponent's home rank with a queen move\n        # is automatically assumed to be queen underpromotion. However,\n        # since queenmoves has no reference to the board and can thus not\n        # determine whether the moved piece is a pawn, you have to add this\n        # information manually here\n        if is_queen_move:\n            to_rank = chess.square_rank(move.to_square)\n            is_promoting_move = (\n                (to_rank == 7 and turn == True) or \n                (to_rank == 0 and turn == False)\n            )\n\n            piece = board.piece_at(move.from_square)\n            if piece is None: #NOTE I added this, not entirely sure if it's correct\n                return None\n            is_pawn = piece.piece_type == chess.PAWN\n\n            if is_pawn and is_promoting_move:\n                move.promotion = chess.QUEEN\n\n        return move\n\ndef encodeBoard(board: chess.Board) -&gt; np.array:\n \"\"\"Converts a board to numpy array representation.\"\"\"\n\n array = np.zeros((8, 8, 14), dtype=int)\n\n for square, piece in board.piece_map().items():\n  rank, file = chess.square_rank(square), chess.square_file(square)\n  piece_type, color = piece.piece_type, piece.color\n \n  # The first six planes encode the pieces of the active player, \n  # the following six those of the active player's opponent. Since\n  # this class always stores boards oriented towards the white player,\n  # White is considered to be the active player here.\n  offset = 0 if color == chess.WHITE else 6\n  \n  # Chess enumerates piece types beginning with one, which you have\n  # to account for\n  idx = piece_type - 1\n \n  array[rank, file, idx + offset] = 1\n\n # Repetition counters\n array[:, :, 12] = board.is_repetition(2)\n array[:, :, 13] = board.is_repetition(3)\n\n return array\n </code></pre><h3 id=\"how-to-load-the-data\">How to load the data</h3><p>In part 1, you mined some chess games, and then in part 2, you encoded it so that it could be used to train a model. </p><p>You now load this data in PyTorch data loader objects, so it’s available for the model to train on. In case you have not done part 1 or 2 of this tutorial, you can find some ready-made training files in <a href=\"https://drive.google.com/drive/folders/16QLJL2LQcz5hiONJnvuJwtUJqz6v-sN5?usp=sharing\" rel=\"noopener ugc nofollow noopener\">this Google Drive folder.</a></p><p>First, define some hyperparameters:</p><pre><code class=\"language-py\">FRACTION_OF_DATA = 1\nBATCH_SIZE = 4\n</code></pre><p>The <code>FRACTION_OF_DATA</code> variable, is there just in case you want to train the model fast and do not want to train it on the full dataset. Make sure this value is &gt; 0 and ≤ 1. </p><p>The <code>BATCH_SIZE</code> variable decides the batch size the model trains on. In general, a higher batch size means the model can train faster, but your batch size is limited by the power of your GPU. </p><p>I recommend testing with a low batch size of 4 and then trying to increase it and see if training still works as it should. If you get a memory error of some sort, try decreasing the batch size again.</p><p>You then load the data with the code below. Make sure your folder structure and file naming is correct here. You should have an initial data folder in the same place where your code is. </p><p>Then inside this data folder, you should have a <code>preparedData</code><em> </em>folder, that contains the files you want to train on. These files have to be named <code>moves{i}.npy</code> and <code>positions{i}.npy</code>, where i is the index of the file. If you encoded the files as I did earlier, everything should be correct.</p><figure class=\"kg-card kg-image-card kg-width-wide kg-card-hascaption\"><img src=\"https://www.freecodecamp.org/news/content/images/2023/09/0_3LT9odIm09DPFS59.png\" class=\"kg-image\" alt=\"0_3LT9odIm09DPFS59\" width=\"441\" height=\"462\" loading=\"lazy\"><figcaption>The folder structure. Yellow are folders, and turquoise are files.</figcaption></figure><pre><code class=\"language-py\">#dataset\n\n#loading training data\n\nallMoves = []\nallBoards = []\n\nfiles = os.listdir('data/preparedData')\nnumOfEach = len(files) // 2 # half are moves, other half are positions\n\nfor i in range(numOfEach):\n    try:\n        moves = np.load(f\"data/preparedData/moves{i}.npy\", allow_pickle=True)\n        boards = np.load(f\"data/preparedData/positions{i}.npy\", allow_pickle=True)\n        if (len(moves) != len(boards)):\n            print(\"ERROR ON i = \", i, len(moves), len(boards))\n        allMoves.extend(moves)\n        allBoards.extend(boards)\n    except:\n        print(\"error: could not load \", i, \", but is still going\")\n\nallMoves = np.array(allMoves)[:(int(len(allMoves) * FRACTION_OF_DATA))]\nallBoards = np.array(allBoards)[:(int(len(allBoards) * FRACTION_OF_DATA))]\nassert len(allMoves) == len(allBoards), \"MUST BE OF SAME LENGTH\"\n\n#flatten out boards\n# allBoards = allBoards.reshape(allBoards.shape[0], -1)\n\ntrainDataIdx = int(len(allMoves) * 0.8)\n\n#NOTE transfer all data to GPU if available\ndevice = torch.device(\"cuda:0\" if torch.cuda.is_available() else \"cpu\")\nallBoards = torch.from_numpy(np.asarray(allBoards)).to(device)\nallMoves = torch.from_numpy(np.asarray(allMoves)).to(device)\n\ntraining_set = torch.utils.data.TensorDataset(allBoards[:trainDataIdx], allMoves[:trainDataIdx])\ntest_set = torch.utils.data.TensorDataset(allBoards[trainDataIdx:], allMoves[trainDataIdx:])\n# Create data loaders for your datasets; shuffle for training, not for validation\n\ntraining_loader = torch.utils.data.DataLoader(training_set, batch_size=BATCH_SIZE, shuffle=True)\nvalidation_loader = torch.utils.data.DataLoader(test_set, batch_size=BATCH_SIZE, shuffle=False)\n</code></pre><h3 id=\"how-to-define-the-deep-learning-model\">How to define the deep learning model</h3><p>You can then define the model architecture:</p><pre><code class=\"language-py\">class Model(torch.nn.Module):\n\n    def __init__(self):\n        super(Model, self).__init__()\n        self.INPUT_SIZE = 896 \n        # self.INPUT_SIZE = 7*7*13 #NOTE changing input size for using cnns\n        self.OUTPUT_SIZE = 4672 # = number of unique moves (action space)\n        \n        #can try to add CNN and pooling here (calculations taking into account spacial features)\n\n        #input shape for sample is (8,8,14), flattened to 1d array of size 896\n        # self.cnn1 = nn.Conv3d(4,4,(2,2,4), padding=(0,0,1))\n        self.activation = torch.nn.ReLU()\n        self.linear1 = torch.nn.Linear(self.INPUT_SIZE, 1000)\n        self.linear2 = torch.nn.Linear(1000, 1000)\n        self.linear3 = torch.nn.Linear(1000, 1000)\n        self.linear4 = torch.nn.Linear(1000, 200)\n        self.linear5 = torch.nn.Linear(200, self.OUTPUT_SIZE)\n        self.softmax = torch.nn.Softmax(1) #use softmax as prob for each move, dim 1 as dim 0 is the batch dimension\n \n    def forward(self, x): #x.shape = (batch size, 896)\n        x = x.to(torch.float32)\n        # x = self.cnn1(x) #for using cnns\n        x = x.reshape(x.shape[0], -1)\n        x = self.linear1(x)\n        x = self.activation(x)\n        x = self.linear2(x)\n        x = self.activation(x)\n        x = self.linear3(x)\n        x = self.activation(x)\n        x = self.linear4(x)\n        x = self.activation(x)\n        x = self.linear5(x)\n        # x = self.softmax(x) #do not use softmax since you are using cross entropy loss\n        return x\n\n    def predict(self, board : chess.Board):\n        \"\"\"takes in a chess board and returns a chess.move object. NOTE: this function should definitely be written better, but it works for now\"\"\"\n        with torch.no_grad():\n            encodedBoard = encodeBoard(board)\n            encodedBoard = encodedBoard.reshape(1, -1)\n            encodedBoard = torch.from_numpy(encodedBoard)\n            res = self.forward(encodedBoard)\n            probs = self.softmax(res)\n\n            probs = probs.numpy()[0] #do not want tensor anymore, 0 since it is a 2d array with 1 row\n\n            #verify that move is legal and can be decoded before returning\n            while len(probs) &gt; 0: #try max 100 times, if not throw an error\n                moveIdx = probs.argmax()\n                try: #TODO should not have try here, but was a bug with idx 499 if it is black to move\n                    uciMove = decodeMove(moveIdx, board)\n                    if (uciMove is None): #could not decode\n                        probs = np.delete(probs, moveIdx)\n                        continue\n                    move = chess.Move.from_uci(str(uciMove))\n                    if (move in board.legal_moves): #if legal, return, else: loop continues after deleting the move\n                        return move \n                except:\n                    pass\n                probs = np.delete(probs, moveIdx) #TODO probably better way to do this, but it is not too time critical as it is only for predictions\n                                             #remove the move so its not chosen again next iteration\n            \n            #TODO can return random move here as well!\n            return None #if no legal moves found, return None</code></pre><p>You are free to change the architecture however you like. </p><p>Here, I have just chosen some simple parameters that worked decently, though there is room for improvement. Some examples of changes you can make are:</p><ol><li>Add <a href=\"https://pytorch.org/docs/stable/generated/torch.nn.Conv2d.html\" rel=\"noopener ugc nofollow noopener\">PyTorch CNN modules</a> (remember to not flatten the array before adding these)</li><li>Change the activation functions in hidden layers. I am now using <a href=\"https://pytorch.org/docs/stable/generated/torch.nn.ReLU.html\" rel=\"noopener ugc nofollow noopener\">ReLU</a>, but this could be changed to for example Sigmoid or Tanh, which you can read more about <a href=\"https://machinelearningmastery.com/choose-an-activation-function-for-deep-learning/\" rel=\"noopener ugc nofollow noopener\">here</a>.</li><li>Change the number of hidden layers. When changing this, you must remember to add an activation function between each layer in the <code>forward()</code> function.</li><li>Change the number of neurons in each hidden layer. If you are going to change the number of neurons, you must remember the rule that the number of neurons out in layer n, should be the neurons in, in layer n+1. So for example, linear1 takes in 1000 neurons, and outputs 2000 neurons. Then linear2 must take in 2000 neurons. You can then freely choose the number of output neurons on linear2, but the amount must match the number of input neurons in linear 3, and so on. The input to layer 1 and the output from the last layer however are set with the parameters <code>INPUT_SIZE</code>, and <code>OUTPUT_SIZE</code>.</li></ol><p>In addition to the model architecture and forward functions, which are obligatory when creating a deep model, &nbsp;I also defined a <code>predict()</code> function, to make it easier to give a chess position to the model, and then it outputs the move it recommends.</p><h3 id=\"how-to-train-the-model\">How to train the model</h3><p>When you have all the required data and the model is defined, you can begin training the model. First, you define a function to train one epoch and save the best model:</p><pre><code class=\"language-py\">#helper functions for training\ndef train_one_epoch(model, optimizer, loss_fn, epoch_index, tb_writer):\n    running_loss = 0.\n    last_loss = 0.\n\n    # Here, you use enumerate(training_loader) instead of\n    # iter(training_loader) so that you can track the batch\n    # index and do some intra-epoch reporting\n    for i, data in enumerate(training_loader):\n\n        # Every data instance is an input + label pair\n        inputs, labels = data\n\n        # Zero your gradients for every batch!\n        optimizer.zero_grad()\n\n        # Make predictions for this batch\n        outputs = model(inputs)\n\n        # Compute the loss and its gradients\n        loss = loss_fn(outputs, labels)\n        loss.backward()\n\n        # Adjust learning weights\n        optimizer.step()\n\n        # Gather data and report\n        running_loss += loss.item()\n        if i % 1000 == 999:\n            last_loss = running_loss / 1000 # loss per batch\n            # print('  batch {} loss: {}'.format(i + 1, last_loss))\n            tb_x = epoch_index * len(training_loader) + i + 1\n            tb_writer.add_scalar('Loss/train', last_loss, tb_x)\n            running_loss = 0.\n\n    return last_loss\n\n#the 3 functions below help store the best model you have created yet\ndef createBestModelFile():\n    #first find best model if it exists:\n    folderPath = Path('./savedModels')\n    if (not folderPath.exists()):\n        os.mkdir(folderPath)\n\n    path = Path('./savedModels/bestModel.txt')\n\n    if (not path.exists()):\n        #create the files\n        f = open(path, \"w\")\n        f.write(\"10000000\") #set to high number so it is overwritten with better loss\n        f.write(\"\\ntestPath\")\n        f.close()\n\ndef saveBestModel(vloss, pathToBestModel):\n    f = open(\"./savedModels/bestModel.txt\", \"w\")\n    f.write(str(vloss.item()))\n    f.write(\"\\n\")\n    f.write(pathToBestModel)\n    print(\"NEW BEST MODEL FOUND WITH LOSS:\", vloss)\n\ndef retrieveBestModelInfo():\n    f = open('./savedModels/bestModel.txt', \"r\")\n    bestLoss = float(f.readline())\n    bestModelPath = f.readline()\n    f.close()\n    return bestLoss, bestModelPath\n</code></pre><p>Note that this function is essentially copied from the <a href=\"https://pytorch.org/tutorials/beginner/introyt/trainingyt.html\" rel=\"noopener ugc nofollow noopener\">PyTorch docs</a>, with a slight change by importing the model, optimizer, and loss function as function parameters.</p><p>You then define the hyperparameters like below. Note that this is something you can tune, to further improve your model.</p><pre><code class=\"language-py\">#hyperparameters\nEPOCHS = 60\nLEARNING_RATE = 0.001\nMOMENTUM = 0.9\n</code></pre><p>Run the training with the code below:</p><pre><code class=\"language-py\">#run training\n\ncreateBestModelFile()\n\nbestLoss, bestModelPath = retrieveBestModelInfo()\n\ntimestamp = datetime.now().strftime('%Y%m%d_%H%M%S')\nwriter = SummaryWriter('runs/fashion_trainer_{}'.format(timestamp))\nepoch_number = 0\n\nmodel = Model()\nloss_fn = torch.nn.CrossEntropyLoss()\noptimizer = torch.optim.SGD(model.parameters(), lr=LEARNING_RATE, momentum=MOMENTUM)\ndevice = torch.device(\"cuda:0\" if torch.cuda.is_available() else \"cpu\")\nmodel.to(device)\n\nbest_vloss = 1_000_000.\n\nfor epoch in tqdm(range(EPOCHS)):\n    if (epoch_number % 5 == 0):\n        print('EPOCH {}:'.format(epoch_number + 1))\n\n    # Make sure gradient tracking is on, and do a pass over the data\n    model.train(True)\n    avg_loss = train_one_epoch(model, optimizer, loss_fn, epoch_number, writer)\n\n    running_vloss = 0.0\n    # Set the model to evaluation mode, disabling dropout and using population\n    # statistics for batch normalization.\n\n    model.eval()\n\n    # Disable gradient computation and reduce memory consumption.\n    with torch.no_grad():\n        for i, vdata in enumerate(validation_loader):\n            vinputs, vlabels = vdata\n            voutputs = model(vinputs)\n\n            vloss = loss_fn(voutputs, vlabels)\n            running_vloss += vloss\n\n    avg_vloss = running_vloss / (i + 1)\n\n    #only print every 5 epochs\n    if epoch_number % 5 == 0:\n        print('LOSS train {} valid {}'.format(avg_loss, avg_vloss))\n\n    # Log the running loss averaged per batch\n    # for both training and validation\n    writer.add_scalars('Training vs. Validation Loss',\n                    { 'Training' : avg_loss, 'Validation' : avg_vloss },\n                    epoch_number + 1)\n    writer.flush()\n\n    # Track best performance, and save the model's state\n    if avg_vloss &lt; best_vloss:\n        best_vloss = avg_vloss\n\n        if (bestLoss &gt; best_vloss): #if better than previous best loss from all models created, save it\n            model_path = 'savedModels/model_{}_{}'.format(timestamp, epoch_number)\n            torch.save(model.state_dict(), model_path)\n            saveBestModel(best_vloss, model_path)\n\n    epoch_number += 1\n\nprint(\"\\n\\nBEST VALIDATION LOSS FOR ALL MODELS: \", bestLoss)\n</code></pre><p>This code is also heavily inspired by the <a href=\"https://pytorch.org/tutorials/beginner/introyt/trainingyt.html\" rel=\"noopener ugc nofollow noopener\">PyTorch docs.</a></p><p>Depending on the number of layers in your model, the number of neurons in the layers, the number of epochs, if you are using GPU or not, and several other factors, your time to train the model can take anywhere from seconds, to several hours. </p><p>As you can see below, the estimated time to train my model here was about 2 minutes.</p><figure class=\"kg-card kg-image-card kg-width-wide kg-card-hascaption\"><img src=\"https://www.freecodecamp.org/news/content/images/2023/09/0_-JEKRkXNUxXy4CYh.gif\" class=\"kg-image\" alt=\"0_-JEKRkXNUxXy4CYh\" width=\"628\" height=\"267\" loading=\"lazy\"><figcaption>Video of the model training. Recorded using <a href=\"https://www.cockos.com/licecap/\" rel=\"noopener ugc nofollow noopener noopener\">LICEcap</a></figcaption></figure><h3 id=\"how-to-test-your-model\">How to test your model</h3><p>Testing your model is a vital part of checking if what you created works. I have implemented two ways of checking the model:</p><h4 id=\"yourself-vs-ai\">Yourself vs AI</h4><p>The first way is to play yourself against the AI. Here you decide a move, then you let the AI decide the move, and so on. I recommend doing this in a notebook, so you can run different cells for different actions.</p><p>First, load a model that was saved from training. Here, I get the path to the file from the file created when running training, that stores the path to your best model. You can of course also manually change the path to the model you prefer to use.</p><pre><code class=\"language-py\">saved_model = Model()\n\n#load best model path from your file\nf = open(\"./savedModels/bestModel.txt\", \"r\")\nbestLoss = float(f.readline())\nmodel_path = f.readline()\nf.close()\n\nmodel.load_state_dict(torch.load(model_path))\n</code></pre><p>Then, define the chess board:</p><pre><code class=\"language-py\">#play your own game\nboard = chess.Board()\n</code></pre><p>Then you can make a move by running the code in the cell below by changing the string in the first line. Make sure it is a legal move:</p><pre><code class=\"language-py\">moveStr = \"e2e4\"\nmove = chess.Move.from_uci(moveStr)\nboard.push(move)\n</code></pre><p>Then you can let the AI decide the next move with the cell below:</p><pre><code class=\"language-py\">#make ai move:\naiMove = saved_model.predict(board)\nboard.push(aiMove)\nboard\n</code></pre><p>This will also print the board state so you can decide your own move more easily:</p><figure class=\"kg-card kg-image-card kg-width-wide kg-card-hascaption\"><img src=\"https://www.freecodecamp.org/news/content/images/2023/09/0_mkYWyk2zoU01fyEj.png\" class=\"kg-image\" alt=\"0_mkYWyk2zoU01fyEj\" width=\"286\" height=\"290\" loading=\"lazy\"><figcaption>Printing the board state after the AI makes a move</figcaption></figure><p>Continue making every other move, let the AI play every other move, and see who wins!</p><p>If you want to regret a move, you can use:</p><pre><code class=\"language-py\">#regret move:\nboard.pop()\n</code></pre><h4 id=\"stockfish-vs-your-ai\">Stockfish vs your AI</h4><p>You can also automate the testing process, by setting Stockfish to a specific ELO, and letting your AI play against it:</p><p>First, load your model (make sure to change the <code>model_path</code> to your own model):</p><pre><code class=\"language-py\">saved_model = Model()\nmodel_path = \"savedModels/model_20230702_150228_46\" #TODO CHANGE THIS PATH\nmodel.load_state_dict(torch.load(model_path))\n</code></pre><p>Then import Stockfish, and set it to a specific ELO. Remember to change the path to the Stockfish engine to your own path where you have the Stockfish program):</p><pre><code class=\"language-py\"># test elo  against stockfish\nELO_RATING = 500\nfrom stockfish import Stockfish\n#TODO CHANGE PATH BELOW\nstockfish = Stockfish(path=r\"C:\\Users\\eivin\\Documents\\ownProgrammingProjects18062023\\ChessEngine\\stockfish\\stockfish\\stockfish-windows-2022-x86-64-avx2\")\nstockfish.set_elo_rating(ELO_RATING)\n</code></pre><p>A 100 ELO rating is quite bad, and something your engine will hopefully beat.</p><p>Then play the game with this script, which will run:</p><pre><code class=\"language-py\">board = chess.Board()\nallMoves = [] #list of strings for saving moves for setting pos for stockfish\n\nMAX_NUMBER_OF_MOVES = 150\nfor i in range(MAX_NUMBER_OF_MOVES): #set a limit for the game\n\n #first my ai move\n try:\n  move = saved_model.predict(board)\n  board.push(move)\n  allMoves.append(str(move)) #add so stockfish can see\n except:\n  print(\"game over. You lost\")\n  break\n\n # #then get stockfish move\n stockfish.set_position(allMoves)\n stockfishMove = stockfish.get_best_move_time(3)\n allMoves.append(stockfishMove)\n stockfishMove = chess.Move.from_uci(stockfishMove)\n board.push(stockfishMove)\n\nstockfish.reset_engine_parameters() #reset elo rating\n\nboard\n</code></pre><p>Which will print the board position after the game is over.</p><figure class=\"kg-card kg-image-card kg-width-wide kg-card-hascaption\"><img src=\"https://www.freecodecamp.org/news/content/images/2023/09/0_TmLzgIp2R5_bNyy7.png\" class=\"kg-image\" alt=\"0_TmLzgIp2R5_bNyy7\" width=\"355\" height=\"385\" loading=\"lazy\"><figcaption>Position after your chess engine lost a game to Stockfish</figcaption></figure><h3 id=\"reflection-on-the-performance-of-the-chess-engine\">Reflection on the performance of the chess engine</h3><p>I tried training the model on about 100k positions and moves and discovered that the performance of the model still is not enough to beat a low-level (500 ELO) chess bot. </p><p>There could be several reasons for this. Chess is a highly complicated game, that probably requires a lot more moves and positions for a decent bot to be developed.</p><p>Furthermore, there are several elements of the bot you change potentially change to improve it. The architecture can be improved, for example by adding a CNN at the beginning of the forward function, so that the bot takes in spatial information.</p><p> You can also change the number of hidden layers in the fully connected layers, or the amount of neurons in each layer. </p><p>A safe way to further improve the model is to feed it more data, as you have access to an infinite amount of data by using the mining code in <a href=\"https://medium.com/dev-genius/creating-an-ai-chess-engine-using-imitation-learning-part-1-generating-dataset-8033d9e7f7dc\" rel=\"noopener\">this article</a>. </p><p>Additionally, I think this shows that an imitation learning chess engine either needs a lot of data or training a chess engine solely from imitation learning might not be an optimal idea. </p><p>Still, imitation learning can be used as part of a chess engine, for example, if you also implement traditional searching methods, and add imitation learning on top of it.</p><h2 id=\"conclusion\">Conclusion</h2><p>Congrats! You have now made your own AI chess engine from scratch, and I hope you learned something along the way. You can constantly make this engine better if you want to improve it, and make sure it beats better and better competition.</p><p>If you want to full code, check out <a href=\"https://github.com/EivindKjosbakken/ChessEngine/blob/main/part3Training.ipynb\" rel=\"noopener ugc nofollow noopener\">my GitHub</a>.</p><p>This tutorial was originally written part by part on my Medium, you can check out each part here:</p><ul><li><a href=\"https://medium.com/dev-genius/creating-an-ai-chess-engine-using-imitation-learning-part-1-generating-dataset-8033d9e7f7dc\"></a><a href=\"https://medium.com/dev-genius/creating-an-ai-chess-engine-using-imitation-learning-part-1-generating-dataset-8033d9e7f7dc\">P</a><a href=\"https://medium.com/dev-genius/creating-an-ai-chess-engine-using-imitation-learning-part-1-generating-dataset-8033d9e7f7dc\">art 1</a>: Generating the dataset</li><li><a href=\"https://medium.com/dev-genius/creating-an-ai-chess-engine-part-2-encoding-using-the-alphazero-method-63c3c3c3a960\"></a><a href=\"https://medium.com/dev-genius/creating-an-ai-chess-engine-part-2-encoding-using-the-alphazero-method-63c3c3c3a960\">Part 2</a>: Encoding with the AlphaZero method</li><li><a href=\"https://python.plainenglish.io/learn-how-to-train-your-awesome-self-playing-ai-chess-engine-77a46633a949\"></a><a href=\"https://python.plainenglish.io/learn-how-to-train-your-awesome-self-playing-ai-chess-engine-77a46633a949\">Part 3</a>: Training the model</li></ul><p>If you are interested and want to learn more about similar topics, you can find me on:</p><ul><li><a href=\"https://medium.com/@oieivind\">✅ Medium</a></li><li><a href=\"https://twitter.com/Ravenspike21\"></a><a href=\"https://twitter.com/Ravenspike21\">✅</a> <a href=\"https://twitter.com/Ravenspike21\">Twitter</a></li><li><a href=\"https://www.linkedin.com/in/eivind-kjosbakken/\"></a><a href=\"https://www.linkedin.com/in/eivind-kjosbakken/\"></a><a href=\"https://twitter.com/Ravenspike21\">✅</a><a href=\"https://www.linkedin.com/in/eivind-kjosbakken/\"> </a><a href=\"https://twitter.com/Ravenspike21\">L</a>inkedIn</li></ul>\n\n                        </section>\n                        \n                            <div class=\"sidebar\">\n                                \n                                    \n                                        <div class=\"ad-wrapper\" data-test-label=\"ad-wrapper\">\n    \n    <div class=\"ad-text\" data-test-label=\"ad-text\">ADVERTISEMENT</div>\n    <ins class=\"adsbygoogle\" style=\"display: block; height: 280px;\" data-ad-client=\"ca-pub-9482786369113753\" data-ad-slot=\"5720086888\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins>\n    <script>\n        (adsbygoogle = window.adsbygoogle || []).push({});\n    </script>\n</div>\n\n                                    \n                                        <div class=\"ad-wrapper\" data-test-label=\"ad-wrapper\">\n    \n    <div class=\"ad-text\" data-test-label=\"ad-text\">ADVERTISEMENT</div>\n    <ins class=\"adsbygoogle\" style=\"display: block; height: 280px;\" data-ad-client=\"ca-pub-9482786369113753\" data-ad-slot=\"5720086888\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins>\n    <script>\n        (adsbygoogle = window.adsbygoogle || []).push({});\n    </script>\n</div>\n\n                                    \n                                        <div class=\"ad-wrapper\" data-test-label=\"ad-wrapper\">\n    \n    <div class=\"ad-text\" data-test-label=\"ad-text\">ADVERTISEMENT</div>\n    <ins class=\"adsbygoogle\" style=\"display: block; height: 280px;\" data-ad-client=\"ca-pub-9482786369113753\" data-ad-slot=\"5720086888\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins>\n    <script>\n        (adsbygoogle = window.adsbygoogle || []).push({});\n    </script>\n</div>\n\n                                    \n                                        <div class=\"ad-wrapper\" data-test-label=\"ad-wrapper\">\n    \n    <div class=\"ad-text\" data-test-label=\"ad-text\">ADVERTISEMENT</div>\n    <ins class=\"adsbygoogle\" style=\"display: block; height: 280px;\" data-ad-client=\"ca-pub-9482786369113753\" data-ad-slot=\"5720086888\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins>\n    <script>\n        (adsbygoogle = window.adsbygoogle || []).push({});\n    </script>\n</div>\n\n                                    \n                                        <div class=\"ad-wrapper\" data-test-label=\"ad-wrapper\">\n    \n    <div class=\"ad-text\" data-test-label=\"ad-text\">ADVERTISEMENT</div>\n    <ins class=\"adsbygoogle\" style=\"display: block; height: 280px;\" data-ad-client=\"ca-pub-9482786369113753\" data-ad-slot=\"5720086888\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins>\n    <script>\n        (adsbygoogle = window.adsbygoogle || []).push({});\n    </script>\n</div>\n\n                                    \n                                        <div class=\"ad-wrapper\" data-test-label=\"ad-wrapper\">\n    \n    <div class=\"ad-text\" data-test-label=\"ad-text\">ADVERTISEMENT</div>\n    <ins class=\"adsbygoogle\" style=\"display: block; height: 280px;\" data-ad-client=\"ca-pub-9482786369113753\" data-ad-slot=\"5720086888\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins>\n    <script>\n        (adsbygoogle = window.adsbygoogle || []).push({});\n    </script>\n</div>\n\n                                    \n                                        <div class=\"ad-wrapper\" data-test-label=\"ad-wrapper\">\n    \n    <div class=\"ad-text\" data-test-label=\"ad-text\">ADVERTISEMENT</div>\n    <ins class=\"adsbygoogle\" style=\"display: block; height: 280px;\" data-ad-client=\"ca-pub-9482786369113753\" data-ad-slot=\"5720086888\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins>\n    <script>\n        (adsbygoogle = window.adsbygoogle || []).push({});\n    </script>\n</div>\n\n                                    \n                                        <div class=\"ad-wrapper\" data-test-label=\"ad-wrapper\">\n    \n    <div class=\"ad-text\" data-test-label=\"ad-text\">ADVERTISEMENT</div>\n    <ins class=\"adsbygoogle\" style=\"display: block; height: 280px;\" data-ad-client=\"ca-pub-9482786369113753\" data-ad-slot=\"5720086888\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins>\n    <script>\n        (adsbygoogle = window.adsbygoogle || []).push({});\n    </script>\n</div>\n\n                                    \n                                        <div class=\"ad-wrapper\" data-test-label=\"ad-wrapper\">\n    \n    <div class=\"ad-text\" data-test-label=\"ad-text\">ADVERTISEMENT</div>\n    <ins class=\"adsbygoogle\" style=\"display: block; height: 280px;\" data-ad-client=\"ca-pub-9482786369113753\" data-ad-slot=\"5720086888\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins>\n    <script>\n        (adsbygoogle = window.adsbygoogle || []).push({});\n    </script>\n</div>\n\n                                    \n                                        <div class=\"ad-wrapper\" data-test-label=\"ad-wrapper\">\n    \n    <div class=\"ad-text\" data-test-label=\"ad-text\">ADVERTISEMENT</div>\n    <ins class=\"adsbygoogle\" style=\"display: block; height: 280px;\" data-ad-client=\"ca-pub-9482786369113753\" data-ad-slot=\"5720086888\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins>\n    <script>\n        (adsbygoogle = window.adsbygoogle || []).push({});\n    </script>\n</div>\n\n                                    \n                                        <div class=\"ad-wrapper\" data-test-label=\"ad-wrapper\">\n    \n    <div class=\"ad-text\" data-test-label=\"ad-text\">ADVERTISEMENT</div>\n    <ins class=\"adsbygoogle\" style=\"display: block; height: 280px;\" data-ad-client=\"ca-pub-9482786369113753\" data-ad-slot=\"5720086888\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins>\n    <script>\n        (adsbygoogle = window.adsbygoogle || []).push({});\n    </script>\n</div>\n\n                                    \n                                        <div class=\"ad-wrapper\" data-test-label=\"ad-wrapper\">\n    \n    <div class=\"ad-text\" data-test-label=\"ad-text\">ADVERTISEMENT</div>\n    <ins class=\"adsbygoogle\" style=\"display: block; height: 280px;\" data-ad-client=\"ca-pub-9482786369113753\" data-ad-slot=\"5720086888\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins>\n    <script>\n        (adsbygoogle = window.adsbygoogle || []).push({});\n    </script>\n</div>\n\n                                    \n                                        <div class=\"ad-wrapper\" data-test-label=\"ad-wrapper\">\n    \n    <div class=\"ad-text\" data-test-label=\"ad-text\">ADVERTISEMENT</div>\n    <ins class=\"adsbygoogle\" style=\"display: block; height: 280px;\" data-ad-client=\"ca-pub-9482786369113753\" data-ad-slot=\"5720086888\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins>\n    <script>\n        (adsbygoogle = window.adsbygoogle || []).push({});\n    </script>\n</div>\n\n                                    \n                                        <div class=\"ad-wrapper\" data-test-label=\"ad-wrapper\">\n    \n    <div class=\"ad-text\" data-test-label=\"ad-text\">ADVERTISEMENT</div>\n    <ins class=\"adsbygoogle\" style=\"display: block; height: 280px;\" data-ad-client=\"ca-pub-9482786369113753\" data-ad-slot=\"5720086888\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins>\n    <script>\n        (adsbygoogle = window.adsbygoogle || []).push({});\n    </script>\n</div>\n\n                                    \n                                        <div class=\"ad-wrapper\" data-test-label=\"ad-wrapper\">\n    \n    <div class=\"ad-text\" data-test-label=\"ad-text\">ADVERTISEMENT</div>\n    <ins class=\"adsbygoogle\" style=\"display: block; height: 280px;\" data-ad-client=\"ca-pub-9482786369113753\" data-ad-slot=\"5720086888\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins>\n    <script>\n        (adsbygoogle = window.adsbygoogle || []).push({});\n    </script>\n</div>\n\n                                    \n                                        <div class=\"ad-wrapper\" data-test-label=\"ad-wrapper\">\n    \n    <div class=\"ad-text\" data-test-label=\"ad-text\">ADVERTISEMENT</div>\n    <ins class=\"adsbygoogle\" style=\"display: block; height: 280px;\" data-ad-client=\"ca-pub-9482786369113753\" data-ad-slot=\"5720086888\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins>\n    <script>\n        (adsbygoogle = window.adsbygoogle || []).push({});\n    </script>\n</div>\n\n                                    \n                                        <div class=\"ad-wrapper\" data-test-label=\"ad-wrapper\">\n    \n    <div class=\"ad-text\" data-test-label=\"ad-text\">ADVERTISEMENT</div>\n    <ins class=\"adsbygoogle\" style=\"display: block; height: 280px;\" data-ad-client=\"ca-pub-9482786369113753\" data-ad-slot=\"5720086888\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins>\n    <script>\n        (adsbygoogle = window.adsbygoogle || []).push({});\n    </script>\n</div>\n\n                                    \n                                        <div class=\"ad-wrapper\" data-test-label=\"ad-wrapper\">\n    \n    <div class=\"ad-text\" data-test-label=\"ad-text\">ADVERTISEMENT</div>\n    <ins class=\"adsbygoogle\" style=\"display: block; height: 280px;\" data-ad-client=\"ca-pub-9482786369113753\" data-ad-slot=\"5720086888\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins>\n    <script>\n        (adsbygoogle = window.adsbygoogle || []).push({});\n    </script>\n</div>\n\n                                    \n                                        <div class=\"ad-wrapper\" data-test-label=\"ad-wrapper\">\n    \n    <div class=\"ad-text\" data-test-label=\"ad-text\">ADVERTISEMENT</div>\n    <ins class=\"adsbygoogle\" style=\"display: block; height: 280px;\" data-ad-client=\"ca-pub-9482786369113753\" data-ad-slot=\"5720086888\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins>\n    <script>\n        (adsbygoogle = window.adsbygoogle || []).push({});\n    </script>\n</div>\n\n                                    \n                                        <div class=\"ad-wrapper\" data-test-label=\"ad-wrapper\">\n    \n    <div class=\"ad-text\" data-test-label=\"ad-text\">ADVERTISEMENT</div>\n    <ins class=\"adsbygoogle\" style=\"display: block; height: 280px;\" data-ad-client=\"ca-pub-9482786369113753\" data-ad-slot=\"5720086888\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins>\n    <script>\n        (adsbygoogle = window.adsbygoogle || []).push({});\n    </script>\n</div>\n\n                                    \n                                        <div class=\"ad-wrapper\" data-test-label=\"ad-wrapper\">\n    \n    <div class=\"ad-text\" data-test-label=\"ad-text\">ADVERTISEMENT</div>\n    <ins class=\"adsbygoogle\" style=\"display: block; height: 280px;\" data-ad-client=\"ca-pub-9482786369113753\" data-ad-slot=\"5720086888\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins>\n    <script>\n        (adsbygoogle = window.adsbygoogle || []).push({});\n    </script>\n</div>\n\n                                    \n                                        <div class=\"ad-wrapper\" data-test-label=\"ad-wrapper\">\n    \n    <div class=\"ad-text\" data-test-label=\"ad-text\">ADVERTISEMENT</div>\n    <ins class=\"adsbygoogle\" style=\"display: block; height: 280px;\" data-ad-client=\"ca-pub-9482786369113753\" data-ad-slot=\"5720086888\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins>\n    <script>\n        (adsbygoogle = window.adsbygoogle || []).push({});\n    </script>\n</div>\n\n                                    \n                                        <div class=\"ad-wrapper\" data-test-label=\"ad-wrapper\">\n    \n    <div class=\"ad-text\" data-test-label=\"ad-text\">ADVERTISEMENT</div>\n    <ins class=\"adsbygoogle\" style=\"display: block; height: 280px;\" data-ad-client=\"ca-pub-9482786369113753\" data-ad-slot=\"5720086888\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins>\n    <script>\n        (adsbygoogle = window.adsbygoogle || []).push({});\n    </script>\n</div>\n\n                                    \n                                        <div class=\"ad-wrapper\" data-test-label=\"ad-wrapper\">\n    \n    <div class=\"ad-text\" data-test-label=\"ad-text\">ADVERTISEMENT</div>\n    <ins class=\"adsbygoogle\" style=\"display: block; height: 280px;\" data-ad-client=\"ca-pub-9482786369113753\" data-ad-slot=\"5720086888\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins>\n    <script>\n        (adsbygoogle = window.adsbygoogle || []).push({});\n    </script>\n</div>\n\n                                    \n                                        <div class=\"ad-wrapper\" data-test-label=\"ad-wrapper\">\n    \n    <div class=\"ad-text\" data-test-label=\"ad-text\">ADVERTISEMENT</div>\n    <ins class=\"adsbygoogle\" style=\"display: block; height: 280px;\" data-ad-client=\"ca-pub-9482786369113753\" data-ad-slot=\"5720086888\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins>\n    <script>\n        (adsbygoogle = window.adsbygoogle || []).push({});\n    </script>\n</div>\n\n                                    \n                                        <div class=\"ad-wrapper\" data-test-label=\"ad-wrapper\">\n    \n    <div class=\"ad-text\" data-test-label=\"ad-text\">ADVERTISEMENT</div>\n    <ins class=\"adsbygoogle\" style=\"display: block; height: 280px;\" data-ad-client=\"ca-pub-9482786369113753\" data-ad-slot=\"5720086888\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins>\n    <script>\n        (adsbygoogle = window.adsbygoogle || []).push({});\n    </script>\n</div>\n\n                                    \n                                        <div class=\"ad-wrapper\" data-test-label=\"ad-wrapper\">\n    \n    <div class=\"ad-text\" data-test-label=\"ad-text\">ADVERTISEMENT</div>\n    <ins class=\"adsbygoogle\" style=\"display: block; height: 280px;\" data-ad-client=\"ca-pub-9482786369113753\" data-ad-slot=\"5720086888\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins>\n    <script>\n        (adsbygoogle = window.adsbygoogle || []).push({});\n    </script>\n</div>\n\n                                    \n                                        <div class=\"ad-wrapper\" data-test-label=\"ad-wrapper\">\n    \n    <div class=\"ad-text\" data-test-label=\"ad-text\">ADVERTISEMENT</div>\n    <ins class=\"adsbygoogle\" style=\"display: block; height: 280px;\" data-ad-client=\"ca-pub-9482786369113753\" data-ad-slot=\"5720086888\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins>\n    <script>\n        (adsbygoogle = window.adsbygoogle || []).push({});\n    </script>\n</div>\n\n                                    \n                                        <div class=\"ad-wrapper\" data-test-label=\"ad-wrapper\">\n    \n    <div class=\"ad-text\" data-test-label=\"ad-text\">ADVERTISEMENT</div>\n    <ins class=\"adsbygoogle\" style=\"display: block; height: 280px;\" data-ad-client=\"ca-pub-9482786369113753\" data-ad-slot=\"5720086888\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins>\n    <script>\n        (adsbygoogle = window.adsbygoogle || []).push({});\n    </script>\n</div>\n\n                                    \n                                \n                            </div>\n                        \n                    </div>\n                    <hr>\n                    \n                        <div class=\"post-full-author-header\" data-test-label=\"author-header-with-bio\">\n                            \n                                \n    \n    \n    \n\n    <section class=\"author-card\" data-test-label=\"author-card\">\n        \n            \n    <img srcset=\"https://www.freecodecamp.org/news/content/images/size/w60/2023/09/Screenshot_20230816_114245_Gallery--5----Copy.jpg 60w\" sizes=\"60px\" src=\"https://www.freecodecamp.org/news/content/images/size/w60/2023/09/Screenshot_20230816_114245_Gallery--5----Copy.jpg\" class=\"author-profile-image\" alt=\"Eivind Kjosbakken\" width=\"920\" height=\"1725\" onerror=\"this.style.display='none'\" loading=\"lazy\" data-test-label=\"profile-image\">\n  \n        \n\n        <section class=\"author-card-content \">\n            <span class=\"author-card-name\">\n                <a href=\"/news/author/kjosbakken/\" data-test-label=\"profile-link\">\n                    \n                        Eivind Kjosbakken\n                    \n                </a>\n            </span>\n            \n                \n                    <p data-test-label=\"author-bio\">CS Student at Norwegian University of Science and Technology</p>\n                \n            \n        </section>\n    </section>\n\n                            \n                        </div>\n                        <hr>\n                    \n\n                    \n                    \n                        \n    \n\n\n<p data-test-label=\"social-row-cta\" class=\"social-row\">\n    If you read this far, thank the author to show them you care. <button id=\"tweet-btn\" class=\"cta-button\" data-test-label=\"tweet-button\">Say Thanks</button>\n</p>\n\n\n    \n    <script>document.addEventListener(\"DOMContentLoaded\",(()=>{const t=document.getElementById(\"tweet-btn\"),e=window.location,n=\"Create%20a%20Self-Playing%20AI%20Chess%20Engine%20from%20Scratch%20with%20Imitation%20Learning\".replace(/&#39;/g,\"%27\"),o=\"\",i=\"@Ravenspike21\",r=Boolean(\"\");let a;if(r&&(o||i)){const t={originalPostAuthor:\"\",currentPostAuthor:\"Eivind Kjosbakken\"};a=encodeURIComponent(`Thank you ${o||t.originalPostAuthor} for writing this helpful article, and ${i||t.currentPostAuthor} for translating it.`)}else!r&&i&&(a=encodeURIComponent(`Thank you ${i} for writing this helpful article.`));const s=`window.open(\\n    '${a?`https://twitter.com/intent/tweet?text=${a}%0A%0A${n}%0A%0A${e}`:`https://twitter.com/intent/tweet?text=${n}%0A%0A${e}`}',\\n    'share-twitter',\\n    'width=550, height=235'\\n  ); return false;`;t.setAttribute(\"onclick\",s)}));</script>\n\n\n                        \n\n<div class=\"learn-cta-row\" data-test-label=\"learn-cta-row\">\n    <p>\n        Learn to code for free. freeCodeCamp's open source curriculum has helped more than 40,000 people get jobs as developers. <a href=\"https://www.freecodecamp.org/learn/\" class=\"cta-button\" id=\"learn-to-code-cta\" rel=\"noopener noreferrer\" target=\"_blank\">Get started</a>\n    </p>\n</div>\n\n                    \n                </section>\n                \n                    <div class=\"banner-ad bottom\">\n                        \n                            <div class=\"ad-wrapper\" data-test-label=\"ad-wrapper\">\n    \n    <div class=\"ad-text\" data-test-label=\"ad-text\">ADVERTISEMENT</div>\n    <ins class=\"adsbygoogle\" style=\"display: block; height: 280px;\" data-ad-client=\"ca-pub-9482786369113753\" data-ad-slot=\"5720086888\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins>\n    <script>\n        (adsbygoogle = window.adsbygoogle || []).push({});\n    </script>\n</div>\n\n                        \n                    </div>\n                \n            </article>\n        </div>\n    </main>\n\n\n            \n\n\n<footer class=\"site-footer\">\n    <div class=\"footer-top\">\n        <div class=\"footer-desc-col\">\n            <p data-test-label=\"tax-exempt-status\">freeCodeCamp is a donor-supported tax-exempt 501(c)(3) charity organization (United States Federal Tax Identification Number: 82-0779546)</p>\n            <p data-test-label=\"mission-statement\">Our mission: to help people learn to code for free. We accomplish this by creating thousands of videos, articles, and interactive coding lessons - all freely available to the public.</p>\n            <p data-test-label=\"donation-initiatives\">Donations to freeCodeCamp go toward our education initiatives, and help pay for servers, services, and staff.</p>\n            <p class=\"footer-donation\" data-test-label=\"donate-text\">\n                You can <a href=\"https://www.freecodecamp.org/donate/\" class=\"inline\" rel=\"noopener noreferrer\" target=\"_blank\">make a tax-deductible donation here</a>.\n            </p>\n        </div>\n        <div class=\"trending-guides\" data-test-label=\"trending-guides\">\n            <h2 id=\"trending-guides\" class=\"col-header\">Trending Guides</h2>\n            <ul class=\"trending-guides-articles\" aria-labelledby=\"trending-guides\">\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/complete-guide-to-css-transform-functions-and-properties/\" rel=\"noopener noreferrer\" target=\"_blank\">Learn CSS Transform\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/how-to-create-a-static-blog-with-lume/\" rel=\"noopener noreferrer\" target=\"_blank\">Build a Static Blog\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/how-to-build-an-ai-chatbot-with-redis-python-and-gpt/\" rel=\"noopener noreferrer\" target=\"_blank\">Build an AI Chatbot\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/what-is-programming-tutorial-for-beginners/\" rel=\"noopener noreferrer\" target=\"_blank\">What is Programming?\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/python-code-examples-sample-script-coding-tutorial-for-beginners/\" rel=\"noopener noreferrer\" target=\"_blank\">Python Code Examples\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/a-practical-guide-to-start-opensource-contributions/\" rel=\"noopener noreferrer\" target=\"_blank\">Open Source for Devs\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/http-full-course/\" rel=\"noopener noreferrer\" target=\"_blank\">HTTP Networking in JS\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/how-to-write-unit-tests-in-react-redux/\" rel=\"noopener noreferrer\" target=\"_blank\">Write React Unit Tests\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/introduction-to-algorithms-with-javascript-examples/\" rel=\"noopener noreferrer\" target=\"_blank\">Learn Algorithms in JS\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/how-to-write-clean-code/\" rel=\"noopener noreferrer\" target=\"_blank\">How to Write Clean Code\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/the-php-handbook/\" rel=\"noopener noreferrer\" target=\"_blank\">Learn PHP\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/the-java-handbook/\" rel=\"noopener noreferrer\" target=\"_blank\">Learn Java\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/the-swift-handbook/\" rel=\"noopener noreferrer\" target=\"_blank\">Learn Swift\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/learn-golang-handbook/\" rel=\"noopener noreferrer\" target=\"_blank\">Learn Golang\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/get-started-with-nodejs/\" rel=\"noopener noreferrer\" target=\"_blank\">Learn Node.js\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/complete-guide-to-css-grid/\" rel=\"noopener noreferrer\" target=\"_blank\">Learn CSS Grid\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/learn-solidity-handbook/\" rel=\"noopener noreferrer\" target=\"_blank\">Learn Solidity\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/the-express-handbook/\" rel=\"noopener noreferrer\" target=\"_blank\">Learn Express.js\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/javascript-es-modules-and-module-bundlers/\" rel=\"noopener noreferrer\" target=\"_blank\">Learn JS Modules\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/apache-kafka-handbook/\" rel=\"noopener noreferrer\" target=\"_blank\">Learn Apache Kafka\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/rest-api-design-best-practices-build-a-rest-api/\" rel=\"noopener noreferrer\" target=\"_blank\">REST API Best Practices\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/front-end-javascript-development-react-angular-vue-compared/\" rel=\"noopener noreferrer\" target=\"_blank\">Front-End JS Development\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/build-consume-and-document-a-rest-api/\" rel=\"noopener noreferrer\" target=\"_blank\">Learn to Build REST APIs\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/build-strongly-typed-polymorphic-components-with-react-and-typescript/\" rel=\"noopener noreferrer\" target=\"_blank\">Intermediate TS and React\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/command-line-for-beginners/\" rel=\"noopener noreferrer\" target=\"_blank\">Command Line for Beginners\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/an-introduction-to-operating-systems/\" rel=\"noopener noreferrer\" target=\"_blank\">Intro to Operating Systems\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/building-consuming-and-documenting-a-graphql-api/\" rel=\"noopener noreferrer\" target=\"_blank\">Learn to Build GraphQL APIs\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/oss-security-best-practices/\" rel=\"noopener noreferrer\" target=\"_blank\">OSS Security Best Practices\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/design-patterns-for-distributed-systems/\" rel=\"noopener noreferrer\" target=\"_blank\">Distributed Systems Patterns\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/an-introduction-to-software-architecture-patterns/\" rel=\"noopener noreferrer\" target=\"_blank\">Software Architecture Patterns\n                    </a>\n                </li>\n            </ul>\n            <div class=\"spacer\" style=\"padding: 15px 0;\"></div>\n            <div>\n                <h2 id=\"mobile-app\" class=\"col-header\">\n                    Mobile App\n                </h2>\n                <div class=\"min-h-[1px] px-[15px] md:w-2/3 md:ml-[16.6%]\">\n                    <ul aria-labelledby=\"mobile-app\" class=\"mobile-app-container\">\n                        <li>\n                            <a href=\"https://apps.apple.com/us/app/freecodecamp/id6446908151?itsct=apps_box_link&itscg=30200\" rel=\"noopener noreferrer\" target=\"_blank\">\n                                <img src=\"https://cdn.freecodecamp.org/platform/universal/apple-store-badge.svg\" lang=\"en\" alt=\"Download on the App Store\">\n                            </a>\n                        </li>\n                        <li>\n                            <a href=\"https://play.google.com/store/apps/details?id=org.freecodecamp\" rel=\"noopener noreferrer\" target=\"_blank\">\n                                <img src=\"https://cdn.freecodecamp.org/platform/universal/google-play-badge.svg\" lang=\"en\" alt=\"Get it on Google Play\">\n                            </a>\n                        </li>\n                    </ul>\n                </div>\n            </div>\n        </div>\n    </div>\n    <div class=\"footer-bottom\">\n        <h2 class=\"col-header\" data-test-label=\"our-nonprofit\">Our Charity</h2>\n        <div class=\"our-nonprofit\">\n            <a href=\"https://www.freecodecamp.org/news/about/\" rel=\"noopener noreferrer\" target=\"_blank\" data-test-label=\"about\">\n                About\n            </a>\n            <a href=\"https://www.linkedin.com/school/free-code-camp/people/\" rel=\"noopener noreferrer\" target=\"_blank\" data-test-label=\"alumni\">\n                Alumni Network\n            </a>\n            <a href=\"https://github.com/freeCodeCamp/\" rel=\"noopener noreferrer\" target=\"_blank\" data-test-label=\"open-source\">\n                Open Source\n            </a>\n            <a href=\"https://www.freecodecamp.org/news/shop/\" rel=\"noopener noreferrer\" target=\"_blank\" data-test-label=\"shop\">\n                Shop\n            </a>\n            <a href=\"https://www.freecodecamp.org/news/support/\" rel=\"noopener noreferrer\" target=\"_blank\" data-test-label=\"support\">\n                Support\n            </a>\n            <a href=\"https://www.freecodecamp.org/news/sponsors/\" rel=\"noopener noreferrer\" target=\"_blank\" data-test-label=\"sponsors\">\n                Sponsors\n            </a>\n            <a href=\"https://www.freecodecamp.org/news/academic-honesty-policy/\" rel=\"noopener noreferrer\" target=\"_blank\" data-test-label=\"honesty\">\n                Academic Honesty\n            </a>\n            <a href=\"https://www.freecodecamp.org/news/code-of-conduct/\" rel=\"noopener noreferrer\" target=\"_blank\" data-test-label=\"coc\">\n                Code of Conduct\n            </a>\n            <a href=\"https://www.freecodecamp.org/news/privacy-policy/\" rel=\"noopener noreferrer\" target=\"_blank\" data-test-label=\"privacy\">\n                Privacy Policy\n            </a>\n            <a href=\"https://www.freecodecamp.org/news/terms-of-service/\" rel=\"noopener noreferrer\" target=\"_blank\" data-test-label=\"tos\">\n                Terms of Service\n            </a>\n            <a href=\"https://www.freecodecamp.org/news/copyright-policy/\" rel=\"noopener noreferrer\" target=\"_blank\" data-test-label=\"copyright\">\n                Copyright Policy\n            </a>\n        </div>\n    </div>\n</footer>\n\n        </div>\n\n        \n        \n        \n\n        <!-- Google Tag Manager (noscript) -->\n<noscript><iframe src=\"https://www.googletagmanager.com/ns.html?id=GTM-5D6RKKP\" height=\"0\" width=\"0\" style=\"display:none;visibility:hidden\"></iframe></noscript>\n<!-- End Google Tag Manager (noscript) -->\n\n        \n    <script defer src=\"https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015\" integrity=\"sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==\" data-cf-beacon='{\"rayId\":\"8ac95a1188f38962\",\"serverTiming\":{\"name\":{\"cfL4\":true}},\"version\":\"2024.7.0\",\"token\":\"bdb993c6dde44e178aabd9555e75e4f4\"}' crossorigin=\"anonymous\"></script>\n</body>\n</html>\n"},"https://www.freecodecamp.org//news/how-to-fine-tune-the-donut-model/":{"html":"<!DOCTYPE html>\n<html lang=\"en\">\n    <head>\n        <meta charset=\"utf-8\">\n        <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\n        \n        \n            <title>How to Fine-Tune the Donut Model – With Example Use Case</title>\n        \n        <meta name=\"HandheldFriendly\" content=\"True\">\n        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n\n        <link rel=\"preconnect\" href=\"https://fonts.googleapis.com\">\n        <link rel=\"preconnect\" href=\"https://fonts.gstatic.com\" crossorigin=\"\">\n        \n            <link rel=\"preload\" as=\"style\" onload=\"this.onload=null;this.rel='stylesheet'\" href=\"https://fonts.googleapis.com/css2?family=Lato:ital,wght@0,300;0,400;0,700;1,400&family=Roboto+Mono:wght@400;700&display=swap\">\n        \n\n        \n        \n    <link rel=\"preload\" as=\"style\" onload=\"this.onload=null;this.rel='stylesheet'\" href=\"https://cdn.freecodecamp.org/news-assets/prism/1.29.0/themes/prism.min.css\">\n<noscript>\n  <link rel=\"stylesheet\" href=\"https://cdn.freecodecamp.org/news-assets/prism/1.29.0/themes/prism.min.css\">\n</noscript>\n<link rel=\"preload\" as=\"style\" onload=\"this.onload=null;this.rel='stylesheet'\" href=\"https://cdn.freecodecamp.org/news-assets/prism/1.29.0/plugins/unescaped-markup/prism-unescaped-markup.min.css\">\n<noscript>\n  <link rel=\"stylesheet\" href=\"https://cdn.freecodecamp.org/news-assets/prism/1.29.0/plugins/unescaped-markup/prism-unescaped-markup.min.css\">\n</noscript>\n\n<script defer=\"\" src=\"https://cdn.freecodecamp.org/news-assets/prism/1.29.0/components/prism-core.min.js\"></script>\n<script defer=\"\" src=\"https://cdn.freecodecamp.org/news-assets/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js\"></script>\n\n\n\n        \n        <link rel=\"preload\" as=\"style\" onload=\"this.onload=null;this.rel='stylesheet'\" href=\"/news/assets/css/global-26e2f3cde9.css\">\n        <link rel=\"stylesheet\" type=\"text/css\" href=\"/news/assets/css/screen-926fddfac2.css\">\n        <link rel=\"stylesheet\" type=\"text/css\" href=\"/news/assets/css/search-bar-124f5f949c.css\">\n\n        \n        <script defer=\"\" src=\"https://cdn.freecodecamp.org/news-assets/algolia/algoliasearch-3-33-0/algoliasearch.min.js\"></script>\n        <script defer=\"\" src=\"https://cdn.freecodecamp.org/news-assets/algolia/autocomplete-0-36-0/autocomplete.min.js\"></script>\n\n        \n        <script defer=\"\" src=\"https://cdn.freecodecamp.org/news-assets/dayjs/1.10.4/dayjs.min.js\"></script>\n        <script defer=\"\" src=\"https://cdn.freecodecamp.org/news-assets/dayjs/1.10.4/localizedFormat.min.js\"></script>\n        <script defer=\"\" src=\"https://cdn.freecodecamp.org/news-assets/dayjs/1.10.4/relativeTime.min.js\"></script>\n\n        \n        \n            <script defer=\"\" src=\"https://cdn.freecodecamp.org/news-assets/dayjs/1.10.4/locale/en.min.js\"></script>\n        \n\n        \n        <script>let client,index;document.addEventListener(\"DOMContentLoaded\",(()=>{client=algoliasearch(\"QMJYL5WYTI\",\"89770b24481654192d7a5c402c6ad9a0\"),index=client.initIndex(\"news\")})),document.addEventListener(\"DOMContentLoaded\",(()=>{const e=window.screen.width,t=window.screen.height,n=e>=767&&t>=768?8:5,o=document.getElementById(\"search-form\"),s=document.getElementById(\"search-input\"),a=document.getElementById(\"dropdown-container\");let i,d,c;s.addEventListener(\"input\",(e=>{i=e.target.value})),o.addEventListener(\"submit\",(e=>{e.preventDefault(),function(){if(d=document.getElementsByClassName(\"aa-cursor\")[0],d&&i){const e=d.querySelector(\"a\").href;window.location.assign(e)}else!d&&i&&c&&window.location.assign(`https://www.freecodecamp.org/news/search?query=${i}`)}()}));const l=autocomplete(\"#search-input\",{hint:!1,keyboardShortcuts:[\"s\",191],openOnFocus:!0,appendTo:a,debug:!0},[{source:autocomplete.sources.hits(index,{hitsPerPage:n}),debounce:250,templates:{suggestion:e=>(c=!0,`\\n            <a href=\"${e.url}\">\\n              <div class=\"algolia-result\">\\n                <span>${e._highlightResult.title.value}</span>\\n              </div>\\n            </a>\\n          `),empty:()=>(c=!1,'\\n            <div class=\"aa-suggestion footer-suggestion no-hits-footer\">\\n              <div class=\"algolia-result\">\\n                <span>\\n                  No tutorials found\\n                </span>\\n              </div>\\n            </div>\\n          '),footer:e=>{if(!e.isEmpty)return`\\n              <div class=\"aa-suggestion footer-suggestion\">\\n                <a id=\"algolia-footer-selector\" href=\"https://www.freecodecamp.org/news/search?query=${i}\">\\n                  <div class=\"algolia-result algolia-footer\">\\n                    See all results for ${i}\\n                  </div>\\n                </a>\\n              </div>\\n            `}}}]).on(\"autocomplete:selected\",((e,t,n,o)=>{d=t?t.url:`https://www.freecodecamp.org/news/search?query=${i}`,\"click\"!==o.selectionMethod&&\"tabKey\"!==o.selectionMethod&&c&&window.location.assign(d)}));document.addEventListener(\"click\",(e=>{e.target!==s&&l.autocomplete.close()}))})),document.addEventListener(\"DOMContentLoaded\",(()=>{dayjs.extend(dayjs_plugin_localizedFormat),dayjs.extend(dayjs_plugin_relativeTime),dayjs.locale(\"en\")}));const isAuthenticated=document.cookie.split(\";\").some((e=>e.trim().startsWith(\"jwt_access_token=\"))),isDonor=document.cookie.split(\";\").some((e=>e.trim().startsWith(\"isDonor=true\")));</script>\n\n        \n        \n    \n        \n            <script data-ad-client=\"ca-pub-9482786369113753\" src=\"https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js\" crossorigin=\"anonymous\" async=\"\"></script>\n        \n    \n\n\n        \n        \n    \n        \n    \n        \n    \n        \n    \n\n\n        \n        \n        \n\n        \n        \n\n        <link rel=\"icon\" href=\"https://cdn.freecodecamp.org/universal/favicons/favicon.ico\" type=\"image/png\">\n        \n        \n            <link rel=\"canonical\" href=\"https://www.freecodecamp.org/news/how-to-fine-tune-the-donut-model/\">\n        \n        <meta name=\"referrer\" content=\"no-referrer-when-downgrade\">\n\n        \n\n        \n    <meta name=\"description\" content=\"The Donut model in Python is a model you can use to extract text from a given image. This can be useful in various scenarios, like scanning receipts, for example.  You can easily download the Donut model from GitHub [https://github.com/clovaai/donut]. But as is common with AI models, you should\">\n\n    \n    <meta property=\"og:site_name\" content=\"freeCodeCamp.org\">\n    <meta property=\"og:type\" content=\"article\">\n    <meta property=\"og:title\" content=\"How to Fine-Tune the Donut Model – With Example Use Case\">\n    \n        <meta property=\"og:description\" content=\"The Donut model in Python is a model you can use to extract text from a given image. This can be useful in various scenarios, like scanning receipts, for example.  You can easily download the Donut model from GitHub [https://github.com/clovaai/donut]. But as is common with AI models, you should\">\n    \n    <meta property=\"og:url\" content=\"https://www.freecodecamp.org/news/how-to-fine-tune-the-donut-model/\">\n    <meta property=\"og:image\" content=\"https://www.freecodecamp.org/news/content/images/2023/09/undraw_Dashboard_re_3b76-4.png\">\n    <meta property=\"article:published_time\" content=\"2023-09-12T17:59:17.000Z\">\n    <meta property=\"article:modified_time\" content=\"2024-06-25T07:41:16.000Z\">\n    \n        <meta property=\"article:tag\" content=\"Python\">\n    \n        <meta property=\"article:tag\" content=\"Machine Learning\">\n    \n        <meta property=\"article:tag\" content=\"Artificial Intelligence\">\n    \n    <meta property=\"article:publisher\" content=\"https://www.facebook.com/freecodecamp\">\n    \n\n    \n    <meta name=\"twitter:card\" content=\"summary_large_image\">\n    <meta name=\"twitter:title\" content=\"How to Fine-Tune the Donut Model – With Example Use Case\">\n    \n        <meta name=\"twitter:description\" content=\"The Donut model in Python is a model you can use to extract text from a given image. This can be useful in various scenarios, like scanning receipts, for example.  You can easily download the Donut model from GitHub [https://github.com/clovaai/donut]. But as is common with AI models, you should\">\n    \n    <meta name=\"twitter:url\" content=\"https://www.freecodecamp.org/news/how-to-fine-tune-the-donut-model/\">\n    <meta name=\"twitter:image\" content=\"https://www.freecodecamp.org/news/content/images/2023/09/undraw_Dashboard_re_3b76-4.png\">\n    <meta name=\"twitter:label1\" content=\"Written by\">\n    <meta name=\"twitter:data1\" content=\"Eivind Kjosbakken\">\n    <meta name=\"twitter:label2\" content=\"Filed under\">\n    <meta name=\"twitter:data2\" content=\"Python, Machine Learning, Artificial Intelligence\">\n    <meta name=\"twitter:site\" content=\"@freecodecamp\">\n    \n        <meta name=\"twitter:creator\" content=\"@Ravenspike21\">\n    \n\n    <meta property=\"og:image:width\" content=\"1270\">\n    <meta property=\"og:image:height\" content=\"709\">\n\n\n        \n    <script type=\"application/ld+json\">{\n\t\"@context\": \"https://schema.org\",\n\t\"@type\": \"Article\",\n\t\"publisher\": {\n\t\t\"@type\": \"Organization\",\n\t\t\"name\": \"freeCodeCamp.org\",\n\t\t\"url\": \"https://www.freecodecamp.org/news/\",\n\t\t\"logo\": {\n\t\t\t\"@type\": \"ImageObject\",\n\t\t\t\"url\": \"https://cdn.freecodecamp.org/platform/universal/fcc_primary.svg\",\n\t\t\t\"width\": 2100,\n\t\t\t\"height\": 240\n\t\t}\n\t},\n\t\"image\": {\n\t\t\"@type\": \"ImageObject\",\n\t\t\"url\": \"https://www.freecodecamp.org/news/content/images/2023/09/undraw_Dashboard_re_3b76-4.png\",\n\t\t\"width\": 1270,\n\t\t\"height\": 709\n\t},\n\t\"url\": \"https://www.freecodecamp.org/news/how-to-fine-tune-the-donut-model/\",\n\t\"mainEntityOfPage\": {\n\t\t\"@type\": \"WebPage\",\n\t\t\"@id\": \"https://www.freecodecamp.org/news/\"\n\t},\n\t\"datePublished\": \"2023-09-12T17:59:17.000Z\",\n\t\"dateModified\": \"2024-06-25T07:41:16.000Z\",\n\t\"keywords\": \"Python, Machine Learning, Artificial Intelligence\",\n\t\"description\": \"The Donut model in Python is a model you can use to extract text from a given\\nimage. This can be useful in various scenarios, like scanning receipts, for\\nexample. \\n\\nYou can easily download the Donut model from GitHub\\n[https://github.com/clovaai/donut]. But as is common with AI models, you should\\nfine-tune the model for your specific needs. \\n\\nI wrote this tutorial because I did not find any resources showing me exactly\\nhow to fine-tune the Donut model with my dataset. So I had to learn this from\\n\",\n\t\"headline\": \"How to Fine-Tune the Donut Model – With Example Use Case\",\n\t\"author\": {\n\t\t\"@type\": \"Person\",\n\t\t\"name\": \"Eivind Kjosbakken\",\n\t\t\"url\": \"https://www.freecodecamp.org/news/author/kjosbakken/\",\n\t\t\"sameAs\": [\n\t\t\t\"https://twitter.com/Ravenspike21\"\n\t\t],\n\t\t\"image\": {\n\t\t\t\"@type\": \"ImageObject\",\n\t\t\t\"url\": \"https://www.freecodecamp.org/news/content/images/2023/09/Screenshot_20230816_114245_Gallery--5----Copy.jpg\",\n\t\t\t\"width\": 920,\n\t\t\t\"height\": 1725\n\t\t}\n\t}\n}</script>\n\n\n        <meta name=\"generator\" content=\"Eleventy\">\n        <link rel=\"alternate\" type=\"application/rss+xml\" title=\"freeCodeCamp.org\" href=\"https://www.freecodecamp.org/news/rss/\">\n\n        <link rel=\"preconnect\" href=\"https://fonts.gstatic.com\">\n\n<!-- dataLayer setup -->\n<script>\nwindow.dataLayer = window.dataLayer || [];\n</script>\n<!-- End dataLayer setup -->\n\n<!-- Google Tag Manager -->\n<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':\nnew Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],\nj=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=\n'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);\n})(window,document,'script','dataLayer','GTM-5D6RKKP');</script>\n<!-- End Google Tag Manager -->\n\n\n<meta name=\"google-site-verification\" content=\"b4tITLzEeeZGEpvD4mGNf3khKM4fvqejQaz9SYBQP8E\">\n\n        \n        \n\n        \n  <meta name=\"x-fcc-source\" data-test-label=\"x-fcc-source\" content=\"Ghost\">\n\n    </head>\n\n    \n        <body class=\"home-template\">\n    \n        <div class=\"site-wrapper\">\n            <nav class=\"site-nav nav-padding\">\n    <div class=\"site-nav-left\">\n        \n<form id=\"search-form\" data-test-label=\"search-bar\">\n    <div role=\"search\" class=\"searchbox__wrapper\">\n        <label class=\"fcc_sr_only\" for=\"search-input\">\n            Search\n        </label>\n        <input type=\"search\" placeholder=\"\n    Search 11,200+ tutorials\n\" id=\"search-input\">\n        <button type=\"submit\" class=\"ais-SearchBox-submit\">\n            <svg class=\"ais-SearchBox-submitIcon\" xmlns=\"https://www.w3.org/2000/svg\" width=\"10\" height=\"10\" viewBox=\"0 0 40 40\">\n    <path d=\"M26.804 29.01c-2.832 2.34-6.465 3.746-10.426 3.746C7.333 32.756 0 25.424 0 16.378 0 7.333 7.333 0 16.378 0c9.046 0 16.378 7.333 16.378 16.378 0 3.96-1.406 7.594-3.746 10.426l10.534 10.534c.607.607.61 1.59-.004 2.202-.61.61-1.597.61-2.202.004L26.804 29.01zm-10.426.627c7.323 0 13.26-5.936 13.26-13.26 0-7.32-5.937-13.257-13.26-13.257C9.056 3.12 3.12 9.056 3.12 16.378c0 7.323 5.936 13.26 13.258 13.26z\"></path>\n</svg>\n\n            <span class=\"fcc_sr_only\">Submit your search query</span>\n        </button>\n        <div id=\"dropdown-container\"></div>\n    </div>\n</form>\n\n    </div>\n    <div class=\"site-nav-middle\">\n        <a class=\"site-nav-logo\" href=\"https://www.freecodecamp.org/news/\" data-test-label=\"site-nav-logo\"><img src=\"https://cdn.freecodecamp.org/platform/universal/fcc_primary.svg\" alt=\"freeCodeCamp.org\"></a>\n    </div>\n    <div class=\"site-nav-right\">\n        <div class=\"nav-group\">\n            <a class=\"nav-forum\" id=\"nav-forum\" rel=\"noopener noreferrer\" href=\"https://forum.freecodecamp.org/\" target=\"_blank\" data-test-label=\"forum-button\">Forum</a>\n            <a class=\"toggle-button-nav\" id=\"nav-donate\" rel=\"noopener noreferrer\" href=\"https://www.freecodecamp.org/donate/\" target=\"_blank\" data-test-label=\"donate-button\">Donate</a>\n        </div>\n    </div>\n</nav>\n\n\n            \n            <a class=\"banner\" id=\"banner\" data-test-label=\"banner\" rel=\"noopener noreferrer\" target=\"_blank\">\n    <p id=\"banner-text\"></p>\n</a>\n\n\n    \n    <script>document.addEventListener(\"DOMContentLoaded\",(()=>{const e=document.getElementById(\"banner\"),t=document.getElementById(\"banner-text\");isAuthenticated?(t.innerHTML=\"Support our charity and our mission. <span>Donate to freeCodeCamp.org</span>.\",e.href=\"https://www.freecodecamp.org/donate\",e.setAttribute(\"text-variation\",\"authenticated\")):isDonor?(t.innerHTML=\"Thank you for supporting freeCodeCamp through <span>your donations</span>.\",e.href=\"https://www.freecodecamp.org/news/how-to-donate-to-free-code-camp/\",e.setAttribute(\"text-variation\",\"donor\")):(t.innerHTML=\"Learn to code — <span>free 3,000-hour curriculum</span>\",e.href=\"https://www.freecodecamp.org/\",e.setAttribute(\"text-variation\",\"default\"))}));</script>\n\n\n            <div id=\"error-message\"></div>\n\n            \n    <main id=\"site-main\" class=\"post-template site-main outer\">\n        <div class=\"inner ad-layout\">\n            <article class=\"post-full post\">\n                <header class=\"post-full-header\">\n                    <section class=\"post-full-meta\">\n                        <time class=\"post-full-meta-date\" data-test-label=\"post-full-meta-date\" datetime=\"Tue Sep 12 2023 17:59:17 GMT+0000 (Coordinated Universal Time)\">\n                            September 12, 2023\n                        </time>\n                        \n                            <span class=\"date-divider\">/</span>\n                            <a dir=\"ltr\" href=\"/news/tag/python/\">\n                                #Python\n                            </a>\n                        \n                    </section>\n                    <h1 class=\"post-full-title\" data-test-label=\"post-full-title\">How to Fine-Tune the Donut Model – With Example Use Case</h1>\n                </header>\n                <div class=\"post-full-author-header\" data-test-label=\"author-header-no-bio\">\n                    \n                        \n                            \n    \n    \n    \n\n    <section class=\"author-card\" data-test-label=\"author-card\">\n        \n            \n    <img srcset=\"https://www.freecodecamp.org/news/content/images/size/w60/2023/09/Screenshot_20230816_114245_Gallery--5----Copy.jpg 60w\" sizes=\"60px\" src=\"https://www.freecodecamp.org/news/content/images/size/w60/2023/09/Screenshot_20230816_114245_Gallery--5----Copy.jpg\" class=\"author-profile-image\" alt=\"Eivind Kjosbakken\" width=\"920\" height=\"1725\" onerror=\"this.style.display='none'\" data-test-label=\"profile-image\">\n  \n        \n\n        <section class=\"author-card-content author-card-content-no-bio\">\n            <span class=\"author-card-name\">\n                <a href=\"/news/author/kjosbakken/\" data-test-label=\"profile-link\">\n                    \n                        Eivind Kjosbakken\n                    \n                </a>\n            </span>\n            \n        </section>\n    </section>\n\n                        \n                    \n                </div>\n                <figure class=\"post-full-image\">\n                    \n    <picture>\n      <source media=\"(max-width: 700px)\" sizes=\"1px\" srcset=\"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 1w\">\n      <source media=\"(min-width: 701px)\" sizes=\"(max-width: 800px) 400px, (max-width: 1170px) 700px, 1400px\" srcset=\"https://www.freecodecamp.org/news/content/images/size/w300/2023/09/undraw_Dashboard_re_3b76-4.png 300w, https://www.freecodecamp.org/news/content/images/size/w600/2023/09/undraw_Dashboard_re_3b76-4.png 600w, https://www.freecodecamp.org/news/content/images/size/w1000/2023/09/undraw_Dashboard_re_3b76-4.png 1000w, https://www.freecodecamp.org/news/content/images/size/w2000/2023/09/undraw_Dashboard_re_3b76-4.png 2000w\">\n      <img onerror=\"this.style.display='none'\" src=\"https://www.freecodecamp.org/news/content/images/size/w2000/2023/09/undraw_Dashboard_re_3b76-4.png\" alt=\"How to Fine-Tune the Donut Model – With Example Use Case\" ,=\"\" width=\"1270\" height=\"709\" data-test-label=\"feature-image\">\n    </picture>\n  \n                </figure>\n                <section class=\"post-full-content\">\n                    <div class=\"post-and-sidebar\">\n                        <section class=\"post-content \" data-test-label=\"post-content\">\n                            \n<p>The Donut model in Python is a model you can use to extract text from a given image. This can be useful in various scenarios, like scanning receipts, for example. </p><p>You can easily download the <a href=\"https://github.com/clovaai/donut\" rel=\"noopener\">Donut model from GitHub</a>. But as is common with AI models, you should fine-tune the model for your specific needs. </p><p>I wrote this tutorial because I did not find any resources showing me exactly how to fine-tune the Donut model with my dataset. So I had to learn this from other tutorials (which I'll share throughout this guide) and figure out issues myself. </p><p>These issues were especially prevalent as I did not have a GPU on my local computer So to simplify the process for others, I made this tutorial.</p><figure class=\"kg-card kg-image-card kg-width-wide kg-card-hascaption\"><img src=\"https://www.freecodecamp.org/news/content/images/2023/09/img1.png\" class=\"kg-image\" alt=\"img1\" srcset=\"https://www.freecodecamp.org/news/content/images/size/w600/2023/09/img1.png 600w, https://www.freecodecamp.org/news/content/images/size/w1000/2023/09/img1.png 1000w, https://www.freecodecamp.org/news/content/images/2023/09/img1.png 1156w\" width=\"1156\" height=\"379\" loading=\"lazy\"><figcaption>Extract information from receipts. The picture was taken from <a href=\"https://colab.research.google.com/drive/1NMSqoIZ_l39wyRD7yVjw2FIuU2aglzJi?usp=sharing#scrollTo=f7RoSOEXUa6i\" rel=\"noopener\">this Google Colab file</a> using a photo taken by me</figcaption></figure><h3 id=\"here-s-what-we-ll-cover-\">Here's what we'll cover:</h3><ul><li>How to find a dataset to fine-tune with</li><li>Fine-tuning with Google Colab</li><li>How to change parameters</li><li>Fine-tuning locally</li></ul><h2 id=\"how-to-find-a-dataset-to-fine-tune-with\">How to Find a Dataset to Fine-tune with</h2><h3 id=\"finding-a-dataset-online\">Finding a dataset online</h3><p>To fine-tune the model, we need a dataset we will fine-tune with. If you want a simple solution, you can find a prepared dataset in <a href=\"https://drive.google.com/drive/folders/1orOj76DW2o-w3Dnati2CKAlXauH8STpT?usp=sharing\" rel=\"noopener\">this folder on Google Drive.</a> </p><p>You should then copy this dataset over to your own Google Drive. Note that this was taken from <a href=\"https://towardsdatascience.com/ocr-free-document-understanding-with-donut-1acfbdf099be\" rel=\"noopener\">this tutorial</a> under the “Downloading and parsing SROIE” headline. The tutorial is a great read which inspired this article, as I wanted to create a more in-depth tutorial for fine-tuning the Donut model in Google Colab. So if you want a more in-depth look at generating the dataset, I recommend reading the tutorial above.</p><p>The dataset linked above may not necessarily be for your specific purpose. If you want to fine-tune a model to your specific needs, you either need to find a fitting dataset online, or create a dataset yourself.</p><h3 id=\"annotating-your-own-dataset\">Annotating your own dataset</h3><p>This is another option if you can't or don't want to find a dataset online (so if you did that, you can ignore this subsection). </p><p>Annotating your own dataset is a surefire way to create a dataset that perfectly fits your needs. </p><p>There are many annotating tools online, but a free one I recommend is the <a href=\"https://github.com/katanaml/sparrow\" rel=\"noopener\">Sparrow UI data annotation tool</a>. Here you can upload your image, put bounding boxes on the image, and label each bounding box. You can then extract the labeled data in JSON format, and use it following the rest of the tutorial. </p><p>Make sure your dataset is in the same format as the <a href=\"https://drive.google.com/drive/folders/1orOj76DW2o-w3Dnati2CKAlXauH8STpT\" rel=\"noopener\">dataset I provided earlier</a>. For more details on annotating data with the Sparrow UI, you can check out <a href=\"https://medium.com/python-in-plain-english/empower-your-donut-model-for-receipts-with-self-annotated-data-51fc882b7229\">my article on using the Donut model for self-annotated data</a>. Note that this article assumes you are already able to finetune the Donut model (which you will learn in this article).</p><figure class=\"kg-card kg-image-card kg-width-wide kg-card-hascaption\"><img src=\"https://www.freecodecamp.org/news/content/images/2023/09/img2.png\" class=\"kg-image\" alt=\"img2\" srcset=\"https://www.freecodecamp.org/news/content/images/size/w600/2023/09/img2.png 600w, https://www.freecodecamp.org/news/content/images/size/w1000/2023/09/img2.png 1000w, https://www.freecodecamp.org/news/content/images/2023/09/img2.png 1200w\" sizes=\"(min-width: 1200px) 1200px\" width=\"1200\" height=\"777\" loading=\"lazy\"><figcaption>Annotating a receipt with the Sparrow UI data annotation tool</figcaption></figure><h2 id=\"fine-tuning-with-google-colab\">Fine-Tuning with Google Colab</h2><p>To make the fine-tuning process as simple as possible, I provided a <a href=\"https://colab.research.google.com/drive/1-qfztYjDrFecOWdqyANtI23HV06xhDRE?usp=sharing\" rel=\"noopener\">Google Colab file you can use here</a>. (Some code is taken from <a href=\"https://github.com/NielsRogge/Transformers-Tutorials\" rel=\"noopener\">this GitHub page</a>). </p><p>Note that package versions need to be exactly as provided in the Drive, as wrong package versions were the root of a lot of the problems I faced fine-tuning the Donut model myself.</p><p>Before fine-tuning using the Google Colab file, there are 2 things you need to do:</p><h3 id=\"upload-data-to-your-google-drive-\">Upload data to your Google Drive.</h3><p>Upload the <a href=\"https://drive.google.com/file/d/1WsWLVZhKLb8A0uCJ7Jpk8F5pCNDNsGbH/view?usp=sharing\" rel=\"noopener\">dataset I provided earlier</a> to your Google Drive under a parent folder called <em>preparedFinetuneData </em>(see the file structure in the image below). </p><p>Make sure to add the parent folder in the root folder for your Google Drive. Also, download <a href=\"https://drive.google.com/file/d/1WsWLVZhKLb8A0uCJ7Jpk8F5pCNDNsGbH/view?usp=sharing\" rel=\"noopener\">this config file</a> and add it to the root folder of your Google Drive.</p><figure class=\"kg-card kg-image-card kg-width-wide kg-card-hascaption\"><img src=\"https://www.freecodecamp.org/news/content/images/2023/09/img.png\" class=\"kg-image\" alt=\"img\" width=\"217\" height=\"98\" loading=\"lazy\"><figcaption>How your dataset should look in the root folder of Google Drive</figcaption></figure><h3 id=\"link-your-google-drive-to-your-google-colab-\">Link your Google Drive to your Google Colab.</h3><p>When you run the cell which mounts the Google Drive, you might get a prompt, in which case you can just accept it and ignore the rest of this paragraph. </p><p>If you do not get a prompt, press the files icon (red in the image below), and the Mount Drive Icon (blue in the image below). Then you will get a code snippet that you can run, and now your Google Drive is connected. </p><p>Note that if you have not connected Google Colab to Google Drive before, you have to log into your Google Drive after pressing the Drive icon, and give permission for Colab to access Drive (prompts for this should appear automatically when you try to link the Drive)</p><figure class=\"kg-card kg-image-card kg-width-wide kg-card-hascaption\"><img src=\"https://www.freecodecamp.org/news/content/images/2023/09/img3.png\" class=\"kg-image\" alt=\"img3\" width=\"486\" height=\"309\" loading=\"lazy\"><figcaption>Files icon (red). Mount Google Drive (blue)</figcaption></figure><p>Finally, <strong>restart your runtime</strong>. After altering files on Google Colab, you always have to restart your runtime to see the latest updates.</p><h2 id=\"how-to-change-parameters\">How to Change Parameters</h2><p>Great! Now you can run the cells in the notebook, and you should receive a fine-tuned model. Remember you can also change the Config parameters to, for example, train for longer, use more workers, and so on.</p><figure class=\"kg-card kg-image-card kg-width-wide kg-card-hascaption\"><img src=\"https://www.freecodecamp.org/news/content/images/2023/09/img6.png\" class=\"kg-image\" alt=\"img6\" srcset=\"https://www.freecodecamp.org/news/content/images/size/w600/2023/09/img6.png 600w, https://www.freecodecamp.org/news/content/images/size/w1000/2023/09/img6.png 1000w, https://www.freecodecamp.org/news/content/images/2023/09/img6.png 1044w\" width=\"1044\" height=\"247\" loading=\"lazy\"><figcaption>Example of Config parameters you can change.</figcaption></figure><p>Note that I am working with the Donut model fine-tuned on the <a href=\"https://github.com/clovaai/cord\" rel=\"noopener\">CORD dataset</a>, as I want to be able to read receipts. You can also find other Donut models <a href=\"https://github.com/clovaai/donut\" rel=\"noopener\">here</a>, with the other options being document parsing, document classification, or document visual question answering (DocVQA).</p><h2 id=\"fine-tuning-locally\">Fine-tuning Locally</h2><p>Fine-tuning can also be run locally, which will be mostly relevant for you if you have a GPU, as CPU training will take a long time. </p><p>To run locally you have to:</p><ol><li>First, clone <a href=\"https://github.com/clovaai/donut\" rel=\"noopener\">this GitHub repository</a></li><li>Add the prepared fine-tuning dataset to the root folder.</li><li>If you want to save the fine-tuned model, add the line below to train.py line 164, right below <em>trainer.fit(…)</em></li></ol><pre><code class=\"language-py\">#...\ntrainer.save_checkpoint(f\"{Path(config.result_path)}/{config.exp_name}/{config.exp_version}/model_checkpoint.ckpt\")\n#...</code></pre><p>4. &nbsp;You then need to comment out GPU processes in the PyTorch Lightning Trainer, and add the line: <em>accelerator=”cpu”</em>:</p><pre><code class=\"language-py\">#train.py file\n#... \ntrainer = pl.Trainer(\n        #Comment out the lines above\n        # num_nodes=config.get(\"num_nodes\", 1),\n        # devices=torch.cuda.device_count(),\n        # strategy=\"dp\",\n        # accelerator=\"gpu\",\n        accelerator=\"cpu\", #TODO add this line\n        plugins=custom_ckpt,\n        max_epochs=config.max_epochs,\n        max_steps=config.max_steps,\n        val_check_interval=config.val_check_interval,\n        check_val_every_n_epoch=config.check_val_every_n_epoch,\n        gradient_clip_val=config.gradient_clip_val,\n        precision=16,\n        num_sanity_val_steps=0,\n        logger=logger,\n        callbacks=[lr_callback, checkpoint_callback, bar],\n    )\n#...</code></pre><p>5. &nbsp;Make sure the max_epochs parameter in your Config file is set to -1 (if not you will get a division by 0 error). You can decide training time by setting the parameter <em>max_steps</em>.</p><p>6. &nbsp;You can then run fine-tuning can then be run with the following command in the terminal:</p><pre><code class=\"language-bash\">python train.py --config config/train_cord.yaml</code></pre><p>Where <em>train_cord.yaml</em> is the Configuration file you want to use.</p><h3 id=\"running-on-cpu\">Running on CPU</h3><p>If you are running on CPU after all, you will encounter some problems unless you make some changes:</p><ol><li>donut/train.py, change the <em>accelerator</em> parameter to “cpu” (from “gpu”), and remove the parameters: <em>num_nodes</em>, <em>devices</em>, and <em>strategy</em>).</li><li>Then in your Config file (for example <em>train_cord.yaml</em>), set <em>max_epochs </em>to -1, and then specify the parameter <em>max_steps</em>. This is because you will encounter a division by 0 error if you have <em>max_epoch </em>larger than 0</li></ol><p>After these changes, running on a CPU should work as well.</p><h2 id=\"conclusion\">Conclusion</h2><p>In this article, I have shown you how to easily fine-tune the Donut model using your own data, something which will hopefully result in improved accuracy for your fine-tuned Donut model. </p><p>The applicabilities of the Donut model are many, and this is just one way to use it, which I hope is useful.</p><p>If you are interested and want to learn more about similar topics, you can find me on:</p><ul><li><a href=\"https://medium.com/@oieivind\">✅ Medium</a></li><li><a href=\"https://twitter.com/Ravenspike21\">✅</a> <a href=\"https://twitter.com/Ravenspike21\"></a><a href=\"https://twitter.com/Ravenspike21\">Twitter</a></li></ul>\n\n                        </section>\n                        \n                            <div class=\"sidebar\">\n                                \n                                    \n                                        <div class=\"ad-wrapper\" data-test-label=\"ad-wrapper\">\n    \n    <div class=\"ad-text\" data-test-label=\"ad-text\">ADVERTISEMENT</div>\n    <ins class=\"adsbygoogle\" style=\"display: block; height: 280px;\" data-ad-client=\"ca-pub-9482786369113753\" data-ad-slot=\"5720086888\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins>\n    <script>\n        (adsbygoogle = window.adsbygoogle || []).push({});\n    </script>\n</div>\n\n                                    \n                                        <div class=\"ad-wrapper\" data-test-label=\"ad-wrapper\">\n    \n    <div class=\"ad-text\" data-test-label=\"ad-text\">ADVERTISEMENT</div>\n    <ins class=\"adsbygoogle\" style=\"display: block; height: 280px;\" data-ad-client=\"ca-pub-9482786369113753\" data-ad-slot=\"5720086888\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins>\n    <script>\n        (adsbygoogle = window.adsbygoogle || []).push({});\n    </script>\n</div>\n\n                                    \n                                        <div class=\"ad-wrapper\" data-test-label=\"ad-wrapper\">\n    \n    <div class=\"ad-text\" data-test-label=\"ad-text\">ADVERTISEMENT</div>\n    <ins class=\"adsbygoogle\" style=\"display: block; height: 280px;\" data-ad-client=\"ca-pub-9482786369113753\" data-ad-slot=\"5720086888\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins>\n    <script>\n        (adsbygoogle = window.adsbygoogle || []).push({});\n    </script>\n</div>\n\n                                    \n                                        <div class=\"ad-wrapper\" data-test-label=\"ad-wrapper\">\n    \n    <div class=\"ad-text\" data-test-label=\"ad-text\">ADVERTISEMENT</div>\n    <ins class=\"adsbygoogle\" style=\"display: block; height: 280px;\" data-ad-client=\"ca-pub-9482786369113753\" data-ad-slot=\"5720086888\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins>\n    <script>\n        (adsbygoogle = window.adsbygoogle || []).push({});\n    </script>\n</div>\n\n                                    \n                                        <div class=\"ad-wrapper\" data-test-label=\"ad-wrapper\">\n    \n    <div class=\"ad-text\" data-test-label=\"ad-text\">ADVERTISEMENT</div>\n    <ins class=\"adsbygoogle\" style=\"display: block; height: 280px;\" data-ad-client=\"ca-pub-9482786369113753\" data-ad-slot=\"5720086888\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins>\n    <script>\n        (adsbygoogle = window.adsbygoogle || []).push({});\n    </script>\n</div>\n\n                                    \n                                        <div class=\"ad-wrapper\" data-test-label=\"ad-wrapper\">\n    \n    <div class=\"ad-text\" data-test-label=\"ad-text\">ADVERTISEMENT</div>\n    <ins class=\"adsbygoogle\" style=\"display: block; height: 280px;\" data-ad-client=\"ca-pub-9482786369113753\" data-ad-slot=\"5720086888\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins>\n    <script>\n        (adsbygoogle = window.adsbygoogle || []).push({});\n    </script>\n</div>\n\n                                    \n                                        <div class=\"ad-wrapper\" data-test-label=\"ad-wrapper\">\n    \n    <div class=\"ad-text\" data-test-label=\"ad-text\">ADVERTISEMENT</div>\n    <ins class=\"adsbygoogle\" style=\"display: block; height: 280px;\" data-ad-client=\"ca-pub-9482786369113753\" data-ad-slot=\"5720086888\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins>\n    <script>\n        (adsbygoogle = window.adsbygoogle || []).push({});\n    </script>\n</div>\n\n                                    \n                                        <div class=\"ad-wrapper\" data-test-label=\"ad-wrapper\">\n    \n    <div class=\"ad-text\" data-test-label=\"ad-text\">ADVERTISEMENT</div>\n    <ins class=\"adsbygoogle\" style=\"display: block; height: 280px;\" data-ad-client=\"ca-pub-9482786369113753\" data-ad-slot=\"5720086888\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins>\n    <script>\n        (adsbygoogle = window.adsbygoogle || []).push({});\n    </script>\n</div>\n\n                                    \n                                \n                            </div>\n                        \n                    </div>\n                    <hr>\n                    \n                        <div class=\"post-full-author-header\" data-test-label=\"author-header-with-bio\">\n                            \n                                \n    \n    \n    \n\n    <section class=\"author-card\" data-test-label=\"author-card\">\n        \n            \n    <img srcset=\"https://www.freecodecamp.org/news/content/images/size/w60/2023/09/Screenshot_20230816_114245_Gallery--5----Copy.jpg 60w\" sizes=\"60px\" src=\"https://www.freecodecamp.org/news/content/images/size/w60/2023/09/Screenshot_20230816_114245_Gallery--5----Copy.jpg\" class=\"author-profile-image\" alt=\"Eivind Kjosbakken\" width=\"920\" height=\"1725\" onerror=\"this.style.display='none'\" loading=\"lazy\" data-test-label=\"profile-image\">\n  \n        \n\n        <section class=\"author-card-content \">\n            <span class=\"author-card-name\">\n                <a href=\"/news/author/kjosbakken/\" data-test-label=\"profile-link\">\n                    \n                        Eivind Kjosbakken\n                    \n                </a>\n            </span>\n            \n                \n                    <p data-test-label=\"author-bio\">CS Student at Norwegian University of Science and Technology</p>\n                \n            \n        </section>\n    </section>\n\n                            \n                        </div>\n                        <hr>\n                    \n\n                    \n                    \n                        \n    \n\n\n<p data-test-label=\"social-row-cta\" class=\"social-row\">\n    If you read this far, thank the author to show them you care. <button id=\"tweet-btn\" class=\"cta-button\" data-test-label=\"tweet-button\">Say Thanks</button>\n</p>\n\n\n    \n    <script>document.addEventListener(\"DOMContentLoaded\",(()=>{const t=document.getElementById(\"tweet-btn\"),e=window.location,n=\"How%20to%20Fine-Tune%20the%20Donut%20Model%20%E2%80%93%20With%20Example%20Use%20Case\".replace(/&#39;/g,\"%27\"),o=\"\",i=\"@Ravenspike21\",r=Boolean(\"\");let s;if(r&&(o||i)){const t={originalPostAuthor:\"\",currentPostAuthor:\"Eivind Kjosbakken\"};s=encodeURIComponent(`Thank you ${o||t.originalPostAuthor} for writing this helpful article, and ${i||t.currentPostAuthor} for translating it.`)}else!r&&i&&(s=encodeURIComponent(`Thank you ${i} for writing this helpful article.`));const a=`window.open(\\n    '${s?`https://twitter.com/intent/tweet?text=${s}%0A%0A${n}%0A%0A${e}`:`https://twitter.com/intent/tweet?text=${n}%0A%0A${e}`}',\\n    'share-twitter',\\n    'width=550, height=235'\\n  ); return false;`;t.setAttribute(\"onclick\",a)}));</script>\n\n\n                        \n\n<div class=\"learn-cta-row\" data-test-label=\"learn-cta-row\">\n    <p>\n        Learn to code for free. freeCodeCamp's open source curriculum has helped more than 40,000 people get jobs as developers. <a href=\"https://www.freecodecamp.org/learn/\" class=\"cta-button\" id=\"learn-to-code-cta\" rel=\"noopener noreferrer\" target=\"_blank\">Get started</a>\n    </p>\n</div>\n\n                    \n                </section>\n                \n                    <div class=\"banner-ad bottom\">\n                        \n                            <div class=\"ad-wrapper\" data-test-label=\"ad-wrapper\">\n    \n    <div class=\"ad-text\" data-test-label=\"ad-text\">ADVERTISEMENT</div>\n    <ins class=\"adsbygoogle\" style=\"display: block; height: 280px;\" data-ad-client=\"ca-pub-9482786369113753\" data-ad-slot=\"5720086888\" data-ad-format=\"auto\" data-full-width-responsive=\"true\"></ins>\n    <script>\n        (adsbygoogle = window.adsbygoogle || []).push({});\n    </script>\n</div>\n\n                        \n                    </div>\n                \n            </article>\n        </div>\n    </main>\n\n\n            \n\n\n<footer class=\"site-footer\">\n    <div class=\"footer-top\">\n        <div class=\"footer-desc-col\">\n            <p data-test-label=\"tax-exempt-status\">freeCodeCamp is a donor-supported tax-exempt 501(c)(3) charity organization (United States Federal Tax Identification Number: 82-0779546)</p>\n            <p data-test-label=\"mission-statement\">Our mission: to help people learn to code for free. We accomplish this by creating thousands of videos, articles, and interactive coding lessons - all freely available to the public.</p>\n            <p data-test-label=\"donation-initiatives\">Donations to freeCodeCamp go toward our education initiatives, and help pay for servers, services, and staff.</p>\n            <p class=\"footer-donation\" data-test-label=\"donate-text\">\n                You can <a href=\"https://www.freecodecamp.org/donate/\" class=\"inline\" rel=\"noopener noreferrer\" target=\"_blank\">make a tax-deductible donation here</a>.\n            </p>\n        </div>\n        <div class=\"trending-guides\" data-test-label=\"trending-guides\">\n            <h2 id=\"trending-guides\" class=\"col-header\">Trending Guides</h2>\n            <ul class=\"trending-guides-articles\" aria-labelledby=\"trending-guides\">\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/complete-guide-to-css-transform-functions-and-properties/\" rel=\"noopener noreferrer\" target=\"_blank\">Learn CSS Transform\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/how-to-create-a-static-blog-with-lume/\" rel=\"noopener noreferrer\" target=\"_blank\">Build a Static Blog\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/how-to-build-an-ai-chatbot-with-redis-python-and-gpt/\" rel=\"noopener noreferrer\" target=\"_blank\">Build an AI Chatbot\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/what-is-programming-tutorial-for-beginners/\" rel=\"noopener noreferrer\" target=\"_blank\">What is Programming?\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/python-code-examples-sample-script-coding-tutorial-for-beginners/\" rel=\"noopener noreferrer\" target=\"_blank\">Python Code Examples\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/a-practical-guide-to-start-opensource-contributions/\" rel=\"noopener noreferrer\" target=\"_blank\">Open Source for Devs\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/http-full-course/\" rel=\"noopener noreferrer\" target=\"_blank\">HTTP Networking in JS\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/how-to-write-unit-tests-in-react-redux/\" rel=\"noopener noreferrer\" target=\"_blank\">Write React Unit Tests\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/introduction-to-algorithms-with-javascript-examples/\" rel=\"noopener noreferrer\" target=\"_blank\">Learn Algorithms in JS\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/how-to-write-clean-code/\" rel=\"noopener noreferrer\" target=\"_blank\">How to Write Clean Code\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/the-php-handbook/\" rel=\"noopener noreferrer\" target=\"_blank\">Learn PHP\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/the-java-handbook/\" rel=\"noopener noreferrer\" target=\"_blank\">Learn Java\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/the-swift-handbook/\" rel=\"noopener noreferrer\" target=\"_blank\">Learn Swift\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/learn-golang-handbook/\" rel=\"noopener noreferrer\" target=\"_blank\">Learn Golang\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/get-started-with-nodejs/\" rel=\"noopener noreferrer\" target=\"_blank\">Learn Node.js\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/complete-guide-to-css-grid/\" rel=\"noopener noreferrer\" target=\"_blank\">Learn CSS Grid\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/learn-solidity-handbook/\" rel=\"noopener noreferrer\" target=\"_blank\">Learn Solidity\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/the-express-handbook/\" rel=\"noopener noreferrer\" target=\"_blank\">Learn Express.js\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/javascript-es-modules-and-module-bundlers/\" rel=\"noopener noreferrer\" target=\"_blank\">Learn JS Modules\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/apache-kafka-handbook/\" rel=\"noopener noreferrer\" target=\"_blank\">Learn Apache Kafka\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/rest-api-design-best-practices-build-a-rest-api/\" rel=\"noopener noreferrer\" target=\"_blank\">REST API Best Practices\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/front-end-javascript-development-react-angular-vue-compared/\" rel=\"noopener noreferrer\" target=\"_blank\">Front-End JS Development\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/build-consume-and-document-a-rest-api/\" rel=\"noopener noreferrer\" target=\"_blank\">Learn to Build REST APIs\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/build-strongly-typed-polymorphic-components-with-react-and-typescript/\" rel=\"noopener noreferrer\" target=\"_blank\">Intermediate TS and React\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/command-line-for-beginners/\" rel=\"noopener noreferrer\" target=\"_blank\">Command Line for Beginners\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/an-introduction-to-operating-systems/\" rel=\"noopener noreferrer\" target=\"_blank\">Intro to Operating Systems\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/building-consuming-and-documenting-a-graphql-api/\" rel=\"noopener noreferrer\" target=\"_blank\">Learn to Build GraphQL APIs\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/oss-security-best-practices/\" rel=\"noopener noreferrer\" target=\"_blank\">OSS Security Best Practices\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/design-patterns-for-distributed-systems/\" rel=\"noopener noreferrer\" target=\"_blank\">Distributed Systems Patterns\n                    </a>\n                </li>\n                <li>\n                    <a href=\"https://www.freecodecamp.org/news/an-introduction-to-software-architecture-patterns/\" rel=\"noopener noreferrer\" target=\"_blank\">Software Architecture Patterns\n                    </a>\n                </li>\n            </ul>\n            <div class=\"spacer\" style=\"padding: 15px 0;\"></div>\n            <div>\n                <h2 id=\"mobile-app\" class=\"col-header\">\n                    Mobile App\n                </h2>\n                <div class=\"min-h-[1px] px-[15px] md:w-2/3 md:ml-[16.6%]\">\n                    <ul aria-labelledby=\"mobile-app\" class=\"mobile-app-container\">\n                        <li>\n                            <a href=\"https://apps.apple.com/us/app/freecodecamp/id6446908151?itsct=apps_box_link&itscg=30200\" rel=\"noopener noreferrer\" target=\"_blank\">\n                                <img src=\"https://cdn.freecodecamp.org/platform/universal/apple-store-badge.svg\" lang=\"en\" alt=\"Download on the App Store\">\n                            </a>\n                        </li>\n                        <li>\n                            <a href=\"https://play.google.com/store/apps/details?id=org.freecodecamp\" rel=\"noopener noreferrer\" target=\"_blank\">\n                                <img src=\"https://cdn.freecodecamp.org/platform/universal/google-play-badge.svg\" lang=\"en\" alt=\"Get it on Google Play\">\n                            </a>\n                        </li>\n                    </ul>\n                </div>\n            </div>\n        </div>\n    </div>\n    <div class=\"footer-bottom\">\n        <h2 class=\"col-header\" data-test-label=\"our-nonprofit\">Our Charity</h2>\n        <div class=\"our-nonprofit\">\n            <a href=\"https://www.freecodecamp.org/news/about/\" rel=\"noopener noreferrer\" target=\"_blank\" data-test-label=\"about\">\n                About\n            </a>\n            <a href=\"https://www.linkedin.com/school/free-code-camp/people/\" rel=\"noopener noreferrer\" target=\"_blank\" data-test-label=\"alumni\">\n                Alumni Network\n            </a>\n            <a href=\"https://github.com/freeCodeCamp/\" rel=\"noopener noreferrer\" target=\"_blank\" data-test-label=\"open-source\">\n                Open Source\n            </a>\n            <a href=\"https://www.freecodecamp.org/news/shop/\" rel=\"noopener noreferrer\" target=\"_blank\" data-test-label=\"shop\">\n                Shop\n            </a>\n            <a href=\"https://www.freecodecamp.org/news/support/\" rel=\"noopener noreferrer\" target=\"_blank\" data-test-label=\"support\">\n                Support\n            </a>\n            <a href=\"https://www.freecodecamp.org/news/sponsors/\" rel=\"noopener noreferrer\" target=\"_blank\" data-test-label=\"sponsors\">\n                Sponsors\n            </a>\n            <a href=\"https://www.freecodecamp.org/news/academic-honesty-policy/\" rel=\"noopener noreferrer\" target=\"_blank\" data-test-label=\"honesty\">\n                Academic Honesty\n            </a>\n            <a href=\"https://www.freecodecamp.org/news/code-of-conduct/\" rel=\"noopener noreferrer\" target=\"_blank\" data-test-label=\"coc\">\n                Code of Conduct\n            </a>\n            <a href=\"https://www.freecodecamp.org/news/privacy-policy/\" rel=\"noopener noreferrer\" target=\"_blank\" data-test-label=\"privacy\">\n                Privacy Policy\n            </a>\n            <a href=\"https://www.freecodecamp.org/news/terms-of-service/\" rel=\"noopener noreferrer\" target=\"_blank\" data-test-label=\"tos\">\n                Terms of Service\n            </a>\n            <a href=\"https://www.freecodecamp.org/news/copyright-policy/\" rel=\"noopener noreferrer\" target=\"_blank\" data-test-label=\"copyright\">\n                Copyright Policy\n            </a>\n        </div>\n    </div>\n</footer>\n\n        </div>\n\n        \n        \n        \n\n        <!-- Google Tag Manager (noscript) -->\n<noscript><iframe src=\"https://www.googletagmanager.com/ns.html?id=GTM-5D6RKKP\" height=\"0\" width=\"0\" style=\"display:none;visibility:hidden\"></iframe></noscript>\n<!-- End Google Tag Manager (noscript) -->\n\n        \n    <script defer src=\"https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015\" integrity=\"sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==\" data-cf-beacon='{\"rayId\":\"8ac95a118d33ce19\",\"version\":\"2024.7.0\",\"serverTiming\":{\"name\":{\"cfL4\":true}},\"token\":\"bdb993c6dde44e178aabd9555e75e4f4\",\"b\":1}' crossorigin=\"anonymous\"></script>\n</body>\n</html>\n"}}}